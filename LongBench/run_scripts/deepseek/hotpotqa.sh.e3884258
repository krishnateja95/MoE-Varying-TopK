
Lmod is automatically replacing "nvhpc/23.9" with "gcc-native/12.3".


Lmod is automatically replacing "PrgEnv-nvhpc/8.5.0" with "PrgEnv-gnu/8.5.0".


Due to MODULEPATH changes, the following have been reloaded:
  1) cray-mpich/8.1.28

The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.25s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.31s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.35s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.78s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.97s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:02<14:55,  2.99s/it]  1%|          | 2/300 [00:05<12:09,  2.45s/it]  1%|          | 3/300 [00:05<07:55,  1.60s/it]  1%|▏         | 4/300 [00:06<07:11,  1.46s/it]  2%|▏         | 5/300 [00:08<08:08,  1.66s/it]  2%|▏         | 6/300 [00:10<07:46,  1.59s/it]  2%|▏         | 7/300 [00:12<08:32,  1.75s/it]  3%|▎         | 8/300 [00:13<07:37,  1.57s/it]  3%|▎         | 9/300 [00:14<06:11,  1.28s/it]  3%|▎         | 10/300 [00:16<07:22,  1.53s/it]  4%|▎         | 11/300 [00:18<08:12,  1.70s/it]  4%|▍         | 12/300 [00:20<08:36,  1.79s/it]  4%|▍         | 13/300 [00:21<07:19,  1.53s/it]  5%|▍         | 14/300 [00:23<08:05,  1.70s/it]  5%|▌         | 15/300 [00:24<06:53,  1.45s/it]  5%|▌         | 16/300 [00:26<07:45,  1.64s/it]  6%|▌         | 17/300 [00:28<08:21,  1.77s/it]  6%|▌         | 18/300 [00:30<08:15,  1.76s/it]  6%|▋         | 19/300 [00:32<08:30,  1.82s/it]  7%|▋         | 20/300 [00:34<08:50,  1.90s/it]  7%|▋         | 21/300 [00:36<08:54,  1.92s/it]  7%|▋         | 22/300 [00:37<08:29,  1.83s/it]  8%|▊         | 23/300 [00:39<08:40,  1.88s/it]  8%|▊         | 24/300 [00:40<07:06,  1.54s/it]  8%|▊         | 25/300 [00:41<05:41,  1.24s/it]  9%|▊         | 26/300 [00:41<04:58,  1.09s/it]  9%|▉         | 27/300 [00:42<04:59,  1.10s/it]  9%|▉         | 28/300 [00:44<05:22,  1.19s/it] 10%|▉         | 29/300 [00:44<04:33,  1.01s/it] 10%|█         | 30/300 [00:46<05:32,  1.23s/it] 10%|█         | 31/300 [00:47<05:22,  1.20s/it] 11%|█         | 32/300 [00:48<04:29,  1.01s/it] 11%|█         | 33/300 [00:50<05:32,  1.24s/it] 11%|█▏        | 34/300 [00:52<06:37,  1.49s/it] 12%|█▏        | 35/300 [00:54<07:21,  1.67s/it] 12%|█▏        | 36/300 [00:55<07:16,  1.65s/it] 12%|█▏        | 37/300 [00:57<07:38,  1.74s/it] 13%|█▎        | 38/300 [00:58<06:33,  1.50s/it] 13%|█▎        | 39/300 [00:59<05:40,  1.31s/it] 13%|█▎        | 40/300 [01:01<06:30,  1.50s/it] 14%|█▎        | 41/300 [01:02<05:28,  1.27s/it] 14%|█▍        | 42/300 [01:03<05:38,  1.31s/it] 14%|█▍        | 43/300 [01:04<04:41,  1.10s/it] 15%|█▍        | 44/300 [01:05<04:47,  1.12s/it] 15%|█▌        | 45/300 [01:07<05:48,  1.37s/it] 15%|█▌        | 46/300 [01:09<06:16,  1.48s/it] 16%|█▌        | 47/300 [01:09<05:17,  1.25s/it] 16%|█▌        | 48/300 [01:12<06:18,  1.50s/it] 16%|█▋        | 49/300 [01:13<05:44,  1.37s/it] 17%|█▋        | 50/300 [01:15<06:36,  1.59s/it] 17%|█▋        | 51/300 [01:17<07:12,  1.74s/it] 17%|█▋        | 52/300 [01:18<06:44,  1.63s/it] 18%|█▊        | 53/300 [01:19<06:16,  1.53s/it] 18%|█▊        | 54/300 [01:21<06:07,  1.49s/it] 18%|█▊        | 55/300 [01:23<06:46,  1.66s/it] 19%|█▊        | 56/300 [01:24<05:36,  1.38s/it] 19%|█▉        | 57/300 [01:25<04:55,  1.22s/it] 19%|█▉        | 58/300 [01:26<05:47,  1.44s/it] 20%|█▉        | 59/300 [01:28<06:26,  1.60s/it] 20%|██        | 60/300 [01:29<05:38,  1.41s/it] 20%|██        | 61/300 [01:31<06:00,  1.51s/it] 21%|██        | 62/300 [01:32<04:59,  1.26s/it] 21%|██        | 63/300 [01:34<05:55,  1.50s/it] 21%|██▏       | 64/300 [01:36<06:25,  1.64s/it] 22%|██▏       | 65/300 [01:38<06:56,  1.77s/it] 22%|██▏       | 66/300 [01:40<07:18,  1.88s/it] 22%|██▏       | 67/300 [01:41<06:30,  1.67s/it] 23%|██▎       | 68/300 [01:43<06:55,  1.79s/it] 23%|██▎       | 69/300 [01:45<07:10,  1.86s/it] 23%|██▎       | 70/300 [01:47<07:19,  1.91s/it] 24%|██▎       | 71/300 [01:48<06:19,  1.66s/it] 24%|██▍       | 72/300 [01:50<05:47,  1.52s/it] 24%|██▍       | 73/300 [01:51<05:40,  1.50s/it] 25%|██▍       | 74/300 [01:53<05:34,  1.48s/it] 25%|██▌       | 75/300 [01:55<06:10,  1.65s/it] 25%|██▌       | 76/300 [01:56<06:04,  1.63s/it] 26%|██▌       | 77/300 [01:57<04:48,  1.30s/it] 26%|██▌       | 78/300 [01:57<04:01,  1.09s/it] 26%|██▋       | 79/300 [01:59<04:45,  1.29s/it] 27%|██▋       | 80/300 [02:00<04:06,  1.12s/it] 27%|██▋       | 81/300 [02:01<03:44,  1.02s/it] 27%|██▋       | 82/300 [02:02<03:59,  1.10s/it] 28%|██▊       | 83/300 [02:03<04:29,  1.24s/it] 28%|██▊       | 84/300 [02:04<03:45,  1.04s/it] 28%|██▊       | 85/300 [02:05<04:03,  1.13s/it] 29%|██▊       | 86/300 [02:07<05:01,  1.41s/it] 29%|██▉       | 87/300 [02:08<04:29,  1.27s/it] 29%|██▉       | 88/300 [02:10<05:21,  1.52s/it] 30%|██▉       | 89/300 [02:12<05:52,  1.67s/it] 30%|███       | 90/300 [02:13<04:56,  1.41s/it] 30%|███       | 91/300 [02:14<04:19,  1.24s/it] 31%|███       | 92/300 [02:15<04:11,  1.21s/it] 31%|███       | 93/300 [02:17<04:58,  1.44s/it] 31%|███▏      | 94/300 [02:18<04:39,  1.36s/it] 32%|███▏      | 95/300 [02:20<04:42,  1.38s/it] 32%|███▏      | 96/300 [02:21<04:04,  1.20s/it] 32%|███▏      | 97/300 [02:22<03:57,  1.17s/it] 33%|███▎      | 98/300 [02:22<03:18,  1.02it/s] 33%|███▎      | 99/300 [02:24<04:18,  1.29s/it] 33%|███▎      | 100/300 [02:26<05:02,  1.51s/it] 34%|███▎      | 101/300 [02:27<04:12,  1.27s/it] 34%|███▍      | 102/300 [02:28<03:53,  1.18s/it] 34%|███▍      | 103/300 [02:29<03:30,  1.07s/it] 35%|███▍      | 104/300 [02:29<03:08,  1.04it/s] 35%|███▌      | 105/300 [02:31<03:51,  1.19s/it] 35%|███▌      | 106/300 [02:32<03:38,  1.13s/it] 36%|███▌      | 107/300 [02:34<04:46,  1.49s/it] 36%|███▌      | 108/300 [02:35<04:01,  1.26s/it] 36%|███▋      | 109/300 [02:37<04:42,  1.48s/it] 37%|███▋      | 110/300 [02:39<05:14,  1.66s/it] 37%|███▋      | 111/300 [02:41<05:25,  1.72s/it] 37%|███▋      | 112/300 [02:44<06:01,  1.92s/it] 38%|███▊      | 113/300 [02:44<04:53,  1.57s/it] 38%|███▊      | 114/300 [02:47<05:27,  1.76s/it] 38%|███▊      | 115/300 [02:49<05:46,  1.87s/it] 39%|███▊      | 116/300 [02:51<05:52,  1.91s/it] 39%|███▉      | 117/300 [02:53<06:15,  2.05s/it] 39%|███▉      | 118/300 [02:55<06:31,  2.15s/it] 40%|███▉      | 119/300 [02:57<05:57,  1.98s/it] 40%|████      | 120/300 [02:59<06:00,  2.00s/it] 40%|████      | 121/300 [03:01<05:37,  1.88s/it] 41%|████      | 122/300 [03:02<05:25,  1.83s/it] 41%|████      | 123/300 [03:05<05:55,  2.01s/it] 41%|████▏     | 124/300 [03:07<06:05,  2.08s/it] 42%|████▏     | 125/300 [03:09<06:12,  2.13s/it] 42%|████▏     | 126/300 [03:11<06:09,  2.13s/it] 42%|████▏     | 127/300 [03:14<06:18,  2.19s/it] 43%|████▎     | 128/300 [03:15<05:34,  1.95s/it] 43%|████▎     | 129/300 [03:18<05:57,  2.09s/it] 43%|████▎     | 130/300 [03:19<05:29,  1.94s/it] 44%|████▎     | 131/300 [03:21<05:29,  1.95s/it] 44%|████▍     | 132/300 [03:22<04:30,  1.61s/it] 44%|████▍     | 133/300 [03:24<05:04,  1.83s/it] 45%|████▍     | 134/300 [03:27<05:56,  2.15s/it] 45%|████▌     | 135/300 [03:28<04:54,  1.79s/it] 45%|████▌     | 136/300 [03:30<04:43,  1.73s/it] 46%|████▌     | 137/300 [03:32<04:59,  1.84s/it] 46%|████▌     | 138/300 [03:34<05:13,  1.93s/it] 46%|████▋     | 139/300 [03:36<05:28,  2.04s/it] 47%|████▋     | 140/300 [03:40<06:37,  2.48s/it] 47%|████▋     | 141/300 [03:41<05:27,  2.06s/it] 47%|████▋     | 142/300 [03:42<04:34,  1.74s/it] 48%|████▊     | 143/300 [03:44<05:01,  1.92s/it] 48%|████▊     | 144/300 [03:46<04:37,  1.78s/it] 48%|████▊     | 145/300 [03:48<05:05,  1.97s/it] 49%|████▊     | 146/300 [03:50<04:51,  1.89s/it] 49%|████▉     | 147/300 [03:52<05:09,  2.02s/it] 49%|████▉     | 148/300 [03:54<05:05,  2.01s/it] 50%|████▉     | 149/300 [03:56<05:17,  2.11s/it] 50%|█████     | 150/300 [03:58<04:39,  1.87s/it] 50%|█████     | 151/300 [03:58<03:44,  1.51s/it] 51%|█████     | 152/300 [04:01<04:25,  1.80s/it] 51%|█████     | 153/300 [04:02<04:08,  1.69s/it] 51%|█████▏    | 154/300 [04:05<04:44,  1.95s/it] 52%|█████▏    | 155/300 [04:07<05:03,  2.09s/it] 52%|█████▏    | 156/300 [04:08<04:22,  1.82s/it] 52%|█████▏    | 157/300 [04:10<04:24,  1.85s/it] 53%|█████▎    | 158/300 [04:13<04:38,  1.96s/it] 53%|█████▎    | 159/300 [04:15<04:49,  2.05s/it] 53%|█████▎    | 160/300 [04:16<04:28,  1.92s/it] 54%|█████▎    | 161/300 [04:19<04:42,  2.03s/it] 54%|█████▍    | 162/300 [04:21<04:51,  2.12s/it] 54%|█████▍    | 163/300 [04:23<04:36,  2.02s/it] 55%|█████▍    | 164/300 [04:24<03:52,  1.71s/it] 55%|█████▌    | 165/300 [04:26<04:11,  1.86s/it] 55%|█████▌    | 166/300 [04:28<04:26,  1.99s/it] 56%|█████▌    | 167/300 [04:31<04:44,  2.14s/it] 56%|█████▌    | 168/300 [04:33<04:46,  2.17s/it] 56%|█████▋    | 169/300 [04:35<04:47,  2.20s/it] 57%|█████▋    | 170/300 [04:37<04:08,  1.91s/it] 57%|█████▋    | 171/300 [04:38<03:57,  1.84s/it] 57%|█████▋    | 172/300 [04:40<03:41,  1.73s/it] 58%|█████▊    | 173/300 [04:41<03:18,  1.56s/it] 58%|█████▊    | 174/300 [04:42<03:08,  1.50s/it] 58%|█████▊    | 175/300 [04:44<03:14,  1.56s/it] 59%|█████▊    | 176/300 [04:46<03:46,  1.82s/it] 59%|█████▉    | 177/300 [04:49<04:00,  1.95s/it] 59%|█████▉    | 178/300 [04:50<03:42,  1.83s/it] 60%|█████▉    | 179/300 [04:52<03:54,  1.94s/it] 60%|██████    | 180/300 [04:53<03:17,  1.65s/it] 60%|██████    | 181/300 [04:55<03:23,  1.71s/it] 61%|██████    | 182/300 [04:57<03:15,  1.66s/it] 61%|██████    | 183/300 [04:59<03:33,  1.83s/it] 61%|██████▏   | 184/300 [05:00<03:01,  1.57s/it] 62%|██████▏   | 185/300 [05:01<02:33,  1.34s/it] 62%|██████▏   | 186/300 [05:03<02:53,  1.52s/it] 62%|██████▏   | 187/300 [05:05<03:13,  1.71s/it] 63%|██████▎   | 188/300 [05:07<03:34,  1.91s/it] 63%|██████▎   | 189/300 [05:09<03:43,  2.02s/it] 63%|██████▎   | 190/300 [05:11<03:33,  1.94s/it] 64%|██████▎   | 191/300 [05:12<02:52,  1.58s/it] 64%|██████▍   | 192/300 [05:13<02:26,  1.36s/it] 64%|██████▍   | 193/300 [05:15<02:55,  1.64s/it] 65%|██████▍   | 194/300 [05:17<03:08,  1.78s/it] 65%|██████▌   | 195/300 [05:19<03:18,  1.89s/it] 65%|██████▌   | 196/300 [05:22<03:32,  2.05s/it] 66%|██████▌   | 197/300 [05:24<03:39,  2.13s/it] 66%|██████▌   | 198/300 [05:25<03:03,  1.80s/it] 66%|██████▋   | 199/300 [05:27<03:13,  1.91s/it] 67%|██████▋   | 200/300 [05:30<03:26,  2.07s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (17161 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [05:32<03:19,  2.02s/it] 67%|██████▋   | 202/300 [05:35<03:50,  2.36s/it] 68%|██████▊   | 203/300 [05:38<04:02,  2.50s/it] 68%|██████▊   | 204/300 [05:40<04:13,  2.64s/it] 68%|██████▊   | 205/300 [05:43<04:20,  2.74s/it] 69%|██████▊   | 206/300 [05:46<04:23,  2.81s/it] 69%|██████▉   | 207/300 [05:49<04:22,  2.82s/it] 69%|██████▉   | 208/300 [05:52<04:23,  2.87s/it] 70%|██████▉   | 209/300 [05:55<04:20,  2.87s/it] 70%|███████   | 210/300 [05:58<04:15,  2.84s/it] 70%|███████   | 211/300 [06:01<04:14,  2.86s/it] 71%|███████   | 212/300 [06:04<04:14,  2.90s/it] 71%|███████   | 213/300 [06:06<03:53,  2.69s/it] 71%|███████▏  | 214/300 [06:08<03:28,  2.42s/it] 72%|███████▏  | 215/300 [06:11<03:37,  2.56s/it] 72%|███████▏  | 216/300 [06:12<03:02,  2.18s/it] 72%|███████▏  | 217/300 [06:15<03:18,  2.39s/it] 73%|███████▎  | 218/300 [06:17<02:59,  2.19s/it] 73%|███████▎  | 219/300 [06:19<03:14,  2.40s/it] 73%|███████▎  | 220/300 [06:22<03:06,  2.33s/it] 74%|███████▎  | 221/300 [06:24<03:16,  2.49s/it] 74%|███████▍  | 222/300 [06:27<03:21,  2.59s/it] 74%|███████▍  | 223/300 [06:30<03:24,  2.66s/it] 75%|███████▍  | 224/300 [06:32<03:00,  2.37s/it] 75%|███████▌  | 225/300 [06:35<03:05,  2.48s/it] 75%|███████▌  | 226/300 [06:36<02:50,  2.30s/it] 76%|███████▌  | 227/300 [06:39<03:01,  2.49s/it] 76%|███████▌  | 228/300 [06:42<02:52,  2.40s/it] 76%|███████▋  | 229/300 [06:43<02:26,  2.07s/it] 77%|███████▋  | 230/300 [06:44<02:12,  1.90s/it] 77%|███████▋  | 231/300 [06:47<02:21,  2.06s/it] 77%|███████▋  | 232/300 [06:50<02:38,  2.33s/it] 78%|███████▊  | 233/300 [06:53<02:48,  2.52s/it] 78%|███████▊  | 234/300 [06:54<02:29,  2.26s/it] 78%|███████▊  | 235/300 [06:57<02:39,  2.45s/it] 79%|███████▊  | 236/300 [07:00<02:40,  2.51s/it] 79%|███████▉  | 237/300 [07:01<02:15,  2.16s/it] 79%|███████▉  | 238/300 [07:04<02:27,  2.37s/it] 80%|███████▉  | 239/300 [07:07<02:35,  2.55s/it] 80%|████████  | 240/300 [07:10<02:39,  2.65s/it] 80%|████████  | 241/300 [07:11<02:12,  2.24s/it] 81%|████████  | 242/300 [07:14<02:19,  2.40s/it] 81%|████████  | 243/300 [07:17<02:24,  2.54s/it] 81%|████████▏ | 244/300 [07:18<02:00,  2.16s/it] 82%|████████▏ | 245/300 [07:21<02:07,  2.33s/it] 82%|████████▏ | 246/300 [07:24<02:13,  2.47s/it] 82%|████████▏ | 247/300 [07:26<02:10,  2.47s/it] 83%|████████▎ | 248/300 [07:28<02:04,  2.40s/it] 83%|████████▎ | 249/300 [07:31<02:08,  2.52s/it] 83%|████████▎ | 250/300 [07:34<02:12,  2.65s/it] 84%|████████▎ | 251/300 [07:37<02:13,  2.73s/it] 84%|████████▍ | 252/300 [07:39<02:03,  2.57s/it] 84%|████████▍ | 253/300 [07:41<01:48,  2.30s/it] 85%|████████▍ | 254/300 [07:44<01:52,  2.45s/it] 85%|████████▌ | 255/300 [07:45<01:36,  2.15s/it] 85%|████████▌ | 256/300 [07:48<01:44,  2.37s/it] 86%|████████▌ | 257/300 [07:51<01:47,  2.50s/it] 86%|████████▌ | 258/300 [07:54<01:51,  2.64s/it] 86%|████████▋ | 259/300 [07:57<01:52,  2.74s/it] 87%|████████▋ | 260/300 [07:59<01:47,  2.69s/it] 87%|████████▋ | 261/300 [08:02<01:47,  2.75s/it] 87%|████████▋ | 262/300 [08:05<01:47,  2.82s/it] 88%|████████▊ | 263/300 [08:08<01:46,  2.87s/it] 88%|████████▊ | 264/300 [08:11<01:41,  2.83s/it] 88%|████████▊ | 265/300 [08:12<01:22,  2.34s/it] 89%|████████▊ | 266/300 [08:15<01:25,  2.51s/it] 89%|████████▉ | 267/300 [08:18<01:25,  2.59s/it] 89%|████████▉ | 268/300 [08:21<01:26,  2.70s/it] 90%|████████▉ | 269/300 [08:22<01:10,  2.26s/it] 90%|█████████ | 270/300 [08:25<01:13,  2.45s/it] 90%|█████████ | 271/300 [08:28<01:13,  2.53s/it] 91%|█████████ | 272/300 [08:31<01:13,  2.64s/it] 91%|█████████ | 273/300 [08:33<01:11,  2.64s/it] 91%|█████████▏| 274/300 [08:36<01:09,  2.69s/it] 92%|█████████▏| 275/300 [08:39<01:07,  2.71s/it] 92%|█████████▏| 276/300 [08:41<01:03,  2.65s/it] 92%|█████████▏| 277/300 [08:43<00:51,  2.25s/it] 93%|█████████▎| 278/300 [08:44<00:46,  2.10s/it] 93%|█████████▎| 279/300 [08:47<00:48,  2.30s/it] 93%|█████████▎| 280/300 [08:50<00:50,  2.50s/it] 94%|█████████▎| 281/300 [08:53<00:49,  2.62s/it] 94%|█████████▍| 282/300 [08:54<00:38,  2.13s/it] 94%|█████████▍| 283/300 [08:57<00:38,  2.28s/it] 95%|█████████▍| 284/300 [08:59<00:36,  2.31s/it] 95%|█████████▌| 285/300 [09:02<00:37,  2.51s/it] 95%|█████████▌| 286/300 [09:05<00:36,  2.60s/it] 96%|█████████▌| 287/300 [09:08<00:35,  2.71s/it] 96%|█████████▌| 288/300 [09:09<00:26,  2.17s/it] 96%|█████████▋| 289/300 [09:10<00:20,  1.91s/it] 97%|█████████▋| 290/300 [09:13<00:21,  2.20s/it] 97%|█████████▋| 291/300 [09:16<00:21,  2.38s/it] 97%|█████████▋| 292/300 [09:18<00:19,  2.46s/it] 98%|█████████▊| 293/300 [09:21<00:16,  2.41s/it] 98%|█████████▊| 294/300 [09:22<00:12,  2.14s/it] 98%|█████████▊| 295/300 [09:24<00:10,  2.07s/it] 99%|█████████▊| 296/300 [09:27<00:08,  2.24s/it] 99%|█████████▉| 297/300 [09:30<00:07,  2.46s/it] 99%|█████████▉| 298/300 [09:31<00:04,  2.14s/it]100%|█████████▉| 299/300 [09:33<00:02,  2.01s/it]100%|██████████| 300/300 [09:34<00:00,  1.77s/it]100%|██████████| 300/300 [09:34<00:00,  1.91s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.25s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.29s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.31s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.75s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.95s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:02<14:26,  2.90s/it]  1%|          | 2/300 [00:04<11:10,  2.25s/it]  1%|          | 3/300 [00:05<07:54,  1.60s/it]  1%|▏         | 4/300 [00:06<07:17,  1.48s/it]  2%|▏         | 5/300 [00:07<06:21,  1.29s/it]  2%|▏         | 6/300 [00:08<05:09,  1.05s/it]  2%|▏         | 7/300 [00:10<06:59,  1.43s/it]  3%|▎         | 8/300 [00:12<08:04,  1.66s/it]  3%|▎         | 9/300 [00:14<07:42,  1.59s/it]  3%|▎         | 10/300 [00:16<08:38,  1.79s/it]  4%|▎         | 11/300 [00:18<09:14,  1.92s/it]  4%|▍         | 12/300 [00:20<09:24,  1.96s/it]  4%|▍         | 13/300 [00:21<07:20,  1.54s/it]  5%|▍         | 14/300 [00:22<06:36,  1.39s/it]  5%|▌         | 15/300 [00:23<05:53,  1.24s/it]  5%|▌         | 16/300 [00:25<07:11,  1.52s/it]  6%|▌         | 17/300 [00:27<08:07,  1.72s/it]  6%|▌         | 18/300 [00:29<07:54,  1.68s/it]  6%|▋         | 19/300 [00:29<06:26,  1.37s/it]  7%|▋         | 20/300 [00:30<05:19,  1.14s/it]  7%|▋         | 21/300 [00:32<06:47,  1.46s/it]  7%|▋         | 22/300 [00:34<07:09,  1.55s/it]  8%|▊         | 23/300 [00:36<07:43,  1.67s/it]  8%|▊         | 24/300 [00:37<06:28,  1.41s/it]  8%|▊         | 25/300 [00:38<06:31,  1.43s/it]  9%|▊         | 26/300 [00:40<07:10,  1.57s/it]  9%|▉         | 27/300 [00:41<05:55,  1.30s/it]  9%|▉         | 28/300 [00:42<05:36,  1.24s/it] 10%|▉         | 29/300 [00:42<04:53,  1.08s/it] 10%|█         | 30/300 [00:45<06:15,  1.39s/it] 10%|█         | 31/300 [00:47<07:21,  1.64s/it] 11%|█         | 32/300 [00:49<07:54,  1.77s/it] 11%|█         | 33/300 [00:51<08:27,  1.90s/it] 11%|█▏        | 34/300 [00:53<08:48,  1.99s/it] 12%|█▏        | 35/300 [00:55<08:24,  1.90s/it] 12%|█▏        | 36/300 [00:56<06:38,  1.51s/it] 12%|█▏        | 37/300 [00:56<05:25,  1.24s/it] 13%|█▎        | 38/300 [00:58<06:29,  1.49s/it] 13%|█▎        | 39/300 [01:00<07:22,  1.70s/it] 13%|█▎        | 40/300 [01:03<07:57,  1.83s/it] 14%|█▎        | 41/300 [01:04<07:49,  1.81s/it] 14%|█▍        | 42/300 [01:05<06:17,  1.46s/it] 14%|█▍        | 43/300 [01:07<07:03,  1.65s/it] 15%|█▍        | 44/300 [01:08<05:32,  1.30s/it] 15%|█▌        | 45/300 [01:10<06:28,  1.53s/it] 15%|█▌        | 46/300 [01:10<05:24,  1.28s/it] 16%|█▌        | 47/300 [01:12<05:32,  1.31s/it] 16%|█▌        | 48/300 [01:14<06:36,  1.58s/it] 16%|█▋        | 49/300 [01:15<06:29,  1.55s/it] 17%|█▋        | 50/300 [01:18<07:17,  1.75s/it] 17%|█▋        | 51/300 [01:20<07:31,  1.82s/it] 17%|█▋        | 52/300 [01:21<07:23,  1.79s/it] 18%|█▊        | 53/300 [01:23<06:48,  1.65s/it] 18%|█▊        | 54/300 [01:23<05:38,  1.38s/it] 18%|█▊        | 55/300 [01:24<05:09,  1.26s/it] 19%|█▊        | 56/300 [01:25<04:29,  1.10s/it] 19%|█▉        | 57/300 [01:27<05:45,  1.42s/it] 19%|█▉        | 58/300 [01:28<04:37,  1.15s/it] 20%|█▉        | 59/300 [01:29<05:17,  1.32s/it] 20%|██        | 60/300 [01:31<04:58,  1.25s/it] 20%|██        | 61/300 [01:33<06:05,  1.53s/it] 21%|██        | 62/300 [01:33<05:05,  1.28s/it] 21%|██        | 63/300 [01:35<05:47,  1.47s/it] 21%|██▏       | 64/300 [01:36<05:19,  1.35s/it] 22%|██▏       | 65/300 [01:38<05:34,  1.42s/it] 22%|██▏       | 66/300 [01:40<06:28,  1.66s/it] 22%|██▏       | 67/300 [01:42<06:56,  1.79s/it] 23%|██▎       | 68/300 [01:44<07:22,  1.91s/it] 23%|██▎       | 69/300 [01:45<06:17,  1.63s/it] 23%|██▎       | 70/300 [01:48<06:49,  1.78s/it] 24%|██▎       | 71/300 [01:49<06:00,  1.58s/it] 24%|██▍       | 72/300 [01:50<05:38,  1.48s/it] 24%|██▍       | 73/300 [01:51<05:28,  1.44s/it] 25%|██▍       | 74/300 [01:52<05:04,  1.35s/it] 25%|██▌       | 75/300 [01:55<05:57,  1.59s/it] 25%|██▌       | 76/300 [01:56<05:55,  1.59s/it] 26%|██▌       | 77/300 [01:57<04:43,  1.27s/it] 26%|██▌       | 78/300 [01:57<03:57,  1.07s/it] 26%|██▋       | 79/300 [01:58<03:33,  1.04it/s] 27%|██▋       | 80/300 [01:59<03:19,  1.10it/s] 27%|██▋       | 81/300 [02:01<04:43,  1.29s/it] 27%|██▋       | 82/300 [02:03<05:06,  1.41s/it] 28%|██▊       | 83/300 [02:04<05:22,  1.49s/it] 28%|██▊       | 84/300 [02:06<06:01,  1.68s/it] 28%|██▊       | 85/300 [02:08<05:43,  1.60s/it] 29%|██▊       | 86/300 [02:09<05:35,  1.57s/it] 29%|██▉       | 87/300 [02:11<05:41,  1.60s/it] 29%|██▉       | 88/300 [02:12<04:42,  1.33s/it] 30%|██▉       | 89/300 [02:14<05:31,  1.57s/it] 30%|███       | 90/300 [02:15<04:34,  1.30s/it] 30%|███       | 91/300 [02:15<03:56,  1.13s/it] 31%|███       | 92/300 [02:16<04:00,  1.15s/it] 31%|███       | 93/300 [02:19<04:57,  1.44s/it] 31%|███▏      | 94/300 [02:20<04:40,  1.36s/it] 32%|███▏      | 95/300 [02:22<05:30,  1.61s/it] 32%|███▏      | 96/300 [02:24<06:00,  1.77s/it] 32%|███▏      | 97/300 [02:26<06:25,  1.90s/it] 33%|███▎      | 98/300 [02:27<04:59,  1.48s/it] 33%|███▎      | 99/300 [02:29<05:35,  1.67s/it] 33%|███▎      | 100/300 [02:31<06:02,  1.81s/it] 34%|███▎      | 101/300 [02:32<05:18,  1.60s/it] 34%|███▍      | 102/300 [02:33<04:36,  1.40s/it] 34%|███▍      | 103/300 [02:34<04:01,  1.23s/it] 35%|███▍      | 104/300 [02:35<03:33,  1.09s/it] 35%|███▌      | 105/300 [02:37<04:46,  1.47s/it] 35%|███▌      | 106/300 [02:38<04:19,  1.34s/it] 36%|███▌      | 107/300 [02:41<05:22,  1.67s/it] 36%|███▌      | 108/300 [02:41<04:24,  1.38s/it] 36%|███▋      | 109/300 [02:43<04:34,  1.44s/it] 37%|███▋      | 110/300 [02:45<05:23,  1.70s/it] 37%|███▋      | 111/300 [02:47<05:38,  1.79s/it] 37%|███▋      | 112/300 [02:50<06:15,  2.00s/it] 38%|███▊      | 113/300 [02:50<05:04,  1.63s/it] 38%|███▊      | 114/300 [02:52<05:16,  1.70s/it] 38%|███▊      | 115/300 [02:54<05:42,  1.85s/it] 39%|███▊      | 116/300 [02:57<06:04,  1.98s/it] 39%|███▉      | 117/300 [02:59<06:32,  2.14s/it] 39%|███▉      | 118/300 [03:02<06:48,  2.24s/it] 40%|███▉      | 119/300 [03:04<06:55,  2.30s/it] 40%|████      | 120/300 [03:06<06:03,  2.02s/it] 40%|████      | 121/300 [03:06<04:59,  1.68s/it] 41%|████      | 122/300 [03:08<04:55,  1.66s/it] 41%|████      | 123/300 [03:10<05:08,  1.74s/it] 41%|████▏     | 124/300 [03:12<05:37,  1.92s/it] 42%|████▏     | 125/300 [03:15<05:58,  2.05s/it] 42%|████▏     | 126/300 [03:16<05:17,  1.83s/it] 42%|████▏     | 127/300 [03:18<05:49,  2.02s/it] 43%|████▎     | 128/300 [03:21<06:01,  2.10s/it] 43%|████▎     | 129/300 [03:22<05:03,  1.77s/it] 43%|████▎     | 130/300 [03:24<05:30,  1.94s/it] 44%|████▎     | 131/300 [03:25<04:42,  1.67s/it] 44%|████▍     | 132/300 [03:27<05:14,  1.87s/it] 44%|████▍     | 133/300 [03:29<04:34,  1.65s/it] 45%|████▍     | 134/300 [03:29<03:55,  1.42s/it] 45%|████▌     | 135/300 [03:31<04:16,  1.56s/it] 45%|████▌     | 136/300 [03:32<03:36,  1.32s/it] 46%|████▌     | 137/300 [03:34<04:19,  1.59s/it] 46%|████▌     | 138/300 [03:37<04:50,  1.79s/it] 46%|████▋     | 139/300 [03:38<04:52,  1.81s/it] 47%|████▋     | 140/300 [03:42<06:16,  2.35s/it] 47%|████▋     | 141/300 [03:43<05:14,  1.98s/it] 47%|████▋     | 142/300 [03:46<05:38,  2.15s/it] 48%|████▊     | 143/300 [03:48<05:21,  2.05s/it] 48%|████▊     | 144/300 [03:50<05:35,  2.15s/it] 48%|████▊     | 145/300 [03:53<05:53,  2.28s/it] 49%|████▊     | 146/300 [03:55<05:47,  2.25s/it] 49%|████▉     | 147/300 [03:56<05:20,  2.10s/it] 49%|████▉     | 148/300 [03:57<04:26,  1.75s/it] 50%|████▉     | 149/300 [04:00<04:55,  1.95s/it] 50%|█████     | 150/300 [04:01<04:26,  1.78s/it] 50%|█████     | 151/300 [04:03<04:14,  1.71s/it] 51%|█████     | 152/300 [04:04<03:41,  1.50s/it] 51%|█████     | 153/300 [04:06<04:10,  1.71s/it] 51%|█████▏    | 154/300 [04:09<04:52,  2.00s/it] 52%|█████▏    | 155/300 [04:11<05:12,  2.15s/it] 52%|█████▏    | 156/300 [04:12<04:05,  1.71s/it] 52%|█████▏    | 157/300 [04:14<04:18,  1.81s/it] 53%|█████▎    | 158/300 [04:16<04:39,  1.97s/it] 53%|█████▎    | 159/300 [04:19<04:56,  2.10s/it] 53%|█████▎    | 160/300 [04:20<04:37,  1.98s/it] 54%|█████▎    | 161/300 [04:23<04:57,  2.14s/it] 54%|█████▍    | 162/300 [04:25<05:08,  2.23s/it] 54%|█████▍    | 163/300 [04:28<05:15,  2.30s/it] 55%|█████▍    | 164/300 [04:29<04:41,  2.07s/it] 55%|█████▌    | 165/300 [04:32<04:51,  2.16s/it] 55%|█████▌    | 166/300 [04:34<04:59,  2.24s/it] 56%|█████▌    | 167/300 [04:36<04:39,  2.10s/it] 56%|█████▌    | 168/300 [04:37<03:44,  1.70s/it] 56%|█████▋    | 169/300 [04:39<04:06,  1.88s/it] 57%|█████▋    | 170/300 [04:40<03:42,  1.71s/it] 57%|█████▋    | 171/300 [04:42<04:04,  1.89s/it] 57%|█████▋    | 172/300 [04:44<03:33,  1.67s/it] 58%|█████▊    | 173/300 [04:45<03:38,  1.72s/it] 58%|█████▊    | 174/300 [04:48<04:04,  1.94s/it] 58%|█████▊    | 175/300 [04:49<03:19,  1.60s/it] 59%|█████▊    | 176/300 [04:51<03:54,  1.89s/it] 59%|█████▉    | 177/300 [04:54<04:11,  2.05s/it] 59%|█████▉    | 178/300 [04:56<04:24,  2.17s/it] 60%|█████▉    | 179/300 [04:57<03:33,  1.76s/it] 60%|██████    | 180/300 [04:58<02:54,  1.46s/it] 60%|██████    | 181/300 [05:00<03:04,  1.55s/it] 61%|██████    | 182/300 [05:01<03:18,  1.68s/it] 61%|██████    | 183/300 [05:03<03:25,  1.76s/it] 61%|██████▏   | 184/300 [05:06<03:52,  2.00s/it] 62%|██████▏   | 185/300 [05:07<03:13,  1.68s/it] 62%|██████▏   | 186/300 [05:09<03:39,  1.93s/it] 62%|██████▏   | 187/300 [05:11<03:30,  1.87s/it] 63%|██████▎   | 188/300 [05:13<03:25,  1.84s/it] 63%|██████▎   | 189/300 [05:14<02:49,  1.52s/it] 63%|██████▎   | 190/300 [05:16<03:16,  1.79s/it] 64%|██████▎   | 191/300 [05:18<03:31,  1.94s/it] 64%|██████▍   | 192/300 [05:21<03:44,  2.08s/it] 64%|██████▍   | 193/300 [05:23<03:53,  2.18s/it] 65%|██████▍   | 194/300 [05:25<03:51,  2.18s/it] 65%|██████▌   | 195/300 [05:27<03:36,  2.06s/it] 65%|██████▌   | 196/300 [05:30<03:48,  2.20s/it] 66%|██████▌   | 197/300 [05:32<03:57,  2.30s/it] 66%|██████▌   | 198/300 [05:33<03:17,  1.93s/it] 66%|██████▋   | 199/300 [05:34<02:36,  1.55s/it] 67%|██████▋   | 200/300 [05:36<03:03,  1.83s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (17161 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [05:40<04:02,  2.45s/it] 67%|██████▋   | 202/300 [05:44<04:20,  2.65s/it] 68%|██████▊   | 203/300 [05:46<04:26,  2.75s/it] 68%|██████▊   | 204/300 [05:50<04:33,  2.85s/it] 68%|██████▊   | 205/300 [05:51<03:59,  2.52s/it] 69%|██████▊   | 206/300 [05:54<04:10,  2.67s/it] 69%|██████▉   | 207/300 [05:56<03:31,  2.27s/it] 69%|██████▉   | 208/300 [05:59<03:49,  2.49s/it] 70%|██████▉   | 209/300 [06:02<03:59,  2.64s/it] 70%|███████   | 210/300 [06:05<04:05,  2.72s/it] 70%|███████   | 211/300 [06:08<04:11,  2.82s/it] 71%|███████   | 212/300 [06:11<04:13,  2.89s/it] 71%|███████   | 213/300 [06:12<03:24,  2.35s/it] 71%|███████▏  | 214/300 [06:15<03:39,  2.55s/it] 72%|███████▏  | 215/300 [06:17<03:16,  2.31s/it] 72%|███████▏  | 216/300 [06:20<03:42,  2.65s/it] 72%|███████▏  | 217/300 [06:23<03:51,  2.79s/it] 73%|███████▎  | 218/300 [06:25<03:26,  2.52s/it] 73%|███████▎  | 219/300 [06:27<03:16,  2.43s/it] 73%|███████▎  | 220/300 [06:29<03:05,  2.32s/it] 74%|███████▎  | 221/300 [06:30<02:36,  1.98s/it] 74%|███████▍  | 222/300 [06:33<02:55,  2.25s/it] 74%|███████▍  | 223/300 [06:36<03:09,  2.47s/it] 75%|███████▍  | 224/300 [06:38<02:51,  2.25s/it] 75%|███████▌  | 225/300 [06:41<03:03,  2.44s/it] 75%|███████▌  | 226/300 [06:44<03:04,  2.49s/it] 76%|███████▌  | 227/300 [06:47<03:15,  2.68s/it] 76%|███████▌  | 228/300 [06:50<03:19,  2.78s/it] 76%|███████▋  | 229/300 [06:53<03:19,  2.81s/it] 77%|███████▋  | 230/300 [06:56<03:20,  2.87s/it] 77%|███████▋  | 231/300 [06:58<03:13,  2.80s/it] 77%|███████▋  | 232/300 [07:00<02:42,  2.40s/it] 78%|███████▊  | 233/300 [07:01<02:16,  2.04s/it] 78%|███████▊  | 234/300 [07:02<02:05,  1.91s/it] 78%|███████▊  | 235/300 [07:05<02:15,  2.08s/it] 79%|███████▊  | 236/300 [07:07<02:02,  1.92s/it] 79%|███████▉  | 237/300 [07:08<01:49,  1.73s/it] 79%|███████▉  | 238/300 [07:11<02:05,  2.03s/it] 80%|███████▉  | 239/300 [07:14<02:23,  2.36s/it] 80%|████████  | 240/300 [07:17<02:33,  2.56s/it] 80%|████████  | 241/300 [07:18<02:07,  2.16s/it] 81%|████████  | 242/300 [07:21<02:18,  2.39s/it] 81%|████████  | 243/300 [07:24<02:26,  2.57s/it] 81%|████████▏ | 244/300 [07:25<02:02,  2.19s/it] 82%|████████▏ | 245/300 [07:27<01:58,  2.16s/it] 82%|████████▏ | 246/300 [07:30<02:04,  2.31s/it] 82%|████████▏ | 247/300 [07:32<02:03,  2.32s/it] 83%|████████▎ | 248/300 [07:33<01:41,  1.95s/it] 83%|████████▎ | 249/300 [07:36<01:53,  2.23s/it] 83%|████████▎ | 250/300 [07:38<01:47,  2.16s/it] 84%|████████▎ | 251/300 [07:41<01:57,  2.39s/it] 84%|████████▍ | 252/300 [07:43<01:52,  2.34s/it] 84%|████████▍ | 253/300 [07:45<01:41,  2.17s/it] 85%|████████▍ | 254/300 [07:47<01:39,  2.16s/it] 85%|████████▌ | 255/300 [07:50<01:49,  2.44s/it] 85%|████████▌ | 256/300 [07:53<01:56,  2.64s/it] 86%|████████▌ | 257/300 [07:55<01:35,  2.23s/it] 86%|████████▌ | 258/300 [07:58<01:40,  2.40s/it] 86%|████████▋ | 259/300 [08:01<01:46,  2.61s/it] 87%|████████▋ | 260/300 [08:03<01:42,  2.57s/it] 87%|████████▋ | 261/300 [08:06<01:45,  2.71s/it] 87%|████████▋ | 262/300 [08:09<01:47,  2.82s/it] 88%|████████▊ | 263/300 [08:12<01:43,  2.78s/it] 88%|████████▊ | 264/300 [08:14<01:31,  2.54s/it] 88%|████████▊ | 265/300 [08:15<01:14,  2.14s/it] 89%|████████▊ | 266/300 [08:18<01:21,  2.40s/it] 89%|████████▉ | 267/300 [08:20<01:12,  2.19s/it] 89%|████████▉ | 268/300 [08:23<01:17,  2.43s/it] 90%|████████▉ | 269/300 [08:24<01:02,  2.02s/it] 90%|█████████ | 270/300 [08:27<01:09,  2.31s/it] 90%|█████████ | 271/300 [08:28<00:58,  2.02s/it] 91%|█████████ | 272/300 [08:31<01:04,  2.31s/it] 91%|█████████ | 273/300 [08:32<00:53,  1.98s/it] 91%|█████████▏| 274/300 [08:35<00:58,  2.25s/it] 92%|█████████▏| 275/300 [08:38<01:00,  2.44s/it] 92%|█████████▏| 276/300 [08:40<00:51,  2.17s/it] 92%|█████████▏| 277/300 [08:41<00:41,  1.78s/it] 93%|█████████▎| 278/300 [08:43<00:40,  1.85s/it] 93%|█████████▎| 279/300 [08:44<00:39,  1.87s/it] 93%|█████████▎| 280/300 [08:48<00:44,  2.22s/it] 94%|█████████▎| 281/300 [08:49<00:39,  2.07s/it] 94%|█████████▍| 282/300 [08:52<00:39,  2.22s/it] 94%|█████████▍| 283/300 [08:54<00:36,  2.12s/it] 95%|█████████▍| 284/300 [08:56<00:35,  2.19s/it] 95%|█████████▌| 285/300 [08:59<00:36,  2.47s/it] 95%|█████████▌| 286/300 [09:02<00:36,  2.59s/it] 96%|█████████▌| 287/300 [09:05<00:35,  2.74s/it] 96%|█████████▌| 288/300 [09:06<00:26,  2.20s/it] 96%|█████████▋| 289/300 [09:09<00:26,  2.45s/it] 97%|█████████▋| 290/300 [09:12<00:25,  2.58s/it] 97%|█████████▋| 291/300 [09:15<00:24,  2.69s/it] 97%|█████████▋| 292/300 [09:18<00:22,  2.77s/it] 98%|█████████▊| 293/300 [09:20<00:17,  2.51s/it] 98%|█████████▊| 294/300 [09:23<00:15,  2.62s/it] 98%|█████████▊| 295/300 [09:25<00:12,  2.45s/it] 99%|█████████▊| 296/300 [09:28<00:10,  2.55s/it] 99%|█████████▉| 297/300 [09:31<00:08,  2.72s/it] 99%|█████████▉| 298/300 [09:33<00:05,  2.71s/it]100%|█████████▉| 299/300 [09:35<00:02,  2.27s/it]100%|██████████| 300/300 [09:38<00:00,  2.49s/it]100%|██████████| 300/300 [09:38<00:00,  1.93s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.26s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.32s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.34s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.78s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.98s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:03<15:06,  3.03s/it]  1%|          | 2/300 [00:05<12:24,  2.50s/it]  1%|          | 3/300 [00:05<07:57,  1.61s/it]  1%|▏         | 4/300 [00:07<07:39,  1.55s/it]  2%|▏         | 5/300 [00:07<05:53,  1.20s/it]  2%|▏         | 6/300 [00:08<04:55,  1.00s/it]  2%|▏         | 7/300 [00:10<06:40,  1.37s/it]  3%|▎         | 8/300 [00:11<05:40,  1.17s/it]  3%|▎         | 9/300 [00:11<04:57,  1.02s/it]  3%|▎         | 10/300 [00:14<07:07,  1.47s/it]  4%|▎         | 11/300 [00:16<08:37,  1.79s/it]  4%|▍         | 12/300 [00:17<06:53,  1.44s/it]  4%|▍         | 13/300 [00:18<05:42,  1.19s/it]  5%|▍         | 14/300 [00:20<07:30,  1.57s/it]  5%|▌         | 15/300 [00:23<09:07,  1.92s/it]  5%|▌         | 16/300 [00:25<09:10,  1.94s/it]  6%|▌         | 17/300 [00:27<09:53,  2.10s/it]  6%|▌         | 18/300 [00:28<07:48,  1.66s/it]  6%|▋         | 19/300 [00:28<06:05,  1.30s/it]  7%|▋         | 20/300 [00:29<05:17,  1.14s/it]  7%|▋         | 21/300 [00:30<05:30,  1.18s/it]  7%|▋         | 22/300 [00:32<06:30,  1.41s/it]  8%|▊         | 23/300 [00:33<05:33,  1.20s/it]  8%|▊         | 24/300 [00:34<05:02,  1.09s/it]  8%|▊         | 25/300 [00:35<04:17,  1.07it/s]  9%|▊         | 26/300 [00:36<05:34,  1.22s/it]  9%|▉         | 27/300 [00:38<06:34,  1.45s/it]  9%|▉         | 28/300 [00:40<06:13,  1.37s/it] 10%|▉         | 29/300 [00:40<05:23,  1.19s/it] 10%|█         | 30/300 [00:43<06:58,  1.55s/it] 10%|█         | 31/300 [00:45<08:14,  1.84s/it] 11%|█         | 32/300 [00:47<08:31,  1.91s/it] 11%|█         | 33/300 [00:50<09:16,  2.08s/it] 11%|█▏        | 34/300 [00:52<09:30,  2.14s/it] 12%|█▏        | 35/300 [00:55<09:52,  2.23s/it] 12%|█▏        | 36/300 [00:55<07:43,  1.76s/it] 12%|█▏        | 37/300 [00:56<06:13,  1.42s/it] 13%|█▎        | 38/300 [00:58<06:54,  1.58s/it] 13%|█▎        | 39/300 [01:00<08:01,  1.85s/it] 13%|█▎        | 40/300 [01:03<08:44,  2.02s/it] 14%|█▎        | 41/300 [01:05<08:34,  1.99s/it] 14%|█▍        | 42/300 [01:05<06:53,  1.60s/it] 14%|█▍        | 43/300 [01:06<06:09,  1.44s/it] 15%|█▍        | 44/300 [01:07<05:07,  1.20s/it] 15%|█▌        | 45/300 [01:09<06:33,  1.54s/it] 15%|█▌        | 46/300 [01:10<05:26,  1.29s/it] 16%|█▌        | 47/300 [01:11<04:48,  1.14s/it] 16%|█▌        | 48/300 [01:13<06:27,  1.54s/it] 16%|█▋        | 49/300 [01:15<06:35,  1.57s/it] 17%|█▋        | 50/300 [01:17<07:41,  1.85s/it] 17%|█▋        | 51/300 [01:20<08:07,  1.96s/it] 17%|█▋        | 52/300 [01:21<07:40,  1.86s/it] 18%|█▊        | 53/300 [01:23<07:25,  1.80s/it] 18%|█▊        | 54/300 [01:23<05:50,  1.42s/it] 18%|█▊        | 55/300 [01:24<04:57,  1.21s/it] 19%|█▊        | 56/300 [01:25<04:25,  1.09s/it] 19%|█▉        | 57/300 [01:27<06:03,  1.49s/it] 19%|█▉        | 58/300 [01:29<06:13,  1.54s/it] 20%|█▉        | 59/300 [01:31<06:40,  1.66s/it] 20%|██        | 60/300 [01:32<06:05,  1.52s/it] 20%|██        | 61/300 [01:34<06:18,  1.58s/it] 21%|██        | 62/300 [01:35<05:17,  1.33s/it] 21%|██        | 63/300 [01:37<06:08,  1.56s/it] 21%|██▏       | 64/300 [01:38<05:24,  1.38s/it] 22%|██▏       | 65/300 [01:39<05:32,  1.42s/it] 22%|██▏       | 66/300 [01:40<04:47,  1.23s/it] 22%|██▏       | 67/300 [01:41<04:58,  1.28s/it] 23%|██▎       | 68/300 [01:44<06:18,  1.63s/it] 23%|██▎       | 69/300 [01:45<05:44,  1.49s/it] 23%|██▎       | 70/300 [01:47<06:45,  1.76s/it] 24%|██▎       | 71/300 [01:48<05:26,  1.43s/it] 24%|██▍       | 72/300 [01:49<05:23,  1.42s/it] 24%|██▍       | 73/300 [01:51<05:19,  1.41s/it] 25%|██▍       | 74/300 [01:52<05:06,  1.36s/it] 25%|██▌       | 75/300 [01:55<06:17,  1.68s/it] 25%|██▌       | 76/300 [01:56<06:20,  1.70s/it] 26%|██▌       | 77/300 [01:57<05:02,  1.36s/it] 26%|██▌       | 78/300 [01:57<04:14,  1.15s/it] 26%|██▋       | 79/300 [01:58<03:49,  1.04s/it] 27%|██▋       | 80/300 [01:59<03:30,  1.04it/s] 27%|██▋       | 81/300 [02:02<05:09,  1.41s/it] 27%|██▋       | 82/300 [02:04<06:18,  1.74s/it] 28%|██▊       | 83/300 [02:06<07:05,  1.96s/it] 28%|██▊       | 84/300 [02:07<05:38,  1.57s/it] 28%|██▊       | 85/300 [02:08<04:44,  1.32s/it] 29%|██▊       | 86/300 [02:10<05:53,  1.65s/it] 29%|██▉       | 87/300 [02:11<05:19,  1.50s/it] 29%|██▉       | 88/300 [02:12<04:29,  1.27s/it] 30%|██▉       | 89/300 [02:14<04:32,  1.29s/it] 30%|███       | 90/300 [02:14<03:47,  1.08s/it] 30%|███       | 91/300 [02:15<03:26,  1.01it/s] 31%|███       | 92/300 [02:16<03:45,  1.09s/it] 31%|███       | 93/300 [02:17<03:17,  1.05it/s] 31%|███▏      | 94/300 [02:18<03:38,  1.06s/it] 32%|███▏      | 95/300 [02:20<04:13,  1.24s/it] 32%|███▏      | 96/300 [02:21<04:05,  1.20s/it] 32%|███▏      | 97/300 [02:22<03:49,  1.13s/it] 33%|███▎      | 98/300 [02:22<03:12,  1.05it/s] 33%|███▎      | 99/300 [02:23<03:16,  1.02it/s] 33%|███▎      | 100/300 [02:24<02:52,  1.16it/s] 34%|███▎      | 101/300 [02:25<02:45,  1.20it/s] 34%|███▍      | 102/300 [02:26<02:52,  1.15it/s] 34%|███▍      | 103/300 [02:27<02:52,  1.14it/s] 35%|███▍      | 104/300 [02:27<02:45,  1.19it/s] 35%|███▌      | 105/300 [02:30<04:32,  1.40s/it] 35%|███▌      | 106/300 [02:31<04:15,  1.32s/it] 36%|███▌      | 107/300 [02:34<05:37,  1.75s/it] 36%|███▌      | 108/300 [02:36<05:46,  1.80s/it] 36%|███▋      | 109/300 [02:38<05:40,  1.78s/it] 37%|███▋      | 110/300 [02:40<06:13,  1.97s/it] 37%|███▋      | 111/300 [02:42<06:26,  2.05s/it] 37%|███▋      | 112/300 [02:45<07:06,  2.27s/it] 38%|███▊      | 113/300 [02:46<05:43,  1.84s/it] 38%|███▊      | 114/300 [02:47<04:56,  1.59s/it] 38%|███▊      | 115/300 [02:48<04:13,  1.37s/it] 39%|███▊      | 116/300 [02:50<05:05,  1.66s/it] 39%|███▉      | 117/300 [02:53<06:07,  2.01s/it] 39%|███▉      | 118/300 [02:55<05:43,  1.89s/it] 40%|███▉      | 119/300 [02:57<05:47,  1.92s/it] 40%|████      | 120/300 [02:58<05:20,  1.78s/it] 40%|████      | 121/300 [02:59<04:30,  1.51s/it] 41%|████      | 122/300 [03:02<05:36,  1.89s/it] 41%|████      | 123/300 [03:04<06:20,  2.15s/it] 41%|████▏     | 124/300 [03:07<06:15,  2.13s/it] 42%|████▏     | 125/300 [03:08<05:20,  1.83s/it] 42%|████▏     | 126/300 [03:09<05:00,  1.73s/it] 42%|████▏     | 127/300 [03:11<05:15,  1.82s/it] 43%|████▎     | 128/300 [03:14<06:06,  2.13s/it] 43%|████▎     | 129/300 [03:15<05:07,  1.80s/it] 43%|████▎     | 130/300 [03:18<05:48,  2.05s/it] 44%|████▎     | 131/300 [03:20<06:16,  2.23s/it] 44%|████▍     | 132/300 [03:23<06:38,  2.37s/it] 44%|████▍     | 133/300 [03:24<05:37,  2.02s/it] 45%|████▍     | 134/300 [03:27<06:35,  2.38s/it] 45%|████▌     | 135/300 [03:30<06:23,  2.33s/it] 45%|████▌     | 136/300 [03:31<05:08,  1.88s/it] 46%|████▌     | 137/300 [03:33<05:26,  2.01s/it] 46%|████▌     | 138/300 [03:35<05:50,  2.16s/it] 46%|████▋     | 139/300 [03:37<05:40,  2.12s/it] 47%|████▋     | 140/300 [03:41<07:09,  2.69s/it] 47%|████▋     | 141/300 [03:42<05:53,  2.22s/it] 47%|████▋     | 142/300 [03:43<04:50,  1.84s/it] 48%|████▊     | 143/300 [03:46<05:06,  1.95s/it] 48%|████▊     | 144/300 [03:47<04:35,  1.77s/it] 48%|████▊     | 145/300 [03:49<04:37,  1.79s/it] 49%|████▊     | 146/300 [03:52<05:17,  2.06s/it] 49%|████▉     | 147/300 [03:54<05:11,  2.04s/it] 49%|████▉     | 148/300 [03:54<04:18,  1.70s/it] 50%|████▉     | 149/300 [03:56<04:12,  1.68s/it] 50%|█████     | 150/300 [03:58<04:12,  1.68s/it] 50%|█████     | 151/300 [04:00<04:49,  1.94s/it] 51%|█████     | 152/300 [04:03<05:04,  2.06s/it] 51%|█████     | 153/300 [04:03<03:59,  1.63s/it] 51%|█████▏    | 154/300 [04:06<04:44,  1.95s/it] 52%|█████▏    | 155/300 [04:09<05:20,  2.21s/it] 52%|█████▏    | 156/300 [04:10<04:34,  1.91s/it] 52%|█████▏    | 157/300 [04:12<04:58,  2.08s/it] 53%|█████▎    | 158/300 [04:15<05:19,  2.25s/it] 53%|█████▎    | 159/300 [04:17<05:13,  2.22s/it] 53%|█████▎    | 160/300 [04:19<05:02,  2.16s/it] 54%|█████▎    | 161/300 [04:22<05:27,  2.36s/it] 54%|█████▍    | 162/300 [04:25<05:39,  2.46s/it] 54%|█████▍    | 163/300 [04:28<05:56,  2.61s/it] 55%|█████▍    | 164/300 [04:29<05:16,  2.33s/it] 55%|█████▌    | 165/300 [04:32<05:18,  2.36s/it] 55%|█████▌    | 166/300 [04:34<04:59,  2.23s/it] 56%|█████▌    | 167/300 [04:36<04:45,  2.14s/it] 56%|█████▌    | 168/300 [04:37<03:50,  1.75s/it] 56%|█████▋    | 169/300 [04:38<03:47,  1.74s/it] 57%|█████▋    | 170/300 [04:40<03:30,  1.62s/it] 57%|█████▋    | 171/300 [04:42<03:43,  1.73s/it] 57%|█████▋    | 172/300 [04:43<03:22,  1.58s/it] 58%|█████▊    | 173/300 [04:45<03:38,  1.72s/it] 58%|█████▊    | 174/300 [04:48<04:15,  2.03s/it] 58%|█████▊    | 175/300 [04:48<03:29,  1.68s/it] 59%|█████▊    | 176/300 [04:51<04:12,  2.03s/it] 59%|█████▉    | 177/300 [04:52<03:31,  1.72s/it] 59%|█████▉    | 178/300 [04:53<02:56,  1.45s/it] 60%|█████▉    | 179/300 [04:55<03:22,  1.67s/it] 60%|██████    | 180/300 [04:57<03:03,  1.53s/it] 60%|██████    | 181/300 [04:58<03:14,  1.64s/it] 61%|██████    | 182/300 [05:00<03:10,  1.61s/it] 61%|██████    | 183/300 [05:03<03:53,  1.99s/it] 61%|██████▏   | 184/300 [05:05<03:41,  1.91s/it] 62%|██████▏   | 185/300 [05:05<03:05,  1.62s/it] 62%|██████▏   | 186/300 [05:07<03:17,  1.73s/it] 62%|██████▏   | 187/300 [05:09<03:13,  1.71s/it] 63%|██████▎   | 188/300 [05:11<03:02,  1.63s/it] 63%|██████▎   | 189/300 [05:13<03:42,  2.00s/it] 63%|██████▎   | 190/300 [05:16<03:44,  2.04s/it] 64%|██████▎   | 191/300 [05:18<03:59,  2.19s/it] 64%|██████▍   | 192/300 [05:19<03:16,  1.82s/it] 64%|██████▍   | 193/300 [05:22<03:42,  2.08s/it] 65%|██████▍   | 194/300 [05:23<03:07,  1.77s/it] 65%|██████▌   | 195/300 [05:25<03:12,  1.83s/it] 65%|██████▌   | 196/300 [05:26<03:05,  1.79s/it] 66%|██████▌   | 197/300 [05:29<03:34,  2.08s/it] 66%|██████▌   | 198/300 [05:32<03:59,  2.35s/it] 66%|██████▋   | 199/300 [05:33<03:08,  1.86s/it] 67%|██████▋   | 200/300 [05:36<03:33,  2.14s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (17161 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [05:39<04:18,  2.61s/it] 67%|██████▋   | 202/300 [05:43<04:41,  2.88s/it] 68%|██████▊   | 203/300 [05:45<04:25,  2.74s/it] 68%|██████▊   | 204/300 [05:49<04:42,  2.94s/it] 68%|██████▊   | 205/300 [05:52<04:53,  3.09s/it] 69%|██████▊   | 206/300 [05:55<04:40,  2.99s/it] 69%|██████▉   | 207/300 [05:56<03:55,  2.53s/it] 69%|██████▉   | 208/300 [06:00<04:14,  2.77s/it] 70%|██████▉   | 209/300 [06:03<04:23,  2.90s/it] 70%|███████   | 210/300 [06:06<04:29,  2.99s/it] 70%|███████   | 211/300 [06:10<04:36,  3.11s/it] 71%|███████   | 212/300 [06:13<04:42,  3.21s/it] 71%|███████   | 213/300 [06:16<04:30,  3.11s/it] 71%|███████▏  | 214/300 [06:19<04:16,  2.98s/it] 72%|███████▏  | 215/300 [06:20<03:45,  2.65s/it] 72%|███████▏  | 216/300 [06:23<03:30,  2.51s/it] 72%|███████▏  | 217/300 [06:26<03:50,  2.78s/it] 73%|███████▎  | 218/300 [06:28<03:29,  2.55s/it] 73%|███████▎  | 219/300 [06:30<03:21,  2.49s/it] 73%|███████▎  | 220/300 [06:33<03:28,  2.61s/it] 74%|███████▎  | 221/300 [06:37<03:42,  2.82s/it] 74%|███████▍  | 222/300 [06:40<03:51,  2.97s/it] 74%|███████▍  | 223/300 [06:43<03:55,  3.06s/it] 75%|███████▍  | 224/300 [06:45<03:26,  2.72s/it] 75%|███████▌  | 225/300 [06:48<03:34,  2.86s/it] 75%|███████▌  | 226/300 [06:51<03:29,  2.84s/it] 76%|███████▌  | 227/300 [06:54<03:30,  2.88s/it] 76%|███████▌  | 228/300 [06:57<03:37,  3.02s/it] 76%|███████▋  | 229/300 [07:01<03:37,  3.06s/it] 77%|███████▋  | 230/300 [07:04<03:40,  3.15s/it] 77%|███████▋  | 231/300 [07:07<03:33,  3.09s/it] 77%|███████▋  | 232/300 [07:08<02:58,  2.62s/it] 78%|███████▊  | 233/300 [07:11<03:04,  2.76s/it] 78%|███████▊  | 234/300 [07:13<02:45,  2.50s/it] 78%|███████▊  | 235/300 [07:17<02:56,  2.72s/it] 79%|███████▊  | 236/300 [07:19<02:43,  2.56s/it] 79%|███████▉  | 237/300 [07:22<02:56,  2.81s/it] 79%|███████▉  | 238/300 [07:26<03:05,  3.00s/it] 80%|███████▉  | 239/300 [07:29<03:11,  3.14s/it] 80%|████████  | 240/300 [07:32<03:12,  3.21s/it] 80%|████████  | 241/300 [07:34<02:45,  2.80s/it] 81%|████████  | 242/300 [07:36<02:28,  2.56s/it] 81%|████████  | 243/300 [07:39<02:37,  2.75s/it] 81%|████████▏ | 244/300 [07:41<02:11,  2.36s/it] 82%|████████▏ | 245/300 [07:43<02:08,  2.33s/it] 82%|████████▏ | 246/300 [07:47<02:22,  2.63s/it] 82%|████████▏ | 247/300 [07:48<01:55,  2.17s/it] 83%|████████▎ | 248/300 [07:49<01:35,  1.84s/it] 83%|████████▎ | 249/300 [07:52<01:54,  2.24s/it] 83%|████████▎ | 250/300 [07:54<01:53,  2.28s/it] 84%|████████▎ | 251/300 [07:58<02:08,  2.61s/it] 84%|████████▍ | 252/300 [08:00<02:04,  2.59s/it] 84%|████████▍ | 253/300 [08:02<01:50,  2.35s/it] 85%|████████▍ | 254/300 [08:04<01:48,  2.35s/it] 85%|████████▌ | 255/300 [08:08<02:00,  2.67s/it] 85%|████████▌ | 256/300 [08:10<01:49,  2.48s/it] 86%|████████▌ | 257/300 [08:11<01:31,  2.14s/it] 86%|████████▌ | 258/300 [08:14<01:37,  2.31s/it] 86%|████████▋ | 259/300 [08:17<01:48,  2.63s/it] 87%|████████▋ | 260/300 [08:20<01:49,  2.73s/it] 87%|████████▋ | 261/300 [08:22<01:37,  2.49s/it] 87%|████████▋ | 262/300 [08:25<01:44,  2.74s/it] 88%|████████▊ | 263/300 [08:28<01:41,  2.75s/it] 88%|████████▊ | 264/300 [08:31<01:43,  2.87s/it] 88%|████████▊ | 265/300 [08:35<01:45,  3.01s/it] 89%|████████▊ | 266/300 [08:38<01:46,  3.14s/it] 89%|████████▉ | 267/300 [08:42<01:46,  3.22s/it] 89%|████████▉ | 268/300 [08:43<01:25,  2.67s/it] 90%|████████▉ | 269/300 [08:44<01:07,  2.18s/it] 90%|█████████ | 270/300 [08:47<01:15,  2.52s/it] 90%|█████████ | 271/300 [08:49<01:04,  2.22s/it] 91%|█████████ | 272/300 [08:52<01:11,  2.54s/it] 91%|█████████ | 273/300 [08:54<01:05,  2.43s/it] 91%|█████████▏| 274/300 [08:57<01:05,  2.51s/it] 92%|█████████▏| 275/300 [09:00<01:07,  2.71s/it] 92%|█████████▏| 276/300 [09:02<00:56,  2.33s/it] 92%|█████████▏| 277/300 [09:03<00:43,  1.91s/it] 93%|█████████▎| 278/300 [09:05<00:44,  2.00s/it] 93%|█████████▎| 279/300 [09:08<00:50,  2.40s/it] 93%|█████████▎| 280/300 [09:11<00:50,  2.51s/it] 94%|█████████▎| 281/300 [09:12<00:41,  2.17s/it] 94%|█████████▍| 282/300 [09:14<00:39,  2.19s/it] 94%|█████████▍| 283/300 [09:18<00:42,  2.47s/it] 95%|█████████▍| 284/300 [09:21<00:42,  2.64s/it] 95%|█████████▌| 285/300 [09:23<00:39,  2.63s/it] 95%|█████████▌| 286/300 [09:26<00:35,  2.56s/it] 96%|█████████▌| 287/300 [09:29<00:36,  2.81s/it] 96%|█████████▌| 288/300 [09:32<00:34,  2.88s/it] 96%|█████████▋| 289/300 [09:34<00:27,  2.47s/it] 97%|█████████▋| 290/300 [09:37<00:27,  2.70s/it] 97%|█████████▋| 291/300 [09:40<00:25,  2.87s/it] 97%|█████████▋| 292/300 [09:43<00:23,  2.92s/it] 98%|█████████▊| 293/300 [09:45<00:18,  2.63s/it] 98%|█████████▊| 294/300 [09:48<00:16,  2.78s/it] 98%|█████████▊| 295/300 [09:50<00:13,  2.63s/it] 99%|█████████▊| 296/300 [09:53<00:10,  2.52s/it] 99%|█████████▉| 297/300 [09:56<00:08,  2.79s/it] 99%|█████████▉| 298/300 [10:00<00:05,  2.98s/it]100%|█████████▉| 299/300 [10:01<00:02,  2.53s/it]100%|██████████| 300/300 [10:02<00:00,  2.16s/it]100%|██████████| 300/300 [10:02<00:00,  2.01s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.27s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.32s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.35s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.78s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.98s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:02<14:22,  2.89s/it]  1%|          | 2/300 [00:05<12:49,  2.58s/it]  1%|          | 3/300 [00:05<08:22,  1.69s/it]  1%|▏         | 4/300 [00:07<08:07,  1.65s/it]  2%|▏         | 5/300 [00:08<06:11,  1.26s/it]  2%|▏         | 6/300 [00:09<07:13,  1.47s/it]  2%|▏         | 7/300 [00:12<08:27,  1.73s/it]  3%|▎         | 8/300 [00:12<06:55,  1.42s/it]  3%|▎         | 9/300 [00:13<05:52,  1.21s/it]  3%|▎         | 10/300 [00:16<08:00,  1.66s/it]  4%|▎         | 11/300 [00:19<09:31,  1.98s/it]  4%|▍         | 12/300 [00:19<07:27,  1.55s/it]  4%|▍         | 13/300 [00:20<06:08,  1.28s/it]  5%|▍         | 14/300 [00:21<05:59,  1.26s/it]  5%|▌         | 15/300 [00:24<08:17,  1.75s/it]  5%|▌         | 16/300 [00:26<08:47,  1.86s/it]  6%|▌         | 17/300 [00:29<09:54,  2.10s/it]  6%|▌         | 18/300 [00:31<09:48,  2.09s/it]  6%|▋         | 19/300 [00:31<07:41,  1.64s/it]  7%|▋         | 20/300 [00:32<06:28,  1.39s/it]  7%|▋         | 21/300 [00:33<06:26,  1.38s/it]  7%|▋         | 22/300 [00:36<07:19,  1.58s/it]  8%|▊         | 23/300 [00:37<07:47,  1.69s/it]  8%|▊         | 24/300 [00:40<08:44,  1.90s/it]  8%|▊         | 25/300 [00:42<08:59,  1.96s/it]  9%|▊         | 26/300 [00:44<08:31,  1.87s/it]  9%|▉         | 27/300 [00:46<08:48,  1.94s/it]  9%|▉         | 28/300 [00:47<07:54,  1.74s/it] 10%|▉         | 29/300 [00:48<06:36,  1.46s/it] 10%|█         | 30/300 [00:50<08:04,  1.79s/it] 10%|█         | 31/300 [00:53<09:21,  2.09s/it] 11%|█         | 32/300 [00:54<07:24,  1.66s/it] 11%|█         | 33/300 [00:56<08:43,  1.96s/it] 11%|█▏        | 34/300 [00:59<09:37,  2.17s/it] 12%|█▏        | 35/300 [01:02<10:12,  2.31s/it] 12%|█▏        | 36/300 [01:04<09:48,  2.23s/it] 12%|█▏        | 37/300 [01:04<07:43,  1.76s/it] 13%|█▎        | 38/300 [01:06<07:40,  1.76s/it] 13%|█▎        | 39/300 [01:09<08:48,  2.03s/it] 13%|█▎        | 40/300 [01:11<09:31,  2.20s/it] 14%|█▎        | 41/300 [01:14<09:18,  2.15s/it] 14%|█▍        | 42/300 [01:14<07:26,  1.73s/it] 14%|█▍        | 43/300 [01:17<08:10,  1.91s/it] 15%|█▍        | 44/300 [01:17<06:18,  1.48s/it] 15%|█▌        | 45/300 [01:18<05:03,  1.19s/it] 15%|█▌        | 46/300 [01:20<06:36,  1.56s/it] 16%|█▌        | 47/300 [01:21<05:40,  1.35s/it] 16%|█▌        | 48/300 [01:23<06:35,  1.57s/it] 16%|█▋        | 49/300 [01:25<06:49,  1.63s/it] 17%|█▋        | 50/300 [01:27<07:19,  1.76s/it] 17%|█▋        | 51/300 [01:29<08:04,  1.95s/it] 17%|█▋        | 52/300 [01:31<08:23,  2.03s/it] 18%|█▊        | 53/300 [01:33<08:14,  2.00s/it] 18%|█▊        | 54/300 [01:34<06:26,  1.57s/it] 18%|█▊        | 55/300 [01:35<05:40,  1.39s/it] 19%|█▊        | 56/300 [01:36<04:57,  1.22s/it] 19%|█▉        | 57/300 [01:36<04:08,  1.02s/it] 19%|█▉        | 58/300 [01:37<03:31,  1.14it/s] 20%|█▉        | 59/300 [01:39<04:55,  1.23s/it] 20%|██        | 60/300 [01:40<04:57,  1.24s/it] 20%|██        | 61/300 [01:42<05:39,  1.42s/it] 21%|██        | 62/300 [01:43<04:52,  1.23s/it] 21%|██        | 63/300 [01:45<06:07,  1.55s/it] 21%|██▏       | 64/300 [01:46<05:27,  1.39s/it] 22%|██▏       | 65/300 [01:48<05:58,  1.52s/it] 22%|██▏       | 66/300 [01:50<06:59,  1.79s/it] 22%|██▏       | 67/300 [01:52<06:37,  1.71s/it] 23%|██▎       | 68/300 [01:54<07:39,  1.98s/it] 23%|██▎       | 69/300 [01:56<07:42,  2.00s/it] 23%|██▎       | 70/300 [01:59<08:21,  2.18s/it] 24%|██▎       | 71/300 [02:00<06:35,  1.73s/it] 24%|██▍       | 72/300 [02:01<06:17,  1.66s/it] 24%|██▍       | 73/300 [02:03<06:12,  1.64s/it] 25%|██▍       | 74/300 [02:04<05:48,  1.54s/it] 25%|██▌       | 75/300 [02:05<04:45,  1.27s/it] 25%|██▌       | 76/300 [02:05<04:06,  1.10s/it] 26%|██▌       | 77/300 [02:06<03:29,  1.06it/s] 26%|██▌       | 78/300 [02:07<03:10,  1.16it/s] 26%|██▋       | 79/300 [02:08<03:06,  1.18it/s] 27%|██▋       | 80/300 [02:08<03:03,  1.20it/s] 27%|██▋       | 81/300 [02:11<05:02,  1.38s/it] 27%|██▋       | 82/300 [02:13<05:28,  1.51s/it] 28%|██▊       | 83/300 [02:15<06:41,  1.85s/it] 28%|██▊       | 84/300 [02:16<05:18,  1.47s/it] 28%|██▊       | 85/300 [02:17<04:32,  1.27s/it] 29%|██▊       | 86/300 [02:19<05:57,  1.67s/it] 29%|██▉       | 87/300 [02:20<04:38,  1.31s/it] 29%|██▉       | 88/300 [02:21<04:02,  1.15s/it] 30%|██▉       | 89/300 [02:22<04:18,  1.23s/it] 30%|███       | 90/300 [02:25<05:43,  1.63s/it] 30%|███       | 91/300 [02:26<04:50,  1.39s/it] 31%|███       | 92/300 [02:27<04:50,  1.40s/it] 31%|███       | 93/300 [02:28<04:04,  1.18s/it] 31%|███▏      | 94/300 [02:30<05:32,  1.62s/it] 32%|███▏      | 95/300 [02:32<05:41,  1.66s/it] 32%|███▏      | 96/300 [02:35<06:34,  1.93s/it] 32%|███▏      | 97/300 [02:36<05:37,  1.66s/it] 33%|███▎      | 98/300 [02:36<04:27,  1.33s/it] 33%|███▎      | 99/300 [02:37<04:00,  1.20s/it] 33%|███▎      | 100/300 [02:40<05:23,  1.62s/it] 34%|███▎      | 101/300 [02:40<04:33,  1.38s/it] 34%|███▍      | 102/300 [02:41<04:08,  1.25s/it] 34%|███▍      | 103/300 [02:42<03:47,  1.15s/it] 35%|███▍      | 104/300 [02:43<03:25,  1.05s/it] 35%|███▌      | 105/300 [02:46<05:11,  1.60s/it] 35%|███▌      | 106/300 [02:47<04:45,  1.47s/it] 36%|███▌      | 107/300 [02:50<06:10,  1.92s/it] 36%|███▌      | 108/300 [02:52<06:29,  2.03s/it] 36%|███▋      | 109/300 [02:54<06:19,  1.99s/it] 37%|███▋      | 110/300 [02:57<06:50,  2.16s/it] 37%|███▋      | 111/300 [02:59<07:02,  2.23s/it] 37%|███▋      | 112/300 [03:02<07:44,  2.47s/it] 38%|███▊      | 113/300 [03:03<06:12,  1.99s/it] 38%|███▊      | 114/300 [03:04<05:18,  1.71s/it] 38%|███▊      | 115/300 [03:05<04:24,  1.43s/it] 39%|███▊      | 116/300 [03:07<04:49,  1.57s/it] 39%|███▉      | 117/300 [03:10<06:06,  2.00s/it] 39%|███▉      | 118/300 [03:12<06:03,  2.00s/it] 40%|███▉      | 119/300 [03:14<06:10,  2.05s/it] 40%|████      | 120/300 [03:15<05:32,  1.85s/it] 40%|████      | 121/300 [03:16<04:41,  1.57s/it] 41%|████      | 122/300 [03:19<05:23,  1.82s/it] 41%|████      | 123/300 [03:21<05:53,  2.00s/it] 41%|████▏     | 124/300 [03:24<06:37,  2.26s/it] 42%|████▏     | 125/300 [03:25<05:39,  1.94s/it] 42%|████▏     | 126/300 [03:27<05:17,  1.82s/it] 42%|████▏     | 127/300 [03:29<05:32,  1.92s/it] 43%|████▎     | 128/300 [03:31<05:28,  1.91s/it] 43%|████▎     | 129/300 [03:34<06:12,  2.18s/it] 43%|████▎     | 130/300 [03:37<06:48,  2.40s/it] 44%|████▎     | 131/300 [03:38<05:31,  1.96s/it] 44%|████▍     | 132/300 [03:40<06:13,  2.22s/it] 44%|████▍     | 133/300 [03:43<06:50,  2.46s/it] 45%|████▍     | 134/300 [03:47<07:45,  2.80s/it] 45%|████▌     | 135/300 [03:49<07:23,  2.69s/it] 45%|████▌     | 136/300 [03:51<06:23,  2.34s/it] 46%|████▌     | 137/300 [03:54<06:37,  2.44s/it] 46%|████▌     | 138/300 [03:56<06:49,  2.53s/it] 46%|████▋     | 139/300 [03:59<07:06,  2.65s/it] 47%|████▋     | 140/300 [04:04<08:24,  3.15s/it] 47%|████▋     | 141/300 [04:05<06:42,  2.53s/it] 47%|████▋     | 142/300 [04:07<06:21,  2.42s/it] 48%|████▊     | 143/300 [04:10<06:35,  2.52s/it] 48%|████▊     | 144/300 [04:13<06:54,  2.66s/it] 48%|████▊     | 145/300 [04:15<06:24,  2.48s/it] 49%|████▊     | 146/300 [04:18<06:45,  2.63s/it] 49%|████▉     | 147/300 [04:20<06:20,  2.49s/it] 49%|████▉     | 148/300 [04:21<05:13,  2.06s/it] 50%|████▉     | 149/300 [04:23<04:55,  1.96s/it] 50%|█████     | 150/300 [04:25<05:32,  2.22s/it] 50%|█████     | 151/300 [04:28<05:55,  2.39s/it] 51%|█████     | 152/300 [04:31<05:59,  2.43s/it] 51%|█████     | 153/300 [04:31<04:39,  1.90s/it] 51%|█████▏    | 154/300 [04:34<05:32,  2.28s/it] 52%|█████▏    | 155/300 [04:38<06:04,  2.52s/it] 52%|█████▏    | 156/300 [04:39<05:26,  2.27s/it] 52%|█████▏    | 157/300 [04:42<05:42,  2.39s/it] 53%|█████▎    | 158/300 [04:45<05:59,  2.53s/it] 53%|█████▎    | 159/300 [04:47<05:48,  2.47s/it] 53%|█████▎    | 160/300 [04:49<05:32,  2.38s/it] 54%|█████▎    | 161/300 [04:52<05:59,  2.58s/it] 54%|█████▍    | 162/300 [04:55<06:09,  2.68s/it] 54%|█████▍    | 163/300 [04:58<05:54,  2.59s/it] 55%|█████▍    | 164/300 [04:59<05:21,  2.36s/it] 55%|█████▌    | 165/300 [05:02<05:39,  2.51s/it] 55%|█████▌    | 166/300 [05:05<05:52,  2.63s/it] 56%|█████▌    | 167/300 [05:07<05:32,  2.50s/it] 56%|█████▌    | 168/300 [05:08<04:26,  2.02s/it] 56%|█████▋    | 169/300 [05:10<04:19,  1.98s/it] 57%|█████▋    | 170/300 [05:13<04:59,  2.31s/it] 57%|█████▋    | 171/300 [05:15<04:51,  2.26s/it] 57%|█████▋    | 172/300 [05:17<04:14,  1.99s/it] 58%|█████▊    | 173/300 [05:19<04:17,  2.03s/it] 58%|█████▊    | 174/300 [05:21<04:03,  1.93s/it] 58%|█████▊    | 175/300 [05:21<03:20,  1.60s/it] 59%|█████▊    | 176/300 [05:25<04:13,  2.05s/it] 59%|█████▉    | 177/300 [05:26<03:33,  1.74s/it] 59%|█████▉    | 178/300 [05:28<04:00,  1.97s/it] 60%|█████▉    | 179/300 [05:31<04:16,  2.12s/it] 60%|██████    | 180/300 [05:31<03:28,  1.74s/it] 60%|██████    | 181/300 [05:33<03:37,  1.83s/it] 61%|██████    | 182/300 [05:35<03:31,  1.79s/it] 61%|██████    | 183/300 [05:38<04:16,  2.19s/it] 61%|██████▏   | 184/300 [05:41<04:48,  2.49s/it] 62%|██████▏   | 185/300 [05:42<03:56,  2.05s/it] 62%|██████▏   | 186/300 [05:45<04:19,  2.28s/it] 62%|██████▏   | 187/300 [05:47<04:01,  2.13s/it] 63%|██████▎   | 188/300 [05:49<03:38,  1.95s/it] 63%|██████▎   | 189/300 [05:52<04:13,  2.29s/it] 63%|██████▎   | 190/300 [05:54<04:11,  2.29s/it] 64%|██████▎   | 191/300 [05:57<04:20,  2.39s/it] 64%|██████▍   | 192/300 [06:00<04:36,  2.56s/it] 64%|██████▍   | 193/300 [06:02<04:46,  2.68s/it] 65%|██████▍   | 194/300 [06:04<03:54,  2.21s/it] 65%|██████▌   | 195/300 [06:06<03:48,  2.18s/it] 65%|██████▌   | 196/300 [06:09<04:15,  2.45s/it] 66%|██████▌   | 197/300 [06:12<04:31,  2.63s/it] 66%|██████▌   | 198/300 [06:15<04:46,  2.81s/it] 66%|██████▋   | 199/300 [06:16<03:40,  2.19s/it] 67%|██████▋   | 200/300 [06:19<04:03,  2.43s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (17161 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [06:23<04:47,  2.90s/it] 67%|██████▋   | 202/300 [06:26<05:03,  3.10s/it] 68%|██████▊   | 203/300 [06:30<05:15,  3.25s/it] 68%|██████▊   | 204/300 [06:34<05:28,  3.42s/it] 68%|██████▊   | 205/300 [06:38<05:35,  3.53s/it] 69%|██████▊   | 206/300 [06:41<05:33,  3.54s/it] 69%|██████▉   | 207/300 [06:45<05:32,  3.58s/it] 69%|██████▉   | 208/300 [06:49<05:33,  3.63s/it] 70%|██████▉   | 209/300 [06:52<05:30,  3.63s/it] 70%|███████   | 210/300 [06:56<05:24,  3.61s/it] 70%|███████   | 211/300 [06:59<05:23,  3.64s/it] 71%|███████   | 212/300 [07:03<05:16,  3.60s/it] 71%|███████   | 213/300 [07:06<05:00,  3.45s/it] 71%|███████▏  | 214/300 [07:10<05:05,  3.55s/it] 72%|███████▏  | 215/300 [07:12<04:25,  3.12s/it] 72%|███████▏  | 216/300 [07:14<04:05,  2.92s/it] 72%|███████▏  | 217/300 [07:18<04:23,  3.17s/it] 73%|███████▎  | 218/300 [07:20<03:56,  2.89s/it] 73%|███████▎  | 219/300 [07:24<04:14,  3.15s/it] 73%|███████▎  | 220/300 [07:28<04:26,  3.34s/it] 74%|███████▎  | 221/300 [07:32<04:31,  3.44s/it] 74%|███████▍  | 222/300 [07:35<04:31,  3.48s/it] 74%|███████▍  | 223/300 [07:39<04:31,  3.52s/it] 75%|███████▍  | 224/300 [07:42<04:20,  3.43s/it] 75%|███████▌  | 225/300 [07:46<04:21,  3.49s/it] 75%|███████▌  | 226/300 [07:48<03:52,  3.15s/it] 76%|███████▌  | 227/300 [07:51<03:47,  3.11s/it] 76%|███████▌  | 228/300 [07:55<03:55,  3.28s/it] 76%|███████▋  | 229/300 [07:56<03:14,  2.73s/it] 77%|███████▋  | 230/300 [07:58<03:02,  2.61s/it] 77%|███████▋  | 231/300 [08:02<03:12,  2.79s/it] 77%|███████▋  | 232/300 [08:03<02:47,  2.47s/it] 78%|███████▊  | 233/300 [08:07<03:00,  2.69s/it] 78%|███████▊  | 234/300 [08:09<02:46,  2.52s/it] 78%|███████▊  | 235/300 [08:12<03:07,  2.89s/it] 79%|███████▊  | 236/300 [08:15<02:56,  2.75s/it] 79%|███████▉  | 237/300 [08:17<02:32,  2.42s/it] 79%|███████▉  | 238/300 [08:19<02:34,  2.49s/it] 80%|███████▉  | 239/300 [08:23<02:54,  2.87s/it] 80%|████████  | 240/300 [08:27<03:06,  3.11s/it] 80%|████████  | 241/300 [08:30<03:15,  3.31s/it] 81%|████████  | 242/300 [08:33<02:54,  3.01s/it] 81%|████████  | 243/300 [08:36<03:02,  3.20s/it] 81%|████████▏ | 244/300 [08:38<02:31,  2.71s/it] 82%|████████▏ | 245/300 [08:40<02:25,  2.64s/it] 82%|████████▏ | 246/300 [08:44<02:38,  2.94s/it] 82%|████████▏ | 247/300 [08:47<02:38,  2.99s/it] 83%|████████▎ | 248/300 [08:48<02:08,  2.47s/it] 83%|████████▎ | 249/300 [08:52<02:20,  2.75s/it] 83%|████████▎ | 250/300 [08:55<02:18,  2.77s/it] 84%|████████▎ | 251/300 [08:58<02:29,  3.05s/it] 84%|████████▍ | 252/300 [09:01<02:22,  2.97s/it] 84%|████████▍ | 253/300 [09:05<02:30,  3.21s/it] 85%|████████▍ | 254/300 [09:08<02:20,  3.06s/it] 85%|████████▌ | 255/300 [09:11<02:26,  3.26s/it] 85%|████████▌ | 256/300 [09:14<02:10,  2.96s/it] 86%|████████▌ | 257/300 [09:15<01:48,  2.51s/it] 86%|████████▌ | 258/300 [09:18<01:52,  2.67s/it] 86%|████████▋ | 259/300 [09:22<02:01,  2.96s/it] 87%|████████▋ | 260/300 [09:25<02:00,  3.01s/it] 87%|████████▋ | 261/300 [09:29<02:05,  3.21s/it] 87%|████████▋ | 262/300 [09:32<02:06,  3.32s/it] 88%|████████▊ | 263/300 [09:35<01:59,  3.23s/it] 88%|████████▊ | 264/300 [09:38<01:55,  3.21s/it] 88%|████████▊ | 265/300 [09:40<01:34,  2.70s/it] 89%|████████▊ | 266/300 [09:43<01:41,  2.98s/it] 89%|████████▉ | 267/300 [09:47<01:45,  3.20s/it] 89%|████████▉ | 268/300 [09:51<01:47,  3.37s/it] 90%|████████▉ | 269/300 [09:54<01:38,  3.17s/it] 90%|█████████ | 270/300 [09:56<01:30,  3.01s/it] 90%|█████████ | 271/300 [10:00<01:31,  3.15s/it] 91%|█████████ | 272/300 [10:03<01:33,  3.33s/it] 91%|█████████ | 273/300 [10:06<01:21,  3.04s/it] 91%|█████████▏| 274/300 [10:09<01:18,  3.03s/it] 92%|█████████▏| 275/300 [10:12<01:19,  3.17s/it] 92%|█████████▏| 276/300 [10:14<01:06,  2.77s/it] 92%|█████████▏| 277/300 [10:17<01:01,  2.67s/it] 93%|█████████▎| 278/300 [10:19<00:56,  2.58s/it] 93%|█████████▎| 279/300 [10:23<01:00,  2.89s/it] 93%|█████████▎| 280/300 [10:26<00:58,  2.93s/it] 94%|█████████▎| 281/300 [10:27<00:47,  2.51s/it] 94%|█████████▍| 282/300 [10:30<00:48,  2.68s/it] 94%|█████████▍| 283/300 [10:34<00:49,  2.90s/it] 95%|█████████▍| 284/300 [10:37<00:48,  3.03s/it] 95%|█████████▌| 285/300 [10:40<00:44,  2.98s/it] 95%|█████████▌| 286/300 [10:43<00:44,  3.16s/it] 96%|█████████▌| 287/300 [10:47<00:43,  3.33s/it] 96%|█████████▌| 288/300 [10:48<00:31,  2.66s/it] 96%|█████████▋| 289/300 [10:52<00:32,  2.95s/it] 97%|█████████▋| 290/300 [10:55<00:31,  3.14s/it] 97%|█████████▋| 291/300 [10:59<00:29,  3.27s/it] 97%|█████████▋| 292/300 [11:02<00:26,  3.29s/it] 98%|█████████▊| 293/300 [11:06<00:23,  3.33s/it] 98%|█████████▊| 294/300 [11:09<00:20,  3.40s/it] 98%|█████████▊| 295/300 [11:12<00:15,  3.12s/it] 99%|█████████▊| 296/300 [11:16<00:13,  3.32s/it] 99%|█████████▉| 297/300 [11:19<00:10,  3.45s/it] 99%|█████████▉| 298/300 [11:23<00:07,  3.55s/it]100%|█████████▉| 299/300 [11:25<00:02,  2.97s/it]100%|██████████| 300/300 [11:27<00:00,  2.87s/it]100%|██████████| 300/300 [11:27<00:00,  2.29s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.28s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.30s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.33s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.76s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.96s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:02<14:18,  2.87s/it]  1%|          | 2/300 [00:03<07:50,  1.58s/it]  1%|          | 3/300 [00:04<05:39,  1.14s/it]  1%|▏         | 4/300 [00:05<06:51,  1.39s/it]  2%|▏         | 5/300 [00:07<06:31,  1.33s/it]  2%|▏         | 6/300 [00:09<07:44,  1.58s/it]  2%|▏         | 7/300 [00:11<09:11,  1.88s/it]  3%|▎         | 8/300 [00:12<07:31,  1.54s/it]  3%|▎         | 9/300 [00:13<06:19,  1.30s/it]  3%|▎         | 10/300 [00:16<08:45,  1.81s/it]  4%|▎         | 11/300 [00:18<09:40,  2.01s/it]  4%|▍         | 12/300 [00:19<07:36,  1.59s/it]  4%|▍         | 13/300 [00:20<06:17,  1.32s/it]  5%|▍         | 14/300 [00:21<06:15,  1.31s/it]  5%|▌         | 15/300 [00:24<08:54,  1.87s/it]  5%|▌         | 16/300 [00:26<09:33,  2.02s/it]  6%|▌         | 17/300 [00:29<10:53,  2.31s/it]  6%|▌         | 18/300 [00:32<11:00,  2.34s/it]  6%|▋         | 19/300 [00:32<08:35,  1.83s/it]  7%|▋         | 20/300 [00:33<07:10,  1.54s/it]  7%|▋         | 21/300 [00:35<07:33,  1.62s/it]  7%|▋         | 22/300 [00:37<08:26,  1.82s/it]  8%|▊         | 23/300 [00:40<08:50,  1.92s/it]  8%|▊         | 24/300 [00:42<09:52,  2.14s/it]  8%|▊         | 25/300 [00:45<10:06,  2.20s/it]  9%|▊         | 26/300 [00:45<08:07,  1.78s/it]  9%|▉         | 27/300 [00:48<08:50,  1.94s/it]  9%|▉         | 28/300 [00:49<08:05,  1.78s/it] 10%|▉         | 29/300 [00:50<06:48,  1.51s/it] 10%|█         | 30/300 [00:53<08:36,  1.91s/it] 10%|█         | 31/300 [00:56<10:03,  2.24s/it] 11%|█         | 32/300 [00:58<09:49,  2.20s/it] 11%|█         | 33/300 [01:01<10:48,  2.43s/it] 11%|█▏        | 34/300 [01:04<11:30,  2.60s/it] 12%|█▏        | 35/300 [01:06<11:17,  2.56s/it] 12%|█▏        | 36/300 [01:09<10:50,  2.46s/it] 12%|█▏        | 37/300 [01:09<08:29,  1.94s/it] 13%|█▎        | 38/300 [01:10<07:08,  1.64s/it] 13%|█▎        | 39/300 [01:13<08:49,  2.03s/it] 13%|█▎        | 40/300 [01:15<08:48,  2.03s/it] 14%|█▎        | 41/300 [01:17<09:03,  2.10s/it] 14%|█▍        | 42/300 [01:18<07:20,  1.71s/it] 14%|█▍        | 43/300 [01:19<05:45,  1.34s/it] 15%|█▍        | 44/300 [01:19<04:38,  1.09s/it] 15%|█▌        | 45/300 [01:20<03:54,  1.09it/s] 15%|█▌        | 46/300 [01:22<06:07,  1.45s/it] 16%|█▌        | 47/300 [01:23<05:25,  1.29s/it] 16%|█▌        | 48/300 [01:26<07:26,  1.77s/it] 16%|█▋        | 49/300 [01:27<06:40,  1.60s/it] 17%|█▋        | 50/300 [01:30<08:20,  2.00s/it] 17%|█▋        | 51/300 [01:33<09:07,  2.20s/it] 17%|█▋        | 52/300 [01:36<09:30,  2.30s/it] 18%|█▊        | 53/300 [01:38<08:59,  2.19s/it] 18%|█▊        | 54/300 [01:38<07:00,  1.71s/it] 18%|█▊        | 55/300 [01:39<06:08,  1.51s/it] 19%|█▊        | 56/300 [01:40<05:20,  1.31s/it] 19%|█▉        | 57/300 [01:41<04:25,  1.09s/it] 19%|█▉        | 58/300 [01:41<03:45,  1.07it/s] 20%|█▉        | 59/300 [01:43<05:22,  1.34s/it] 20%|██        | 60/300 [01:45<05:24,  1.35s/it] 20%|██        | 61/300 [01:47<06:12,  1.56s/it] 21%|██        | 62/300 [01:48<05:20,  1.35s/it] 21%|██        | 63/300 [01:50<06:45,  1.71s/it] 21%|██▏       | 64/300 [01:51<06:00,  1.53s/it] 22%|██▏       | 65/300 [01:53<06:32,  1.67s/it] 22%|██▏       | 66/300 [01:54<05:31,  1.42s/it] 22%|██▏       | 67/300 [01:56<05:45,  1.48s/it] 23%|██▎       | 68/300 [01:59<07:27,  1.93s/it] 23%|██▎       | 69/300 [02:01<07:44,  2.01s/it] 23%|██▎       | 70/300 [02:02<06:28,  1.69s/it] 24%|██▎       | 71/300 [02:03<05:18,  1.39s/it] 24%|██▍       | 72/300 [02:04<05:35,  1.47s/it] 24%|██▍       | 73/300 [02:06<05:48,  1.54s/it] 25%|██▍       | 74/300 [02:07<05:40,  1.51s/it] 25%|██▌       | 75/300 [02:10<07:14,  1.93s/it] 25%|██▌       | 76/300 [02:11<05:53,  1.58s/it] 26%|██▌       | 77/300 [02:12<04:45,  1.28s/it] 26%|██▌       | 78/300 [02:12<04:05,  1.10s/it] 26%|██▋       | 79/300 [02:13<03:48,  1.03s/it] 27%|██▋       | 80/300 [02:14<03:36,  1.02it/s] 27%|██▋       | 81/300 [02:17<05:44,  1.57s/it] 27%|██▋       | 82/300 [02:19<06:25,  1.77s/it] 28%|██▊       | 83/300 [02:22<07:42,  2.13s/it] 28%|██▊       | 84/300 [02:23<06:08,  1.70s/it] 28%|██▊       | 85/300 [02:24<05:10,  1.45s/it] 29%|██▊       | 86/300 [02:27<06:42,  1.88s/it] 29%|██▉       | 87/300 [02:27<05:11,  1.46s/it] 29%|██▉       | 88/300 [02:28<04:29,  1.27s/it] 30%|██▉       | 89/300 [02:30<04:45,  1.35s/it] 30%|███       | 90/300 [02:33<06:25,  1.84s/it] 30%|███       | 91/300 [02:33<05:24,  1.55s/it] 31%|███       | 92/300 [02:35<05:23,  1.55s/it] 31%|███       | 93/300 [02:36<04:29,  1.30s/it] 31%|███▏      | 94/300 [02:39<06:08,  1.79s/it] 32%|███▏      | 95/300 [02:41<06:17,  1.84s/it] 32%|███▏      | 96/300 [02:43<07:17,  2.14s/it] 32%|███▏      | 97/300 [02:45<06:12,  1.84s/it] 33%|███▎      | 98/300 [02:45<04:53,  1.45s/it] 33%|███▎      | 99/300 [02:46<04:36,  1.38s/it] 33%|███▎      | 100/300 [02:47<04:14,  1.27s/it] 34%|███▎      | 101/300 [02:48<03:47,  1.14s/it] 34%|███▍      | 102/300 [02:49<03:42,  1.13s/it] 34%|███▍      | 103/300 [02:51<04:42,  1.44s/it] 35%|███▍      | 104/300 [02:52<04:11,  1.28s/it] 35%|███▌      | 105/300 [02:56<06:02,  1.86s/it] 35%|███▌      | 106/300 [02:57<05:30,  1.71s/it] 36%|███▌      | 107/300 [03:00<06:56,  2.16s/it] 36%|███▌      | 108/300 [03:03<07:16,  2.27s/it] 36%|███▋      | 109/300 [03:05<07:02,  2.21s/it] 37%|███▋      | 110/300 [03:06<06:02,  1.91s/it] 37%|███▋      | 111/300 [03:09<06:41,  2.12s/it] 37%|███▋      | 112/300 [03:12<07:58,  2.55s/it] 38%|███▊      | 113/300 [03:13<06:40,  2.14s/it] 38%|███▊      | 114/300 [03:14<05:43,  1.85s/it] 38%|███▊      | 115/300 [03:15<04:44,  1.54s/it] 39%|███▊      | 116/300 [03:16<03:59,  1.30s/it] 39%|███▉      | 117/300 [03:19<05:48,  1.90s/it] 39%|███▉      | 118/300 [03:22<06:03,  2.00s/it] 40%|███▉      | 119/300 [03:24<06:26,  2.14s/it] 40%|████      | 120/300 [03:25<05:51,  1.95s/it] 40%|████      | 121/300 [03:29<06:56,  2.32s/it] 41%|████      | 122/300 [03:32<07:52,  2.65s/it] 41%|████      | 123/300 [03:35<07:53,  2.67s/it] 41%|████▏     | 124/300 [03:37<07:15,  2.48s/it] 42%|████▏     | 125/300 [03:38<06:12,  2.13s/it] 42%|████▏     | 126/300 [03:40<05:48,  2.00s/it] 42%|████▏     | 127/300 [03:42<06:05,  2.11s/it] 43%|████▎     | 128/300 [03:46<07:14,  2.53s/it] 43%|████▎     | 129/300 [03:47<05:57,  2.09s/it] 43%|████▎     | 130/300 [03:50<06:50,  2.41s/it] 44%|████▎     | 131/300 [03:51<05:38,  2.00s/it] 44%|████▍     | 132/300 [03:54<06:34,  2.35s/it] 44%|████▍     | 133/300 [03:56<05:54,  2.12s/it] 45%|████▍     | 134/300 [03:59<06:55,  2.50s/it] 45%|████▌     | 135/300 [04:02<07:02,  2.56s/it] 45%|████▌     | 136/300 [04:04<06:17,  2.30s/it] 46%|████▌     | 137/300 [04:07<06:47,  2.50s/it] 46%|████▌     | 138/300 [04:10<07:12,  2.67s/it] 46%|████▋     | 139/300 [04:13<07:39,  2.85s/it] 47%|████▋     | 140/300 [04:18<09:06,  3.42s/it] 47%|████▋     | 141/300 [04:19<07:16,  2.75s/it] 47%|████▋     | 142/300 [04:21<06:57,  2.64s/it] 48%|████▊     | 143/300 [04:24<07:00,  2.68s/it] 48%|████▊     | 144/300 [04:27<07:28,  2.88s/it] 48%|████▊     | 145/300 [04:30<06:58,  2.70s/it] 49%|████▊     | 146/300 [04:33<07:27,  2.91s/it] 49%|████▉     | 147/300 [04:35<07:01,  2.76s/it] 49%|████▉     | 148/300 [04:37<05:46,  2.28s/it] 50%|████▉     | 149/300 [04:38<05:26,  2.16s/it] 50%|█████     | 150/300 [04:42<06:06,  2.45s/it] 50%|█████     | 151/300 [04:44<06:24,  2.58s/it] 51%|█████     | 152/300 [04:47<06:23,  2.59s/it] 51%|█████     | 153/300 [04:48<04:57,  2.02s/it] 51%|█████▏    | 154/300 [04:51<06:04,  2.50s/it] 52%|█████▏    | 155/300 [04:55<06:41,  2.77s/it] 52%|█████▏    | 156/300 [04:57<06:16,  2.61s/it] 52%|█████▏    | 157/300 [05:00<06:33,  2.75s/it] 53%|█████▎    | 158/300 [05:03<06:46,  2.86s/it] 53%|█████▎    | 159/300 [05:06<06:33,  2.79s/it] 53%|█████▎    | 160/300 [05:08<06:15,  2.68s/it] 54%|█████▎    | 161/300 [05:12<06:44,  2.91s/it] 54%|█████▍    | 162/300 [05:15<06:56,  3.02s/it] 54%|█████▍    | 163/300 [05:18<07:00,  3.07s/it] 55%|█████▍    | 164/300 [05:20<06:15,  2.76s/it] 55%|█████▌    | 165/300 [05:23<06:29,  2.89s/it] 55%|█████▌    | 166/300 [05:27<06:41,  3.00s/it] 56%|█████▌    | 167/300 [05:29<06:16,  2.83s/it] 56%|█████▌    | 168/300 [05:30<05:01,  2.29s/it] 56%|█████▋    | 169/300 [05:32<05:01,  2.30s/it] 57%|█████▋    | 170/300 [05:36<05:44,  2.65s/it] 57%|█████▋    | 171/300 [05:38<05:33,  2.59s/it] 57%|█████▋    | 172/300 [05:40<04:55,  2.31s/it] 58%|█████▊    | 173/300 [05:42<04:57,  2.35s/it] 58%|█████▊    | 174/300 [05:44<04:39,  2.22s/it] 58%|█████▊    | 175/300 [05:47<04:35,  2.20s/it] 59%|█████▊    | 176/300 [05:50<05:22,  2.60s/it] 59%|█████▉    | 177/300 [05:51<04:26,  2.17s/it] 59%|█████▉    | 178/300 [05:52<03:38,  1.79s/it] 60%|█████▉    | 179/300 [05:55<04:06,  2.04s/it] 60%|██████    | 180/300 [05:58<04:46,  2.39s/it] 60%|██████    | 181/300 [06:00<04:43,  2.38s/it] 61%|██████    | 182/300 [06:02<04:24,  2.24s/it] 61%|██████    | 183/300 [06:06<05:07,  2.63s/it] 61%|██████▏   | 184/300 [06:09<05:36,  2.90s/it] 62%|██████▏   | 185/300 [06:10<04:33,  2.38s/it] 62%|██████▏   | 186/300 [06:14<05:04,  2.67s/it] 62%|██████▏   | 187/300 [06:16<04:39,  2.47s/it] 63%|██████▎   | 188/300 [06:18<04:13,  2.26s/it] 63%|██████▎   | 189/300 [06:21<04:48,  2.60s/it] 63%|██████▎   | 190/300 [06:24<04:45,  2.60s/it] 64%|██████▎   | 191/300 [06:27<04:59,  2.75s/it] 64%|██████▍   | 192/300 [06:30<05:15,  2.92s/it] 64%|██████▍   | 193/300 [06:32<04:38,  2.61s/it] 65%|██████▍   | 194/300 [06:33<03:50,  2.17s/it] 65%|██████▌   | 195/300 [06:35<03:52,  2.22s/it] 65%|██████▌   | 196/300 [06:38<04:09,  2.40s/it] 66%|██████▌   | 197/300 [06:41<04:25,  2.58s/it] 66%|██████▌   | 198/300 [06:45<04:54,  2.89s/it] 66%|██████▋   | 199/300 [06:47<04:35,  2.73s/it] 67%|██████▋   | 200/300 [06:51<04:53,  2.94s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (17161 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [06:55<05:34,  3.38s/it] 67%|██████▋   | 202/300 [06:59<05:56,  3.63s/it] 68%|██████▊   | 203/300 [07:03<06:04,  3.76s/it] 68%|██████▊   | 204/300 [07:07<06:11,  3.87s/it] 68%|██████▊   | 205/300 [07:12<06:16,  3.97s/it] 69%|██████▊   | 206/300 [07:14<05:37,  3.59s/it] 69%|██████▉   | 207/300 [07:18<05:47,  3.73s/it] 69%|██████▉   | 208/300 [07:22<05:54,  3.85s/it] 70%|██████▉   | 209/300 [07:26<05:51,  3.86s/it] 70%|███████   | 210/300 [07:30<05:51,  3.90s/it] 70%|███████   | 211/300 [07:34<05:53,  3.97s/it] 71%|███████   | 212/300 [07:38<05:47,  3.95s/it] 71%|███████   | 213/300 [07:42<05:31,  3.82s/it] 71%|███████▏  | 214/300 [07:46<05:36,  3.91s/it] 72%|███████▏  | 215/300 [07:48<04:52,  3.44s/it] 72%|███████▏  | 216/300 [07:51<04:33,  3.25s/it] 72%|███████▏  | 217/300 [07:55<04:52,  3.53s/it] 73%|███████▎  | 218/300 [07:58<04:22,  3.21s/it] 73%|███████▎  | 219/300 [08:02<04:42,  3.48s/it] 73%|███████▎  | 220/300 [08:06<04:42,  3.53s/it] 74%|███████▎  | 221/300 [08:09<04:35,  3.49s/it] 74%|███████▍  | 222/300 [08:13<04:43,  3.63s/it] 74%|███████▍  | 223/300 [08:17<04:48,  3.75s/it] 75%|███████▍  | 224/300 [08:20<04:24,  3.48s/it] 75%|███████▌  | 225/300 [08:24<04:32,  3.64s/it] 75%|███████▌  | 226/300 [08:26<04:06,  3.34s/it] 76%|███████▌  | 227/300 [08:30<04:06,  3.38s/it] 76%|███████▌  | 228/300 [08:34<04:18,  3.59s/it] 76%|███████▋  | 229/300 [08:36<03:32,  2.99s/it] 77%|███████▋  | 230/300 [08:38<03:21,  2.87s/it] 77%|███████▋  | 231/300 [08:42<03:32,  3.09s/it] 77%|███████▋  | 232/300 [08:44<03:05,  2.73s/it] 78%|███████▊  | 233/300 [08:47<03:19,  2.98s/it] 78%|███████▊  | 234/300 [08:50<03:03,  2.78s/it] 78%|███████▊  | 235/300 [08:54<03:25,  3.16s/it] 79%|███████▊  | 236/300 [08:56<03:13,  3.03s/it] 79%|███████▉  | 237/300 [08:58<02:47,  2.65s/it] 79%|███████▉  | 238/300 [09:01<02:49,  2.74s/it] 80%|███████▉  | 239/300 [09:05<03:13,  3.18s/it] 80%|████████  | 240/300 [09:09<03:26,  3.45s/it] 80%|████████  | 241/300 [09:13<03:36,  3.67s/it] 81%|████████  | 242/300 [09:16<03:13,  3.34s/it] 81%|████████  | 243/300 [09:20<03:22,  3.55s/it] 81%|████████▏ | 244/300 [09:22<02:47,  3.00s/it] 82%|████████▏ | 245/300 [09:25<02:41,  2.93s/it] 82%|████████▏ | 246/300 [09:29<02:56,  3.26s/it] 82%|████████▏ | 247/300 [09:32<02:55,  3.32s/it] 83%|████████▎ | 248/300 [09:33<02:22,  2.74s/it] 83%|████████▎ | 249/300 [09:37<02:35,  3.06s/it] 83%|████████▎ | 250/300 [09:40<02:34,  3.08s/it] 84%|████████▎ | 251/300 [09:44<02:45,  3.39s/it] 84%|████████▍ | 252/300 [09:46<02:16,  2.83s/it] 84%|████████▍ | 253/300 [09:50<02:29,  3.19s/it] 85%|████████▍ | 254/300 [09:52<02:04,  2.70s/it] 85%|████████▌ | 255/300 [09:56<02:19,  3.09s/it] 85%|████████▌ | 256/300 [09:58<02:08,  2.91s/it] 86%|████████▌ | 257/300 [10:00<01:49,  2.54s/it] 86%|████████▌ | 258/300 [10:03<02:00,  2.87s/it] 86%|████████▋ | 259/300 [10:08<02:14,  3.27s/it] 87%|████████▋ | 260/300 [10:10<01:56,  2.90s/it] 87%|████████▋ | 261/300 [10:14<02:07,  3.26s/it] 87%|████████▋ | 262/300 [10:18<02:14,  3.53s/it] 88%|████████▊ | 263/300 [10:21<02:08,  3.49s/it] 88%|████████▊ | 264/300 [10:25<02:04,  3.47s/it] 88%|████████▊ | 265/300 [10:29<02:08,  3.66s/it] 89%|████████▊ | 266/300 [10:33<02:09,  3.81s/it] 89%|████████▉ | 267/300 [10:37<02:09,  3.91s/it] 89%|████████▉ | 268/300 [10:39<01:44,  3.26s/it] 90%|████████▉ | 269/300 [10:42<01:37,  3.14s/it] 90%|█████████ | 270/300 [10:45<01:32,  3.08s/it] 90%|█████████ | 271/300 [10:49<01:38,  3.40s/it] 91%|█████████ | 272/300 [10:53<01:41,  3.64s/it] 91%|█████████ | 273/300 [10:56<01:30,  3.34s/it] 91%|█████████▏| 274/300 [11:00<01:31,  3.52s/it] 92%|█████████▏| 275/300 [11:04<01:31,  3.64s/it] 92%|█████████▏| 276/300 [11:06<01:15,  3.16s/it] 92%|█████████▏| 277/300 [11:08<01:10,  3.06s/it] 93%|█████████▎| 278/300 [11:11<01:04,  2.94s/it] 93%|█████████▎| 279/300 [11:15<01:08,  3.25s/it] 93%|█████████▎| 280/300 [11:18<01:05,  3.28s/it] 94%|█████████▎| 281/300 [11:20<00:53,  2.80s/it] 94%|█████████▍| 282/300 [11:24<00:53,  2.99s/it] 94%|█████████▍| 283/300 [11:27<00:55,  3.24s/it] 95%|█████████▍| 284/300 [11:31<00:54,  3.38s/it] 95%|█████████▌| 285/300 [11:34<00:49,  3.33s/it] 95%|█████████▌| 286/300 [11:38<00:47,  3.36s/it] 96%|█████████▌| 287/300 [11:42<00:46,  3.61s/it] 96%|█████████▌| 288/300 [11:43<00:34,  2.90s/it] 96%|█████████▋| 289/300 [11:47<00:35,  3.23s/it] 97%|█████████▋| 290/300 [11:51<00:33,  3.31s/it] 97%|█████████▋| 291/300 [11:54<00:30,  3.42s/it] 97%|█████████▋| 292/300 [11:58<00:28,  3.52s/it] 98%|█████████▊| 293/300 [12:02<00:25,  3.61s/it] 98%|█████████▊| 294/300 [12:06<00:22,  3.70s/it] 98%|█████████▊| 295/300 [12:08<00:17,  3.41s/it] 99%|█████████▊| 296/300 [12:12<00:13,  3.30s/it] 99%|█████████▉| 297/300 [12:16<00:10,  3.56s/it] 99%|█████████▉| 298/300 [12:20<00:07,  3.75s/it]100%|█████████▉| 299/300 [12:22<00:03,  3.17s/it]100%|██████████| 300/300 [12:23<00:00,  2.69s/it]100%|██████████| 300/300 [12:23<00:00,  2.48s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.26s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.31s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.33s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.97s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:03<17:09,  3.44s/it]  1%|          | 2/300 [00:04<09:36,  1.93s/it]  1%|          | 3/300 [00:04<06:38,  1.34s/it]  1%|▏         | 4/300 [00:07<08:26,  1.71s/it]  2%|▏         | 5/300 [00:08<08:08,  1.65s/it]  2%|▏         | 6/300 [00:11<09:57,  2.03s/it]  2%|▏         | 7/300 [00:14<12:07,  2.48s/it]  3%|▎         | 8/300 [00:16<09:55,  2.04s/it]  3%|▎         | 9/300 [00:17<08:18,  1.71s/it]  3%|▎         | 10/300 [00:21<11:39,  2.41s/it]  4%|▎         | 11/300 [00:25<14:01,  2.91s/it]  4%|▍         | 12/300 [00:25<10:50,  2.26s/it]  4%|▍         | 13/300 [00:26<08:45,  1.83s/it]  5%|▍         | 14/300 [00:30<11:39,  2.45s/it]  5%|▌         | 15/300 [00:34<14:23,  3.03s/it]  5%|▌         | 16/300 [00:38<14:48,  3.13s/it]  6%|▌         | 17/300 [00:40<13:28,  2.86s/it]  6%|▌         | 18/300 [00:43<13:12,  2.81s/it]  6%|▋         | 19/300 [00:44<10:18,  2.20s/it]  7%|▋         | 20/300 [00:45<08:44,  1.87s/it]  7%|▋         | 21/300 [00:46<07:44,  1.66s/it]  7%|▋         | 22/300 [00:49<09:33,  2.06s/it]  8%|▊         | 23/300 [00:51<09:59,  2.16s/it]  8%|▊         | 24/300 [00:55<12:28,  2.71s/it]  8%|▊         | 25/300 [00:58<13:08,  2.87s/it]  9%|▊         | 26/300 [00:59<10:37,  2.32s/it]  9%|▉         | 27/300 [01:03<11:34,  2.55s/it]  9%|▉         | 28/300 [01:04<10:33,  2.33s/it] 10%|▉         | 29/300 [01:05<08:53,  1.97s/it] 10%|█         | 30/300 [01:08<09:34,  2.13s/it] 10%|█         | 31/300 [01:12<12:07,  2.70s/it] 11%|█         | 32/300 [01:15<12:04,  2.71s/it] 11%|█         | 33/300 [01:19<13:50,  3.11s/it] 11%|█▏        | 34/300 [01:23<14:49,  3.35s/it] 12%|█▏        | 35/300 [01:26<14:33,  3.30s/it] 12%|█▏        | 36/300 [01:29<14:10,  3.22s/it] 12%|█▏        | 37/300 [01:30<11:01,  2.51s/it] 13%|█▎        | 38/300 [01:31<09:12,  2.11s/it] 13%|█▎        | 39/300 [01:35<11:27,  2.63s/it] 13%|█▎        | 40/300 [01:39<12:59,  3.00s/it] 14%|█▎        | 41/300 [01:42<12:59,  3.01s/it] 14%|█▍        | 42/300 [01:43<10:22,  2.41s/it] 14%|█▍        | 43/300 [01:46<11:31,  2.69s/it] 15%|█▍        | 44/300 [01:47<08:45,  2.05s/it] 15%|█▌        | 45/300 [01:47<06:53,  1.62s/it] 15%|█▌        | 46/300 [01:51<09:19,  2.20s/it] 16%|█▌        | 47/300 [01:52<08:05,  1.92s/it] 16%|█▌        | 48/300 [01:56<10:31,  2.51s/it] 16%|█▋        | 49/300 [01:59<11:24,  2.73s/it] 17%|█▋        | 50/300 [02:03<13:01,  3.13s/it] 17%|█▋        | 51/300 [02:07<13:33,  3.27s/it] 17%|█▋        | 52/300 [02:08<10:30,  2.54s/it] 18%|█▊        | 53/300 [02:10<10:21,  2.52s/it] 18%|█▊        | 54/300 [02:11<08:13,  2.01s/it] 18%|█▊        | 55/300 [02:12<07:01,  1.72s/it] 19%|█▊        | 56/300 [02:13<06:13,  1.53s/it] 19%|█▉        | 57/300 [02:14<05:29,  1.35s/it] 19%|█▉        | 58/300 [02:15<04:35,  1.14s/it] 20%|█▉        | 59/300 [02:18<07:37,  1.90s/it] 20%|██        | 60/300 [02:20<07:27,  1.86s/it] 20%|██        | 61/300 [02:23<08:29,  2.13s/it] 21%|██        | 62/300 [02:24<07:13,  1.82s/it] 21%|██        | 63/300 [02:27<09:01,  2.28s/it] 21%|██▏       | 64/300 [02:29<07:56,  2.02s/it] 22%|██▏       | 65/300 [02:33<10:08,  2.59s/it] 22%|██▏       | 66/300 [02:34<08:23,  2.15s/it] 22%|██▏       | 67/300 [02:36<08:17,  2.14s/it] 23%|██▎       | 68/300 [02:40<10:19,  2.67s/it] 23%|██▎       | 69/300 [02:43<11:08,  2.90s/it] 23%|██▎       | 70/300 [02:47<12:08,  3.17s/it] 24%|██▎       | 71/300 [02:48<09:32,  2.50s/it] 24%|██▍       | 72/300 [02:50<09:02,  2.38s/it] 24%|██▍       | 73/300 [02:52<08:57,  2.37s/it] 25%|██▍       | 74/300 [02:54<08:21,  2.22s/it] 25%|██▌       | 75/300 [02:58<10:10,  2.71s/it] 25%|██▌       | 76/300 [02:59<08:14,  2.21s/it] 26%|██▌       | 77/300 [03:00<06:39,  1.79s/it] 26%|██▌       | 78/300 [03:01<05:34,  1.51s/it] 26%|██▋       | 79/300 [03:02<05:03,  1.37s/it] 27%|██▋       | 80/300 [03:03<04:51,  1.33s/it] 27%|██▋       | 81/300 [03:07<07:18,  2.00s/it] 27%|██▋       | 82/300 [03:10<08:09,  2.25s/it] 28%|██▊       | 83/300 [03:13<10:00,  2.77s/it] 28%|██▊       | 84/300 [03:14<07:57,  2.21s/it] 28%|██▊       | 85/300 [03:15<06:39,  1.86s/it] 29%|██▊       | 86/300 [03:19<08:42,  2.44s/it] 29%|██▉       | 87/300 [03:20<06:46,  1.91s/it] 29%|██▉       | 88/300 [03:21<05:51,  1.66s/it] 30%|██▉       | 89/300 [03:23<06:11,  1.76s/it] 30%|███       | 90/300 [03:24<05:13,  1.50s/it] 30%|███       | 91/300 [03:25<04:45,  1.37s/it] 31%|███       | 92/300 [03:27<05:20,  1.54s/it] 31%|███       | 93/300 [03:31<07:32,  2.18s/it] 31%|███▏      | 94/300 [03:34<09:16,  2.70s/it] 32%|███▏      | 95/300 [03:37<09:10,  2.68s/it] 32%|███▏      | 96/300 [03:39<08:08,  2.39s/it] 32%|███▏      | 97/300 [03:40<07:06,  2.10s/it] 33%|███▎      | 98/300 [03:41<05:36,  1.67s/it] 33%|███▎      | 99/300 [03:42<05:25,  1.62s/it] 33%|███▎      | 100/300 [03:44<05:07,  1.54s/it] 34%|███▎      | 101/300 [03:45<04:40,  1.41s/it] 34%|███▍      | 102/300 [03:46<04:42,  1.43s/it] 34%|███▍      | 103/300 [03:49<06:13,  1.90s/it] 35%|███▍      | 104/300 [03:51<05:38,  1.73s/it] 35%|███▌      | 105/300 [03:55<08:12,  2.52s/it] 35%|███▌      | 106/300 [03:57<07:29,  2.32s/it] 36%|███▌      | 107/300 [04:01<09:27,  2.94s/it] 36%|███▌      | 108/300 [04:05<09:52,  3.09s/it] 36%|███▋      | 109/300 [04:07<09:32,  3.00s/it] 37%|███▋      | 110/300 [04:12<10:32,  3.33s/it] 37%|███▋      | 111/300 [04:16<11:14,  3.57s/it] 37%|███▋      | 112/300 [04:20<11:56,  3.81s/it] 38%|███▊      | 113/300 [04:21<09:33,  3.07s/it] 38%|███▊      | 114/300 [04:23<08:07,  2.62s/it] 38%|███▊      | 115/300 [04:24<06:38,  2.16s/it] 39%|███▊      | 116/300 [04:25<05:34,  1.82s/it] 39%|███▉      | 117/300 [04:28<06:48,  2.23s/it] 39%|███▉      | 118/300 [04:33<09:00,  2.97s/it] 40%|███▉      | 119/300 [04:36<09:17,  3.08s/it] 40%|████      | 120/300 [04:38<08:23,  2.80s/it] 40%|████      | 121/300 [04:43<09:50,  3.30s/it] 41%|████      | 122/300 [04:48<10:58,  3.70s/it] 41%|████      | 123/300 [04:51<10:53,  3.69s/it] 41%|████▏     | 124/300 [04:54<10:01,  3.42s/it] 42%|████▏     | 125/300 [04:58<10:28,  3.59s/it] 42%|████▏     | 126/300 [05:00<09:22,  3.23s/it] 42%|████▏     | 127/300 [05:04<09:43,  3.38s/it] 43%|████▎     | 128/300 [05:07<09:14,  3.22s/it] 43%|████▎     | 129/300 [05:09<07:52,  2.76s/it] 43%|████▎     | 130/300 [05:13<09:08,  3.22s/it] 44%|████▎     | 131/300 [05:14<07:34,  2.69s/it] 44%|████▍     | 132/300 [05:19<08:51,  3.17s/it] 44%|████▍     | 133/300 [05:23<10:02,  3.61s/it] 45%|████▍     | 134/300 [05:28<10:50,  3.92s/it] 45%|████▌     | 135/300 [05:30<08:52,  3.23s/it] 45%|████▌     | 136/300 [05:32<07:58,  2.91s/it] 46%|████▌     | 137/300 [05:36<08:53,  3.27s/it] 46%|████▌     | 138/300 [05:40<09:31,  3.53s/it] 46%|████▋     | 139/300 [05:43<09:04,  3.38s/it] 47%|████▋     | 140/300 [05:49<11:09,  4.19s/it] 47%|████▋     | 141/300 [05:51<09:02,  3.41s/it] 47%|████▋     | 142/300 [05:54<08:51,  3.37s/it] 48%|████▊     | 143/300 [05:58<09:06,  3.48s/it] 48%|████▊     | 144/300 [06:02<09:53,  3.80s/it] 48%|████▊     | 145/300 [06:05<09:13,  3.57s/it] 49%|████▊     | 146/300 [06:10<09:54,  3.86s/it] 49%|████▉     | 147/300 [06:13<09:24,  3.69s/it] 49%|████▉     | 148/300 [06:15<07:45,  3.07s/it] 50%|████▉     | 149/300 [06:19<08:45,  3.48s/it] 50%|█████     | 150/300 [06:22<08:14,  3.29s/it] 50%|█████     | 151/300 [06:26<08:38,  3.48s/it] 51%|█████     | 152/300 [06:30<08:50,  3.58s/it] 51%|█████     | 153/300 [06:31<06:52,  2.80s/it] 51%|█████▏    | 154/300 [06:36<08:16,  3.40s/it] 52%|█████▏    | 155/300 [06:40<09:07,  3.78s/it] 52%|█████▏    | 156/300 [06:43<08:24,  3.50s/it] 52%|█████▏    | 157/300 [06:47<08:49,  3.70s/it] 53%|█████▎    | 158/300 [06:52<09:12,  3.89s/it] 53%|█████▎    | 159/300 [06:55<08:40,  3.69s/it] 53%|█████▎    | 160/300 [06:58<08:20,  3.57s/it] 54%|█████▎    | 161/300 [07:03<09:09,  3.95s/it] 54%|█████▍    | 162/300 [07:07<09:27,  4.11s/it] 54%|█████▍    | 163/300 [07:09<07:44,  3.39s/it] 55%|█████▍    | 164/300 [07:12<07:10,  3.16s/it] 55%|█████▌    | 165/300 [07:16<08:00,  3.56s/it] 55%|█████▌    | 166/300 [07:21<08:33,  3.84s/it] 56%|█████▌    | 167/300 [07:24<08:10,  3.69s/it] 56%|█████▌    | 168/300 [07:26<06:36,  3.01s/it] 56%|█████▋    | 169/300 [07:29<06:47,  3.11s/it] 57%|█████▋    | 170/300 [07:34<07:47,  3.60s/it] 57%|█████▋    | 171/300 [07:37<07:35,  3.53s/it] 57%|█████▋    | 172/300 [07:39<06:47,  3.19s/it] 58%|█████▊    | 173/300 [07:43<06:51,  3.24s/it] 58%|█████▊    | 174/300 [07:45<06:25,  3.06s/it] 58%|█████▊    | 175/300 [07:48<06:21,  3.06s/it] 59%|█████▊    | 176/300 [07:53<07:22,  3.57s/it] 59%|█████▉    | 177/300 [07:55<06:04,  2.97s/it] 59%|█████▉    | 178/300 [07:59<06:32,  3.22s/it] 60%|█████▉    | 179/300 [08:02<06:28,  3.21s/it] 60%|██████    | 180/300 [08:03<05:21,  2.68s/it] 60%|██████    | 181/300 [08:06<05:33,  2.80s/it] 61%|██████    | 182/300 [08:10<06:16,  3.19s/it] 61%|██████    | 183/300 [08:15<07:10,  3.68s/it] 61%|██████▏   | 184/300 [08:18<06:52,  3.55s/it] 62%|██████▏   | 185/300 [08:20<05:42,  2.98s/it] 62%|██████▏   | 186/300 [08:25<06:33,  3.45s/it] 62%|██████▏   | 187/300 [08:28<06:22,  3.39s/it] 63%|██████▎   | 188/300 [08:30<05:48,  3.11s/it] 63%|██████▎   | 189/300 [08:35<06:39,  3.60s/it] 63%|██████▎   | 190/300 [08:40<07:09,  3.91s/it] 64%|██████▎   | 191/300 [08:44<07:15,  3.99s/it] 64%|██████▍   | 192/300 [08:45<05:52,  3.26s/it] 64%|██████▍   | 193/300 [08:49<06:10,  3.46s/it] 65%|██████▍   | 194/300 [08:51<05:12,  2.95s/it] 65%|██████▌   | 195/300 [08:54<05:15,  3.00s/it] 65%|██████▌   | 196/300 [08:58<05:37,  3.24s/it] 66%|██████▌   | 197/300 [09:02<06:07,  3.56s/it] 66%|██████▌   | 198/300 [09:04<05:07,  3.01s/it] 66%|██████▋   | 199/300 [09:05<04:12,  2.50s/it] 67%|██████▋   | 200/300 [09:10<05:10,  3.10s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (17161 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [09:15<06:17,  3.81s/it] 67%|██████▋   | 202/300 [09:21<07:06,  4.35s/it] 68%|██████▊   | 203/300 [09:26<07:10,  4.44s/it] 68%|██████▊   | 204/300 [09:31<07:37,  4.77s/it] 68%|██████▊   | 205/300 [09:37<07:55,  5.01s/it] 69%|██████▊   | 206/300 [09:41<07:36,  4.85s/it] 69%|██████▉   | 207/300 [09:44<06:38,  4.29s/it] 69%|██████▉   | 208/300 [09:50<07:09,  4.66s/it] 70%|██████▉   | 209/300 [09:55<07:17,  4.81s/it] 70%|███████   | 210/300 [10:00<07:26,  4.96s/it] 70%|███████   | 211/300 [10:06<07:34,  5.11s/it] 71%|███████   | 212/300 [10:11<07:31,  5.13s/it] 71%|███████   | 213/300 [10:15<06:49,  4.71s/it] 71%|███████▏  | 214/300 [10:20<07:05,  4.95s/it] 72%|███████▏  | 215/300 [10:23<06:13,  4.40s/it] 72%|███████▏  | 216/300 [10:27<05:53,  4.21s/it] 72%|███████▏  | 217/300 [10:32<06:22,  4.61s/it] 73%|███████▎  | 218/300 [10:36<05:52,  4.30s/it] 73%|███████▎  | 219/300 [10:42<06:18,  4.68s/it] 73%|███████▎  | 220/300 [10:47<06:24,  4.80s/it] 74%|███████▎  | 221/300 [10:52<06:34,  5.00s/it] 74%|███████▍  | 222/300 [10:58<06:37,  5.10s/it] 74%|███████▍  | 223/300 [11:03<06:38,  5.17s/it] 75%|███████▍  | 224/300 [11:07<06:01,  4.76s/it] 75%|███████▌  | 225/300 [11:12<06:10,  4.94s/it] 75%|███████▌  | 226/300 [11:16<05:34,  4.52s/it] 76%|███████▌  | 227/300 [11:18<04:41,  3.85s/it] 76%|███████▌  | 228/300 [11:23<05:09,  4.30s/it] 76%|███████▋  | 229/300 [11:25<04:20,  3.67s/it] 77%|███████▋  | 230/300 [11:31<04:51,  4.16s/it] 77%|███████▋  | 231/300 [11:35<04:56,  4.30s/it] 77%|███████▋  | 232/300 [11:38<04:16,  3.77s/it] 78%|███████▊  | 233/300 [11:43<04:48,  4.31s/it] 78%|███████▊  | 234/300 [11:47<04:21,  3.96s/it] 78%|███████▊  | 235/300 [11:52<04:43,  4.36s/it] 79%|███████▊  | 236/300 [11:55<04:25,  4.15s/it] 79%|███████▉  | 237/300 [11:58<03:48,  3.63s/it] 79%|███████▉  | 238/300 [12:01<03:39,  3.53s/it] 80%|███████▉  | 239/300 [12:07<04:14,  4.17s/it] 80%|████████  | 240/300 [12:12<04:32,  4.55s/it] 80%|████████  | 241/300 [12:17<04:37,  4.70s/it] 81%|████████  | 242/300 [12:21<04:10,  4.32s/it] 81%|████████  | 243/300 [12:26<04:24,  4.64s/it] 81%|████████▏ | 244/300 [12:28<03:40,  3.94s/it] 82%|████████▏ | 245/300 [12:31<03:07,  3.41s/it] 82%|████████▏ | 246/300 [12:36<03:35,  3.99s/it] 82%|████████▏ | 247/300 [12:41<03:48,  4.31s/it] 83%|████████▎ | 248/300 [12:43<03:06,  3.59s/it] 83%|████████▎ | 249/300 [12:48<03:27,  4.06s/it] 83%|████████▎ | 250/300 [12:54<03:44,  4.50s/it] 84%|████████▎ | 251/300 [12:59<03:54,  4.80s/it] 84%|████████▍ | 252/300 [13:01<03:11,  3.99s/it] 84%|████████▍ | 253/300 [13:05<03:10,  4.06s/it] 85%|████████▍ | 254/300 [13:09<03:04,  4.01s/it] 85%|████████▌ | 255/300 [13:15<03:20,  4.46s/it] 85%|████████▌ | 256/300 [13:18<03:01,  4.12s/it] 86%|████████▌ | 257/300 [13:23<03:00,  4.19s/it] 86%|████████▌ | 258/300 [13:27<02:54,  4.15s/it] 86%|████████▋ | 259/300 [13:32<03:07,  4.57s/it] 87%|████████▋ | 260/300 [13:36<02:51,  4.30s/it] 87%|████████▋ | 261/300 [13:41<03:00,  4.63s/it] 87%|████████▋ | 262/300 [13:47<03:05,  4.89s/it] 88%|████████▊ | 263/300 [13:52<03:07,  5.08s/it] 88%|████████▊ | 264/300 [13:57<03:03,  5.11s/it] 88%|████████▊ | 265/300 [14:03<03:02,  5.22s/it] 89%|████████▊ | 266/300 [14:08<02:53,  5.10s/it] 89%|████████▉ | 267/300 [14:12<02:35,  4.70s/it] 89%|████████▉ | 268/300 [14:15<02:21,  4.43s/it] 90%|████████▉ | 269/300 [14:19<02:13,  4.32s/it] 90%|█████████ | 270/300 [14:23<02:05,  4.20s/it] 90%|█████████ | 271/300 [14:29<02:12,  4.58s/it] 91%|█████████ | 272/300 [14:34<02:16,  4.88s/it] 91%|█████████ | 273/300 [14:38<02:01,  4.48s/it] 91%|█████████▏| 274/300 [14:42<01:55,  4.45s/it] 92%|█████████▏| 275/300 [14:47<01:56,  4.68s/it] 92%|█████████▏| 276/300 [14:50<01:38,  4.10s/it] 92%|█████████▏| 277/300 [14:52<01:20,  3.51s/it] 93%|█████████▎| 278/300 [14:54<01:05,  2.98s/it] 93%|█████████▎| 279/300 [14:59<01:16,  3.63s/it] 93%|█████████▎| 280/300 [15:04<01:19,  3.96s/it] 94%|█████████▎| 281/300 [15:07<01:08,  3.61s/it] 94%|█████████▍| 282/300 [15:12<01:11,  3.97s/it] 94%|█████████▍| 283/300 [15:17<01:13,  4.32s/it] 95%|█████████▍| 284/300 [15:22<01:12,  4.53s/it] 95%|█████████▌| 285/300 [15:26<01:06,  4.45s/it] 95%|█████████▌| 286/300 [15:31<01:06,  4.72s/it] 96%|█████████▌| 287/300 [15:37<01:04,  4.97s/it] 96%|█████████▌| 288/300 [15:39<00:47,  3.99s/it] 96%|█████████▋| 289/300 [15:44<00:48,  4.41s/it] 97%|█████████▋| 290/300 [15:49<00:44,  4.49s/it] 97%|█████████▋| 291/300 [15:54<00:42,  4.76s/it] 97%|█████████▋| 292/300 [15:56<00:32,  4.01s/it] 98%|█████████▊| 293/300 [16:01<00:30,  4.33s/it] 98%|█████████▊| 294/300 [16:07<00:27,  4.62s/it] 98%|█████████▊| 295/300 [16:10<00:21,  4.33s/it] 99%|█████████▊| 296/300 [16:14<00:16,  4.13s/it] 99%|█████████▉| 297/300 [16:20<00:13,  4.56s/it] 99%|█████████▉| 298/300 [16:25<00:09,  4.86s/it]100%|█████████▉| 299/300 [16:28<00:04,  4.15s/it]100%|██████████| 300/300 [16:32<00:00,  4.17s/it]100%|██████████| 300/300 [16:32<00:00,  3.31s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.27s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.33s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.35s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.78s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.98s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:05<25:26,  5.11s/it]  1%|          | 2/300 [00:06<14:41,  2.96s/it]  1%|          | 3/300 [00:07<10:10,  2.06s/it]  1%|▏         | 4/300 [00:10<12:27,  2.52s/it]  2%|▏         | 5/300 [00:11<09:54,  2.01s/it]  2%|▏         | 6/300 [00:16<13:22,  2.73s/it]  2%|▏         | 7/300 [00:22<18:45,  3.84s/it]  3%|▎         | 8/300 [00:28<21:53,  4.50s/it]  3%|▎         | 9/300 [00:29<17:31,  3.61s/it]  3%|▎         | 10/300 [00:35<21:02,  4.36s/it]  4%|▎         | 11/300 [00:41<23:36,  4.90s/it]  4%|▍         | 12/300 [00:43<18:05,  3.77s/it]  4%|▍         | 13/300 [00:44<14:15,  2.98s/it]  5%|▍         | 14/300 [00:46<13:49,  2.90s/it]  5%|▌         | 15/300 [00:51<15:35,  3.28s/it]  5%|▌         | 16/300 [00:56<18:47,  3.97s/it]  6%|▌         | 17/300 [01:02<21:44,  4.61s/it]  6%|▌         | 18/300 [01:04<17:21,  3.69s/it]  6%|▋         | 19/300 [01:05<14:02,  3.00s/it]  7%|▋         | 20/300 [01:07<12:06,  2.59s/it]  7%|▋         | 21/300 [01:13<16:54,  3.64s/it]  7%|▋         | 22/300 [01:18<18:26,  3.98s/it]  8%|▊         | 23/300 [01:21<17:56,  3.88s/it]  8%|▊         | 24/300 [01:28<21:00,  4.57s/it]  8%|▊         | 25/300 [01:32<21:28,  4.68s/it]  9%|▊         | 26/300 [01:34<17:14,  3.78s/it]  9%|▉         | 27/300 [01:40<20:11,  4.44s/it]  9%|▉         | 28/300 [01:43<17:55,  3.95s/it] 10%|▉         | 29/300 [01:45<15:01,  3.33s/it] 10%|█         | 30/300 [01:49<15:36,  3.47s/it] 10%|█         | 31/300 [01:55<19:15,  4.29s/it] 11%|█         | 32/300 [01:59<18:53,  4.23s/it] 11%|█         | 33/300 [02:05<21:21,  4.80s/it] 11%|█▏        | 34/300 [02:11<22:59,  5.19s/it] 12%|█▏        | 35/300 [02:16<22:32,  5.10s/it] 12%|█▏        | 36/300 [02:21<21:47,  4.95s/it] 12%|█▏        | 37/300 [02:22<16:52,  3.85s/it] 13%|█▎        | 38/300 [02:24<14:05,  3.23s/it] 13%|█▎        | 39/300 [02:29<16:18,  3.75s/it] 13%|█▎        | 40/300 [02:34<17:59,  4.15s/it] 14%|█▎        | 41/300 [02:38<18:09,  4.21s/it] 14%|█▍        | 42/300 [02:40<14:42,  3.42s/it] 14%|█▍        | 43/300 [02:45<17:23,  4.06s/it] 15%|█▍        | 44/300 [02:46<13:15,  3.11s/it] 15%|█▌        | 45/300 [02:47<10:20,  2.43s/it] 15%|█▌        | 46/300 [02:52<14:11,  3.35s/it] 16%|█▌        | 47/300 [02:54<12:19,  2.92s/it] 16%|█▌        | 48/300 [03:00<16:05,  3.83s/it] 16%|█▋        | 49/300 [03:05<17:28,  4.18s/it] 17%|█▋        | 50/300 [03:11<19:53,  4.78s/it] 17%|█▋        | 51/300 [03:17<20:43,  4.99s/it] 17%|█▋        | 52/300 [03:23<21:36,  5.23s/it] 18%|█▊        | 53/300 [03:29<22:25,  5.45s/it] 18%|█▊        | 54/300 [03:30<17:03,  4.16s/it] 18%|█▊        | 55/300 [03:32<14:22,  3.52s/it] 19%|█▊        | 56/300 [03:34<12:07,  2.98s/it] 19%|█▉        | 57/300 [03:35<10:11,  2.52s/it] 19%|█▉        | 58/300 [03:36<08:09,  2.02s/it] 20%|█▉        | 59/300 [03:40<11:07,  2.77s/it] 20%|██        | 60/300 [03:43<10:51,  2.71s/it] 20%|██        | 61/300 [03:49<14:53,  3.74s/it] 21%|██        | 62/300 [03:51<12:25,  3.13s/it] 21%|██        | 63/300 [03:56<14:43,  3.73s/it] 21%|██▏       | 64/300 [04:01<15:43,  4.00s/it] 22%|██▏       | 65/300 [04:07<18:05,  4.62s/it] 22%|██▏       | 66/300 [04:10<16:41,  4.28s/it] 22%|██▏       | 67/300 [04:14<15:38,  4.03s/it] 23%|██▎       | 68/300 [04:20<17:51,  4.62s/it] 23%|██▎       | 69/300 [04:23<16:21,  4.25s/it] 23%|██▎       | 70/300 [04:29<18:06,  4.72s/it] 24%|██▎       | 71/300 [04:30<14:27,  3.79s/it] 24%|██▍       | 72/300 [04:32<11:25,  3.01s/it] 24%|██▍       | 73/300 [04:35<11:43,  3.10s/it] 25%|██▍       | 74/300 [04:38<11:25,  3.03s/it] 25%|██▌       | 75/300 [04:44<14:40,  3.91s/it] 25%|██▌       | 76/300 [04:45<11:58,  3.21s/it] 26%|██▌       | 77/300 [04:47<09:44,  2.62s/it] 26%|██▌       | 78/300 [04:48<08:14,  2.23s/it] 26%|██▋       | 79/300 [04:49<07:29,  2.03s/it] 27%|██▋       | 80/300 [04:51<07:15,  1.98s/it] 27%|██▋       | 81/300 [04:57<11:38,  3.19s/it] 27%|██▋       | 82/300 [05:01<12:34,  3.46s/it] 28%|██▊       | 83/300 [05:08<15:24,  4.26s/it] 28%|██▊       | 84/300 [05:13<16:34,  4.60s/it] 28%|██▊       | 85/300 [05:15<13:20,  3.72s/it] 29%|██▊       | 86/300 [05:20<15:20,  4.30s/it] 29%|██▉       | 87/300 [05:21<11:44,  3.31s/it] 29%|██▉       | 88/300 [05:24<10:53,  3.08s/it] 30%|██▉       | 89/300 [05:27<11:00,  3.13s/it] 30%|███       | 90/300 [05:28<09:03,  2.59s/it] 30%|███       | 91/300 [05:30<07:57,  2.29s/it] 31%|███       | 92/300 [05:33<08:40,  2.50s/it] 31%|███       | 93/300 [05:39<11:51,  3.44s/it] 31%|███▏      | 94/300 [05:45<14:25,  4.20s/it] 32%|███▏      | 95/300 [05:49<14:09,  4.15s/it] 32%|███▏      | 96/300 [05:54<15:49,  4.66s/it] 32%|███▏      | 97/300 [05:57<13:21,  3.95s/it] 33%|███▎      | 98/300 [05:58<10:31,  3.13s/it] 33%|███▎      | 99/300 [06:00<09:36,  2.87s/it] 33%|███▎      | 100/300 [06:02<08:49,  2.65s/it] 34%|███▎      | 101/300 [06:05<09:06,  2.75s/it] 34%|███▍      | 102/300 [06:08<08:53,  2.69s/it] 34%|███▍      | 103/300 [06:13<11:12,  3.41s/it] 35%|███▍      | 104/300 [06:15<09:44,  2.98s/it] 35%|███▌      | 105/300 [06:22<13:22,  4.11s/it] 35%|███▌      | 106/300 [06:25<12:02,  3.73s/it] 36%|███▌      | 107/300 [06:31<14:53,  4.63s/it] 36%|███▌      | 108/300 [06:34<12:31,  3.92s/it] 36%|███▋      | 109/300 [06:38<12:43,  4.00s/it] 37%|███▋      | 110/300 [06:41<11:30,  3.63s/it] 37%|███▋      | 111/300 [06:47<13:58,  4.43s/it] 37%|███▋      | 112/300 [06:54<16:16,  5.19s/it] 38%|███▊      | 113/300 [06:56<13:37,  4.37s/it] 38%|███▊      | 114/300 [07:03<15:39,  5.05s/it] 38%|███▊      | 115/300 [07:05<12:33,  4.07s/it] 39%|███▊      | 116/300 [07:09<12:42,  4.14s/it] 39%|███▉      | 117/300 [07:16<15:19,  5.02s/it] 39%|███▉      | 118/300 [07:23<17:01,  5.61s/it] 40%|███▉      | 119/300 [07:28<16:29,  5.47s/it] 40%|████      | 120/300 [07:31<14:23,  4.80s/it] 40%|████      | 121/300 [07:34<12:08,  4.07s/it] 41%|████      | 122/300 [07:41<14:43,  4.96s/it] 41%|████      | 123/300 [07:46<15:08,  5.13s/it] 41%|████▏     | 124/300 [07:51<14:49,  5.06s/it] 42%|████▏     | 125/300 [07:54<12:48,  4.39s/it] 42%|████▏     | 126/300 [07:58<11:58,  4.13s/it] 42%|████▏     | 127/300 [08:03<12:47,  4.44s/it] 43%|████▎     | 128/300 [08:07<12:40,  4.42s/it] 43%|████▎     | 129/300 [08:10<11:02,  3.87s/it] 43%|████▎     | 130/300 [08:17<13:33,  4.79s/it] 44%|████▎     | 131/300 [08:19<11:15,  4.00s/it] 44%|████▍     | 132/300 [08:26<13:28,  4.81s/it] 44%|████▍     | 133/300 [08:29<12:09,  4.37s/it] 45%|████▍     | 134/300 [08:34<12:35,  4.55s/it] 45%|████▌     | 135/300 [08:36<10:45,  3.91s/it] 45%|████▌     | 136/300 [08:40<10:22,  3.80s/it] 46%|████▌     | 137/300 [08:46<12:16,  4.52s/it] 46%|████▌     | 138/300 [08:52<13:37,  5.05s/it] 46%|████▋     | 139/300 [08:59<14:59,  5.59s/it] 47%|████▋     | 140/300 [09:08<17:22,  6.51s/it] 47%|████▋     | 141/300 [09:10<14:01,  5.29s/it] 47%|████▋     | 142/300 [09:15<13:44,  5.22s/it] 48%|████▊     | 143/300 [09:21<14:04,  5.38s/it] 48%|████▊     | 144/300 [09:24<11:45,  4.52s/it] 48%|████▊     | 145/300 [09:29<12:08,  4.70s/it] 49%|████▊     | 146/300 [09:34<12:51,  5.01s/it] 49%|████▉     | 147/300 [09:39<12:47,  5.01s/it] 49%|████▉     | 148/300 [09:42<11:00,  4.34s/it] 50%|████▉     | 149/300 [09:49<12:56,  5.14s/it] 50%|█████     | 150/300 [09:53<11:46,  4.71s/it] 50%|█████     | 151/300 [09:59<13:03,  5.26s/it] 51%|█████     | 152/300 [10:05<13:26,  5.45s/it] 51%|█████     | 153/300 [10:07<10:26,  4.26s/it] 51%|█████▏    | 154/300 [10:14<12:37,  5.19s/it] 52%|█████▏    | 155/300 [10:21<13:56,  5.77s/it] 52%|█████▏    | 156/300 [10:25<12:30,  5.21s/it] 52%|█████▏    | 157/300 [10:32<13:17,  5.58s/it] 53%|█████▎    | 158/300 [10:37<12:54,  5.45s/it] 53%|█████▎    | 159/300 [10:41<12:07,  5.16s/it] 53%|█████▎    | 160/300 [10:46<11:56,  5.12s/it] 54%|█████▎    | 161/300 [10:53<13:14,  5.72s/it] 54%|█████▍    | 162/300 [11:00<13:56,  6.06s/it] 54%|█████▍    | 163/300 [11:03<11:27,  5.02s/it] 55%|█████▍    | 164/300 [11:07<10:48,  4.77s/it] 55%|█████▌    | 165/300 [11:14<12:07,  5.39s/it] 55%|█████▌    | 166/300 [11:21<12:59,  5.82s/it] 56%|█████▌    | 167/300 [11:25<11:45,  5.30s/it] 56%|█████▌    | 168/300 [11:27<09:36,  4.37s/it] 56%|█████▋    | 169/300 [11:31<09:35,  4.39s/it] 57%|█████▋    | 170/300 [11:39<11:20,  5.23s/it] 57%|█████▋    | 171/300 [11:44<11:08,  5.18s/it] 57%|█████▋    | 172/300 [11:47<10:03,  4.71s/it] 58%|█████▊    | 173/300 [11:50<08:36,  4.07s/it] 58%|█████▊    | 174/300 [11:54<08:30,  4.05s/it] 58%|█████▊    | 175/300 [11:59<08:49,  4.24s/it] 59%|█████▊    | 176/300 [12:06<10:39,  5.16s/it] 59%|█████▉    | 177/300 [12:08<08:53,  4.34s/it] 59%|█████▉    | 178/300 [12:14<09:53,  4.86s/it] 60%|█████▉    | 179/300 [12:19<09:50,  4.88s/it] 60%|██████    | 180/300 [12:21<08:06,  4.05s/it] 60%|██████    | 181/300 [12:26<08:34,  4.33s/it] 61%|██████    | 182/300 [12:33<09:51,  5.01s/it] 61%|██████    | 183/300 [12:40<11:10,  5.73s/it] 61%|██████▏   | 184/300 [12:45<10:38,  5.51s/it] 62%|██████▏   | 185/300 [12:48<08:47,  4.59s/it] 62%|██████▏   | 186/300 [12:55<10:11,  5.36s/it] 62%|██████▏   | 187/300 [13:00<09:52,  5.24s/it] 63%|██████▎   | 188/300 [13:07<10:47,  5.79s/it] 63%|██████▎   | 189/300 [13:14<11:32,  6.24s/it] 63%|██████▎   | 190/300 [13:21<11:50,  6.46s/it] 64%|██████▎   | 191/300 [13:24<09:38,  5.31s/it] 64%|██████▍   | 192/300 [13:26<07:57,  4.43s/it] 64%|██████▍   | 193/300 [13:33<09:10,  5.15s/it] 65%|██████▍   | 194/300 [13:36<07:46,  4.40s/it] 65%|██████▌   | 195/300 [13:41<08:00,  4.57s/it] 65%|██████▌   | 196/300 [13:48<09:16,  5.35s/it] 66%|██████▌   | 197/300 [13:55<10:03,  5.86s/it] 66%|██████▌   | 198/300 [13:58<08:16,  4.87s/it] 66%|██████▋   | 199/300 [14:00<06:49,  4.06s/it] 67%|██████▋   | 200/300 [14:07<08:18,  4.98s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (17161 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [14:15<09:41,  5.87s/it] 67%|██████▋   | 202/300 [14:23<10:47,  6.60s/it] 68%|██████▊   | 203/300 [14:28<09:48,  6.07s/it] 68%|██████▊   | 204/300 [14:36<10:45,  6.72s/it] 68%|██████▊   | 205/300 [14:44<11:21,  7.18s/it] 69%|██████▊   | 206/300 [14:53<11:44,  7.50s/it] 69%|██████▉   | 207/300 [14:56<09:41,  6.26s/it] 69%|██████▉   | 208/300 [15:04<10:31,  6.87s/it] 70%|██████▉   | 209/300 [15:12<10:59,  7.25s/it] 70%|███████   | 210/300 [15:20<11:12,  7.47s/it] 70%|███████   | 211/300 [15:24<09:26,  6.36s/it] 71%|███████   | 212/300 [15:32<09:57,  6.79s/it] 71%|███████   | 213/300 [15:35<08:10,  5.64s/it] 71%|███████▏  | 214/300 [15:43<09:11,  6.42s/it] 72%|███████▏  | 215/300 [15:48<08:20,  5.89s/it] 72%|███████▏  | 216/300 [15:53<08:08,  5.82s/it] 72%|███████▏  | 217/300 [16:02<09:04,  6.56s/it] 73%|███████▎  | 218/300 [16:04<07:16,  5.32s/it] 73%|███████▎  | 219/300 [16:13<08:23,  6.21s/it] 73%|███████▎  | 220/300 [16:21<09:07,  6.85s/it] 74%|███████▎  | 221/300 [16:27<08:55,  6.78s/it] 74%|███████▍  | 222/300 [16:35<09:18,  7.16s/it] 74%|███████▍  | 223/300 [16:44<09:32,  7.43s/it] 75%|███████▍  | 224/300 [16:47<07:51,  6.20s/it] 75%|███████▌  | 225/300 [16:55<08:26,  6.76s/it] 75%|███████▌  | 226/300 [16:58<06:51,  5.55s/it] 76%|███████▌  | 227/300 [17:06<07:44,  6.36s/it] 76%|███████▌  | 228/300 [17:14<08:16,  6.90s/it] 76%|███████▋  | 229/300 [17:17<06:54,  5.83s/it] 77%|███████▋  | 230/300 [17:25<07:25,  6.37s/it] 77%|███████▋  | 231/300 [17:32<07:39,  6.66s/it] 77%|███████▋  | 232/300 [17:36<06:35,  5.82s/it] 78%|███████▊  | 233/300 [17:44<07:08,  6.40s/it] 78%|███████▊  | 234/300 [17:49<06:29,  5.90s/it] 78%|███████▊  | 235/300 [17:54<06:16,  5.80s/it] 79%|███████▊  | 236/300 [17:58<05:36,  5.26s/it] 79%|███████▉  | 237/300 [18:02<05:00,  4.77s/it] 79%|███████▉  | 238/300 [18:07<05:00,  4.84s/it] 80%|███████▉  | 239/300 [18:15<05:58,  5.87s/it] 80%|████████  | 240/300 [18:23<06:33,  6.56s/it] 80%|████████  | 241/300 [18:31<06:45,  6.88s/it] 81%|████████  | 242/300 [18:39<07:00,  7.26s/it] 81%|████████  | 243/300 [18:48<07:13,  7.60s/it] 81%|████████▏ | 244/300 [18:51<05:57,  6.38s/it] 82%|████████▏ | 245/300 [18:54<05:01,  5.47s/it] 82%|████████▏ | 246/300 [19:03<05:38,  6.26s/it] 82%|████████▏ | 247/300 [19:07<05:00,  5.66s/it] 83%|████████▎ | 248/300 [19:14<05:22,  6.20s/it] 83%|████████▎ | 249/300 [19:22<05:43,  6.73s/it] 83%|████████▎ | 250/300 [19:30<05:49,  6.99s/it] 84%|████████▎ | 251/300 [19:38<05:59,  7.34s/it] 84%|████████▍ | 252/300 [19:41<04:53,  6.11s/it] 84%|████████▍ | 253/300 [19:48<04:54,  6.27s/it] 85%|████████▍ | 254/300 [19:54<04:46,  6.23s/it] 85%|████████▌ | 255/300 [20:02<05:08,  6.85s/it] 85%|████████▌ | 256/300 [20:09<04:59,  6.81s/it] 86%|████████▌ | 257/300 [20:16<04:56,  6.90s/it] 86%|████████▌ | 258/300 [20:24<05:07,  7.31s/it] 86%|████████▋ | 259/300 [20:33<05:11,  7.61s/it] 87%|████████▋ | 260/300 [20:39<04:52,  7.32s/it] 87%|████████▋ | 261/300 [20:45<04:27,  6.86s/it] 87%|████████▋ | 262/300 [20:53<04:37,  7.30s/it] 88%|████████▊ | 263/300 [21:02<04:39,  7.54s/it] 88%|████████▊ | 264/300 [21:08<04:21,  7.25s/it] 88%|████████▊ | 265/300 [21:16<04:23,  7.54s/it] 89%|████████▊ | 266/300 [21:25<04:24,  7.77s/it] 89%|████████▉ | 267/300 [21:30<03:55,  7.14s/it] 89%|████████▉ | 268/300 [21:36<03:34,  6.70s/it] 90%|████████▉ | 269/300 [21:42<03:22,  6.53s/it] 90%|█████████ | 270/300 [21:48<03:10,  6.34s/it] 90%|█████████ | 271/300 [21:56<03:21,  6.95s/it] 91%|█████████ | 272/300 [22:05<03:25,  7.35s/it] 91%|█████████ | 273/300 [22:12<03:20,  7.42s/it] 91%|█████████▏| 274/300 [22:20<03:17,  7.60s/it] 92%|█████████▏| 275/300 [22:28<03:11,  7.68s/it] 92%|█████████▏| 276/300 [22:32<02:39,  6.64s/it] 92%|█████████▏| 277/300 [22:35<02:04,  5.42s/it] 93%|█████████▎| 278/300 [22:38<01:41,  4.63s/it] 93%|█████████▎| 279/300 [22:43<01:42,  4.87s/it] 93%|█████████▎| 280/300 [22:49<01:42,  5.12s/it] 94%|█████████▎| 281/300 [22:53<01:32,  4.87s/it] 94%|█████████▍| 282/300 [22:56<01:15,  4.22s/it] 94%|█████████▍| 283/300 [23:04<01:29,  5.26s/it] 95%|█████████▍| 284/300 [23:06<01:11,  4.50s/it] 95%|█████████▌| 285/300 [23:13<01:16,  5.07s/it] 95%|█████████▌| 286/300 [23:21<01:23,  5.93s/it] 96%|█████████▌| 287/300 [23:24<01:08,  5.25s/it] 96%|█████████▌| 288/300 [23:27<00:53,  4.44s/it] 96%|█████████▋| 289/300 [23:35<01:01,  5.60s/it] 97%|█████████▋| 290/300 [23:42<00:59,  5.93s/it] 97%|█████████▋| 291/300 [23:49<00:57,  6.38s/it] 97%|█████████▋| 292/300 [23:53<00:43,  5.49s/it] 98%|█████████▊| 293/300 [24:00<00:43,  6.15s/it] 98%|█████████▊| 294/300 [24:08<00:40,  6.68s/it] 98%|█████████▊| 295/300 [24:14<00:31,  6.34s/it] 99%|█████████▊| 296/300 [24:22<00:27,  6.85s/it] 99%|█████████▉| 297/300 [24:30<00:21,  7.25s/it] 99%|█████████▉| 298/300 [24:38<00:15,  7.54s/it]100%|█████████▉| 299/300 [24:42<00:06,  6.41s/it]100%|██████████| 300/300 [24:48<00:00,  6.36s/it]100%|██████████| 300/300 [24:48<00:00,  4.96s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.27s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.36s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.44s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  3.90s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  4.07s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:06<31:05,  6.24s/it]  1%|          | 2/300 [00:08<19:56,  4.02s/it]  1%|          | 3/300 [00:12<18:24,  3.72s/it]  1%|▏         | 4/300 [00:17<21:48,  4.42s/it]  2%|▏         | 5/300 [00:27<31:23,  6.38s/it]  2%|▏         | 6/300 [00:34<32:53,  6.71s/it]  2%|▏         | 7/300 [00:43<36:14,  7.42s/it]  3%|▎         | 8/300 [00:53<40:15,  8.27s/it]  3%|▎         | 9/300 [00:56<31:47,  6.55s/it]  3%|▎         | 10/300 [01:07<37:43,  7.80s/it]  4%|▎         | 11/300 [01:17<41:40,  8.65s/it]  4%|▍         | 12/300 [01:19<31:39,  6.60s/it]  4%|▍         | 13/300 [01:21<24:36,  5.14s/it]  5%|▍         | 14/300 [01:26<23:45,  4.98s/it]  5%|▌         | 15/300 [01:32<26:18,  5.54s/it]  5%|▌         | 16/300 [01:43<33:11,  7.01s/it]  6%|▌         | 17/300 [01:53<38:01,  8.06s/it]  6%|▌         | 18/300 [01:56<30:18,  6.45s/it]  6%|▋         | 19/300 [01:58<24:38,  5.26s/it]  7%|▋         | 20/300 [02:01<20:35,  4.41s/it]  7%|▋         | 21/300 [02:04<18:41,  4.02s/it]  7%|▋         | 22/300 [02:13<25:29,  5.50s/it]  8%|▊         | 23/300 [02:15<19:56,  4.32s/it]  8%|▊         | 24/300 [02:25<28:50,  6.27s/it]  8%|▊         | 25/300 [02:34<31:47,  6.94s/it]  9%|▊         | 26/300 [02:37<25:57,  5.68s/it]  9%|▉         | 27/300 [02:47<32:27,  7.13s/it]  9%|▉         | 28/300 [02:52<29:05,  6.42s/it] 10%|▉         | 29/300 [02:58<29:16,  6.48s/it] 10%|█         | 30/300 [03:05<29:25,  6.54s/it] 10%|█         | 31/300 [03:16<34:50,  7.77s/it] 11%|█         | 32/300 [03:26<38:19,  8.58s/it] 11%|█         | 33/300 [03:37<40:48,  9.17s/it] 11%|█▏        | 34/300 [03:47<42:26,  9.57s/it] 12%|█▏        | 35/300 [03:56<41:30,  9.40s/it] 12%|█▏        | 36/300 [04:04<39:28,  8.97s/it] 12%|█▏        | 37/300 [04:07<30:27,  6.95s/it] 13%|█▎        | 38/300 [04:10<25:17,  5.79s/it] 13%|█▎        | 39/300 [04:20<31:16,  7.19s/it] 13%|█▎        | 40/300 [04:30<34:07,  7.87s/it] 14%|█▎        | 41/300 [04:37<33:25,  7.74s/it] 14%|█▍        | 42/300 [04:39<26:33,  6.18s/it] 14%|█▍        | 43/300 [04:49<31:04,  7.26s/it] 15%|█▍        | 44/300 [04:51<23:31,  5.51s/it] 15%|█▌        | 45/300 [04:52<17:42,  4.17s/it] 15%|█▌        | 46/300 [04:55<15:53,  3.75s/it] 16%|█▌        | 47/300 [04:58<15:05,  3.58s/it] 16%|█▌        | 48/300 [05:08<23:47,  5.66s/it] 16%|█▋        | 49/300 [05:17<27:17,  6.52s/it] 17%|█▋        | 50/300 [05:22<26:04,  6.26s/it] 17%|█▋        | 51/300 [05:32<29:54,  7.21s/it] 17%|█▋        | 52/300 [05:39<29:24,  7.11s/it] 18%|█▊        | 53/300 [05:46<29:07,  7.07s/it] 18%|█▊        | 54/300 [05:48<22:38,  5.52s/it] 18%|█▊        | 55/300 [05:51<20:11,  4.94s/it] 19%|█▊        | 56/300 [05:54<17:53,  4.40s/it] 19%|█▉        | 57/300 [05:56<15:03,  3.72s/it] 19%|█▉        | 58/300 [05:58<12:21,  3.06s/it] 20%|█▉        | 59/300 [06:03<14:19,  3.57s/it] 20%|██        | 60/300 [06:04<11:48,  2.95s/it] 20%|██        | 61/300 [06:15<20:50,  5.23s/it] 21%|██        | 62/300 [06:18<17:48,  4.49s/it] 21%|██        | 63/300 [06:27<23:11,  5.87s/it] 21%|██▏       | 64/300 [06:35<25:39,  6.52s/it] 22%|██▏       | 65/300 [06:46<30:40,  7.83s/it] 22%|██▏       | 66/300 [06:51<28:16,  7.25s/it] 22%|██▏       | 67/300 [06:57<26:34,  6.84s/it] 23%|██▎       | 68/300 [07:08<30:37,  7.92s/it] 23%|██▎       | 69/300 [07:15<29:29,  7.66s/it] 23%|██▎       | 70/300 [07:25<32:03,  8.36s/it] 24%|██▎       | 71/300 [07:27<25:08,  6.59s/it] 24%|██▍       | 72/300 [07:33<23:56,  6.30s/it] 24%|██▍       | 73/300 [07:39<23:29,  6.21s/it] 25%|██▍       | 74/300 [07:44<21:57,  5.83s/it] 25%|██▌       | 75/300 [07:50<22:14,  5.93s/it] 25%|██▌       | 76/300 [07:53<18:28,  4.95s/it] 26%|██▌       | 77/300 [07:55<15:31,  4.18s/it] 26%|██▌       | 78/300 [07:57<13:20,  3.61s/it] 26%|██▋       | 79/300 [08:00<12:23,  3.36s/it] 27%|██▋       | 80/300 [08:03<12:18,  3.36s/it] 27%|██▋       | 81/300 [08:14<20:10,  5.53s/it] 27%|██▋       | 82/300 [08:21<21:38,  5.96s/it] 28%|██▊       | 83/300 [08:32<26:36,  7.36s/it] 28%|██▊       | 84/300 [08:34<20:59,  5.83s/it] 28%|██▊       | 85/300 [08:37<17:38,  4.92s/it] 29%|██▊       | 86/300 [08:47<23:17,  6.53s/it] 29%|██▉       | 87/300 [08:49<18:00,  5.07s/it] 29%|██▉       | 88/300 [08:53<17:12,  4.87s/it] 30%|██▉       | 89/300 [08:58<17:36,  5.01s/it] 30%|███       | 90/300 [09:01<14:36,  4.17s/it] 30%|███       | 91/300 [09:03<13:02,  3.75s/it] 31%|███       | 92/300 [09:09<14:33,  4.20s/it] 31%|███       | 93/300 [09:16<18:00,  5.22s/it] 31%|███▏      | 94/300 [09:27<23:16,  6.78s/it] 32%|███▏      | 95/300 [09:34<23:19,  6.83s/it] 32%|███▏      | 96/300 [09:44<26:24,  7.77s/it] 32%|███▏      | 97/300 [09:47<22:20,  6.61s/it] 33%|███▎      | 98/300 [09:49<17:26,  5.18s/it] 33%|███▎      | 99/300 [09:53<16:05,  4.80s/it] 33%|███▎      | 100/300 [10:04<21:45,  6.53s/it] 34%|███▎      | 101/300 [10:09<20:06,  6.06s/it] 34%|███▍      | 102/300 [10:13<18:21,  5.57s/it] 34%|███▍      | 103/300 [10:17<16:45,  5.10s/it] 35%|███▍      | 104/300 [10:20<14:54,  4.56s/it] 35%|███▌      | 105/300 [10:33<22:07,  6.81s/it] 35%|███▌      | 106/300 [10:37<20:04,  6.21s/it] 36%|███▌      | 107/300 [10:49<25:34,  7.95s/it] 36%|███▌      | 108/300 [10:53<21:28,  6.71s/it] 36%|███▋      | 109/300 [10:59<20:31,  6.45s/it] 37%|███▋      | 110/300 [11:03<18:30,  5.84s/it] 37%|███▋      | 111/300 [11:14<23:07,  7.34s/it] 37%|███▋      | 112/300 [11:26<27:26,  8.76s/it] 38%|███▊      | 113/300 [11:30<22:14,  7.14s/it] 38%|███▊      | 114/300 [11:41<26:03,  8.41s/it] 38%|███▊      | 115/300 [11:44<20:36,  6.68s/it] 39%|███▊      | 116/300 [11:51<20:58,  6.84s/it] 39%|███▉      | 117/300 [12:03<25:52,  8.48s/it] 39%|███▉      | 118/300 [12:15<28:54,  9.53s/it] 40%|███▉      | 119/300 [12:24<28:02,  9.29s/it] 40%|████      | 120/300 [12:29<24:23,  8.13s/it] 40%|████      | 121/300 [12:33<20:33,  6.89s/it] 41%|████      | 122/300 [12:46<25:05,  8.46s/it] 41%|████      | 123/300 [12:55<25:52,  8.77s/it] 41%|████▏     | 124/300 [13:06<28:02,  9.56s/it] 42%|████▏     | 125/300 [13:11<23:41,  8.12s/it] 42%|████▏     | 126/300 [13:17<21:40,  7.47s/it] 42%|████▏     | 127/300 [13:26<22:47,  7.90s/it] 43%|████▎     | 128/300 [13:34<22:30,  7.85s/it] 43%|████▎     | 129/300 [13:38<19:21,  6.79s/it] 43%|████▎     | 130/300 [13:50<23:34,  8.32s/it] 44%|████▎     | 131/300 [13:53<19:13,  6.83s/it] 44%|████▍     | 132/300 [14:05<23:06,  8.25s/it] 44%|████▍     | 133/300 [14:11<20:48,  7.48s/it] 45%|████▍     | 134/300 [14:18<20:18,  7.34s/it] 45%|████▌     | 135/300 [14:22<17:24,  6.33s/it] 45%|████▌     | 136/300 [14:30<19:05,  6.98s/it] 46%|████▌     | 137/300 [14:42<22:42,  8.36s/it] 46%|████▌     | 138/300 [14:47<20:30,  7.60s/it] 46%|████▋     | 139/300 [14:59<23:38,  8.81s/it] 46%|████▋     | 139/300 [15:02<17:24,  6.49s/it]
Traceback (most recent call last):
  File "/lus/grand/projects/datascience/krishnat/home_dir_code/Active_projects/MoE-Varying-TopK/LongBench/pred_v1_main.py", line 63, in <module>
    get_pred_main(args = args,
  File "/lus/grand/projects/datascience/krishnat/home_dir_code/Active_projects/MoE-Varying-TopK/LongBench/pred_models/deepseek/deepseek2_longbench_v1.py", line 80, in get_pred_deepseekv2
    output = model.generate(
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/utils.py", line 2252, in generate
    result = self._sample(
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/utils.py", line 3251, in _sample
    outputs = self(**model_inputs, return_dict=True)
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/accelerate/hooks.py", line 176, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/lus/grand/projects/datascience/krishnat/home_dir_code/Active_projects/MoE-Varying-TopK/LongBench/models/DeepSeekV2/modeling_deepseekv2.py", line 1655, in forward
    outputs = self.model(
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lus/grand/projects/datascience/krishnat/home_dir_code/Active_projects/MoE-Varying-TopK/LongBench/models/DeepSeekV2/modeling_deepseekv2.py", line 1524, in forward
    layer_outputs = decoder_layer(
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/accelerate/hooks.py", line 176, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/lus/grand/projects/datascience/krishnat/home_dir_code/Active_projects/MoE-Varying-TopK/LongBench/models/DeepSeekV2/modeling_deepseekv2.py", line 1252, in forward
    hidden_states = self.mlp(hidden_states)
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/accelerate/hooks.py", line 176, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/lus/grand/projects/datascience/krishnat/home_dir_code/Active_projects/MoE-Varying-TopK/LongBench/models/DeepSeekV2/modeling_deepseekv2.py", line 566, in forward
    y = self.moe_infer(hidden_states, topk_idx, topk_weight).view(*orig_shape)
  File "/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/lus/grand/projects/datascience/krishnat/home_dir_code/Active_projects/MoE-Varying-TopK/LongBench/models/DeepSeekV2/modeling_deepseekv2.py", line 640, in moe_infer
    .type(topk_weight.dtype)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 7.31 GiB. GPU 1 has a total capacity of 39.39 GiB of which 5.18 GiB is free. Including non-PyTorch memory, this process has 34.20 GiB memory in use. Of the allocated memory 22.43 GiB is allocated by PyTorch, and 11.28 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
