
Lmod is automatically replacing "nvhpc/23.9" with "gcc-native/12.3".


Lmod is automatically replacing "PrgEnv-nvhpc/8.5.0" with "PrgEnv-gnu/8.5.0".


Due to MODULEPATH changes, the following have been reloaded:
  1) cray-mpich/8.1.28

The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:09<00:27,  9.04s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:18<00:18,  9.05s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:27<00:09,  9.15s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:33<00:00,  7.86s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:33<00:00,  8.31s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:20<1:44:22, 20.95s/it]  1%|          | 2/300 [00:52<2:14:45, 27.13s/it]  1%|          | 3/300 [01:18<2:12:47, 26.83s/it]  1%|▏         | 4/300 [01:45<2:11:38, 26.69s/it]  2%|▏         | 5/300 [02:17<2:20:37, 28.60s/it]  2%|▏         | 6/300 [02:43<2:16:39, 27.89s/it]  2%|▏         | 7/300 [03:10<2:14:07, 27.47s/it]  3%|▎         | 8/300 [03:20<1:46:31, 21.89s/it]  3%|▎         | 9/300 [03:43<1:48:17, 22.33s/it]  3%|▎         | 10/300 [04:10<1:54:14, 23.64s/it]  4%|▎         | 11/300 [04:23<1:38:02, 20.35s/it]  4%|▍         | 12/300 [04:49<1:46:42, 22.23s/it]  4%|▍         | 13/300 [05:16<1:52:43, 23.57s/it]  5%|▍         | 14/300 [05:42<1:56:39, 24.47s/it]  5%|▌         | 15/300 [06:02<1:49:06, 22.97s/it]  5%|▌         | 16/300 [06:28<1:53:52, 24.06s/it]  6%|▌         | 17/300 [06:55<1:57:01, 24.81s/it]  6%|▌         | 18/300 [07:22<1:59:02, 25.33s/it]  6%|▋         | 19/300 [07:48<2:00:16, 25.68s/it]  7%|▋         | 20/300 [07:58<1:37:20, 20.86s/it]  7%|▋         | 21/300 [08:24<1:45:04, 22.60s/it]  7%|▋         | 22/300 [08:51<1:50:16, 23.80s/it]  8%|▊         | 23/300 [09:18<1:53:43, 24.64s/it]  8%|▊         | 24/300 [09:44<1:55:56, 25.20s/it]  8%|▊         | 25/300 [10:00<1:43:13, 22.52s/it]  9%|▊         | 26/300 [10:27<1:48:20, 23.73s/it]  9%|▉         | 27/300 [10:53<1:51:48, 24.57s/it]  9%|▉         | 28/300 [11:08<1:37:13, 21.45s/it] 10%|▉         | 29/300 [11:34<1:43:49, 22.99s/it] 10%|█         | 30/300 [12:01<1:48:18, 24.07s/it] 10%|█         | 31/300 [12:27<1:51:16, 24.82s/it] 11%|█         | 32/300 [12:39<1:33:47, 21.00s/it] 11%|█         | 33/300 [13:06<1:40:54, 22.68s/it] 11%|█▏        | 34/300 [13:33<1:45:48, 23.87s/it] 12%|█▏        | 35/300 [13:50<1:37:13, 22.01s/it] 12%|█▏        | 36/300 [14:01<1:22:18, 18.70s/it] 12%|█▏        | 37/300 [14:28<1:32:15, 21.05s/it] 13%|█▎        | 38/300 [14:54<1:39:04, 22.69s/it] 13%|█▎        | 39/300 [15:21<1:43:44, 23.85s/it] 13%|█▎        | 40/300 [15:47<1:46:54, 24.67s/it] 14%|█▎        | 41/300 [16:14<1:49:02, 25.26s/it] 14%|█▍        | 42/300 [16:41<1:50:10, 25.62s/it] 14%|█▍        | 43/300 [17:07<1:50:54, 25.89s/it] 15%|█▍        | 44/300 [17:15<1:27:01, 20.39s/it] 15%|█▌        | 45/300 [17:41<1:34:26, 22.22s/it] 15%|█▌        | 46/300 [18:08<1:39:23, 23.48s/it] 16%|█▌        | 47/300 [18:34<1:42:41, 24.35s/it] 16%|█▌        | 48/300 [19:00<1:44:45, 24.94s/it] 16%|█▋        | 49/300 [19:27<1:46:02, 25.35s/it] 17%|█▋        | 50/300 [19:39<1:29:46, 21.55s/it] 17%|█▋        | 51/300 [20:06<1:35:19, 22.97s/it] 17%|█▋        | 52/300 [20:13<1:15:14, 18.20s/it] 18%|█▊        | 53/300 [20:39<1:24:35, 20.55s/it] 18%|█▊        | 54/300 [21:05<1:31:18, 22.27s/it] 18%|█▊        | 55/300 [21:31<1:35:59, 23.51s/it] 19%|█▊        | 56/300 [21:58<1:39:03, 24.36s/it] 19%|█▉        | 57/300 [22:08<1:21:17, 20.07s/it] 19%|█▉        | 58/300 [22:34<1:28:35, 21.96s/it] 20%|█▉        | 59/300 [23:00<1:33:32, 23.29s/it] 20%|██        | 60/300 [23:18<1:26:00, 21.50s/it] 20%|██        | 61/300 [23:44<1:31:48, 23.05s/it] 21%|██        | 62/300 [24:11<1:35:18, 24.03s/it] 21%|██        | 63/300 [24:37<1:37:37, 24.72s/it] 21%|██▏       | 64/300 [24:50<1:23:46, 21.30s/it] 22%|██▏       | 65/300 [25:17<1:29:14, 22.79s/it] 22%|██▏       | 66/300 [25:43<1:33:21, 23.94s/it] 22%|██▏       | 67/300 [26:10<1:35:41, 24.64s/it] 23%|██▎       | 68/300 [26:36<1:37:26, 25.20s/it] 23%|██▎       | 69/300 [27:02<1:38:20, 25.54s/it] 23%|██▎       | 70/300 [27:29<1:38:56, 25.81s/it] 24%|██▎       | 71/300 [27:55<1:39:07, 25.97s/it] 24%|██▍       | 72/300 [28:22<1:39:05, 26.08s/it] 24%|██▍       | 73/300 [28:48<1:38:55, 26.15s/it] 25%|██▍       | 74/300 [28:56<1:18:33, 20.86s/it] 25%|██▌       | 75/300 [29:23<1:24:23, 22.51s/it] 25%|██▌       | 76/300 [29:49<1:28:23, 23.67s/it] 26%|██▌       | 77/300 [29:58<1:12:00, 19.38s/it] 26%|██▌       | 78/300 [30:25<1:19:20, 21.44s/it] 26%|██▋       | 79/300 [30:51<1:24:38, 22.98s/it] 27%|██▋       | 80/300 [31:18<1:27:54, 23.98s/it] 27%|██▋       | 81/300 [31:44<1:30:14, 24.73s/it] 27%|██▋       | 82/300 [32:10<1:31:33, 25.20s/it] 28%|██▊       | 83/300 [32:33<1:28:35, 24.50s/it] 28%|██▊       | 84/300 [32:40<1:08:31, 19.03s/it] 28%|██▊       | 85/300 [33:06<1:15:57, 21.20s/it] 29%|██▊       | 86/300 [33:18<1:06:10, 18.55s/it] 29%|██▉       | 87/300 [33:45<1:14:54, 21.10s/it] 29%|██▉       | 88/300 [34:12<1:20:06, 22.67s/it] 30%|██▉       | 89/300 [34:38<1:23:48, 23.83s/it] 30%|███       | 90/300 [35:04<1:26:05, 24.60s/it] 30%|███       | 91/300 [35:22<1:18:35, 22.56s/it] 31%|███       | 92/300 [35:49<1:22:15, 23.73s/it] 31%|███       | 93/300 [36:15<1:24:34, 24.52s/it] 31%|███▏      | 94/300 [36:21<1:05:24, 19.05s/it] 32%|███▏      | 95/300 [36:30<54:45, 16.03s/it]   32%|███▏      | 96/300 [36:40<47:52, 14.08s/it] 32%|███▏      | 97/300 [36:49<42:23, 12.53s/it] 33%|███▎      | 98/300 [37:06<47:18, 14.05s/it] 33%|███▎      | 99/300 [37:33<59:34, 17.78s/it] 33%|███▎      | 100/300 [37:59<1:07:50, 20.35s/it] 34%|███▎      | 101/300 [38:32<1:19:59, 24.12s/it] 34%|███▍      | 102/300 [38:59<1:21:56, 24.83s/it] 34%|███▍      | 103/300 [39:25<1:23:04, 25.30s/it] 35%|███▍      | 104/300 [39:52<1:23:52, 25.68s/it] 35%|███▌      | 105/300 [40:07<1:13:02, 22.48s/it] 35%|███▌      | 106/300 [40:33<1:16:55, 23.79s/it] 36%|███▌      | 107/300 [41:00<1:19:05, 24.59s/it] 36%|███▌      | 108/300 [41:27<1:21:10, 25.37s/it] 36%|███▋      | 109/300 [41:54<1:21:44, 25.68s/it] 37%|███▋      | 110/300 [42:20<1:22:31, 26.06s/it] 37%|███▋      | 111/300 [42:47<1:22:46, 26.28s/it] 37%|███▋      | 112/300 [42:58<1:07:39, 21.59s/it] 38%|███▊      | 113/300 [43:25<1:12:47, 23.36s/it] 38%|███▊      | 114/300 [43:37<1:01:51, 19.95s/it] 38%|███▊      | 115/300 [44:05<1:08:37, 22.26s/it] 39%|███▊      | 116/300 [44:32<1:12:38, 23.69s/it] 39%|███▉      | 117/300 [44:58<1:14:44, 24.51s/it] 39%|███▉      | 118/300 [45:25<1:15:58, 25.05s/it] 40%|███▉      | 119/300 [45:52<1:17:13, 25.60s/it] 40%|████      | 120/300 [46:18<1:17:27, 25.82s/it] 40%|████      | 121/300 [46:27<1:02:08, 20.83s/it] 41%|████      | 122/300 [46:40<55:02, 18.56s/it]   41%|████      | 123/300 [47:02<57:00, 19.32s/it] 41%|████▏     | 124/300 [47:28<1:02:58, 21.47s/it] 42%|████▏     | 125/300 [47:55<1:07:34, 23.17s/it] 42%|████▏     | 126/300 [48:22<1:10:49, 24.42s/it] 42%|████▏     | 127/300 [48:49<1:12:06, 25.01s/it] 43%|████▎     | 128/300 [48:57<56:53, 19.84s/it]   43%|████▎     | 129/300 [49:23<1:02:12, 21.83s/it] 43%|████▎     | 130/300 [49:49<1:05:42, 23.19s/it] 44%|████▎     | 131/300 [50:16<1:08:00, 24.15s/it] 44%|████▍     | 132/300 [50:42<1:09:26, 24.80s/it] 44%|████▍     | 133/300 [50:59<1:02:30, 22.46s/it] 45%|████▍     | 134/300 [51:26<1:05:54, 23.82s/it] 45%|████▌     | 135/300 [51:37<54:55, 19.97s/it]   45%|████▌     | 136/300 [52:04<1:00:22, 22.09s/it] 46%|████▌     | 137/300 [52:31<1:03:36, 23.41s/it] 46%|████▌     | 138/300 [52:57<1:05:34, 24.29s/it] 46%|████▋     | 139/300 [53:11<56:34, 21.09s/it]   47%|████▋     | 140/300 [53:38<1:00:50, 22.81s/it] 47%|████▋     | 141/300 [54:04<1:03:46, 24.06s/it] 47%|████▋     | 142/300 [54:38<1:10:50, 26.90s/it] 48%|████▊     | 143/300 [55:04<1:09:59, 26.75s/it] 48%|████▊     | 144/300 [55:31<1:09:20, 26.67s/it] 48%|████▊     | 145/300 [55:57<1:08:36, 26.56s/it] 49%|████▊     | 146/300 [56:25<1:08:45, 26.79s/it] 49%|████▉     | 147/300 [56:44<1:02:34, 24.54s/it] 49%|████▉     | 148/300 [56:54<51:03, 20.16s/it]   50%|████▉     | 149/300 [57:14<50:26, 20.04s/it] 50%|█████     | 150/300 [57:40<54:51, 21.94s/it] 50%|█████     | 151/300 [58:06<57:48, 23.28s/it] 51%|█████     | 152/300 [58:33<59:43, 24.21s/it] 51%|█████     | 153/300 [59:00<1:01:22, 25.05s/it] 51%|█████▏    | 154/300 [59:32<1:06:04, 27.16s/it] 52%|█████▏    | 155/300 [59:58<1:05:03, 26.92s/it] 52%|█████▏    | 156/300 [1:00:25<1:04:35, 26.92s/it] 52%|█████▏    | 157/300 [1:00:52<1:03:56, 26.83s/it] 53%|█████▎    | 158/300 [1:01:19<1:03:30, 26.83s/it] 53%|█████▎    | 159/300 [1:01:34<54:59, 23.40s/it]   53%|█████▎    | 160/300 [1:02:00<56:43, 24.31s/it] 54%|█████▎    | 161/300 [1:02:27<57:49, 24.96s/it] 54%|█████▍    | 162/300 [1:02:56<59:59, 26.08s/it] 54%|█████▍    | 163/300 [1:03:05<47:52, 20.97s/it] 55%|█████▍    | 164/300 [1:03:18<42:34, 18.78s/it] 55%|█████▌    | 165/300 [1:03:45<47:24, 21.07s/it] 55%|█████▌    | 166/300 [1:04:17<54:46, 24.52s/it] 56%|█████▌    | 167/300 [1:04:44<56:09, 25.33s/it] 56%|█████▌    | 168/300 [1:04:53<44:47, 20.36s/it] 56%|█████▋    | 169/300 [1:05:20<48:40, 22.30s/it] 57%|█████▋    | 170/300 [1:05:47<51:06, 23.59s/it] 57%|█████▋    | 171/300 [1:06:14<52:53, 24.60s/it] 57%|█████▋    | 172/300 [1:06:21<41:42, 19.55s/it] 58%|█████▊    | 173/300 [1:06:47<45:29, 21.49s/it] 58%|█████▊    | 174/300 [1:07:13<47:59, 22.85s/it] 58%|█████▊    | 175/300 [1:07:39<49:36, 23.82s/it] 59%|█████▊    | 176/300 [1:08:02<48:35, 23.51s/it] 59%|█████▉    | 177/300 [1:08:29<49:53, 24.34s/it] 59%|█████▉    | 178/300 [1:08:55<50:32, 24.85s/it] 60%|█████▉    | 179/300 [1:09:21<51:07, 25.35s/it] 60%|██████    | 180/300 [1:09:30<40:54, 20.45s/it] 60%|██████    | 181/300 [1:09:57<44:09, 22.26s/it] 61%|██████    | 182/300 [1:10:23<45:59, 23.39s/it] 61%|██████    | 183/300 [1:10:49<47:08, 24.18s/it] 61%|██████▏   | 184/300 [1:11:15<48:06, 24.88s/it] 62%|██████▏   | 185/300 [1:11:42<49:04, 25.61s/it] 62%|██████▏   | 186/300 [1:12:00<44:13, 23.27s/it] 62%|██████▏   | 187/300 [1:12:26<45:22, 24.09s/it] 63%|██████▎   | 188/300 [1:12:54<46:49, 25.08s/it] 63%|██████▎   | 189/300 [1:13:07<39:49, 21.53s/it] 63%|██████▎   | 190/300 [1:13:33<41:57, 22.89s/it] 64%|██████▎   | 191/300 [1:14:01<44:09, 24.31s/it] 64%|██████▍   | 192/300 [1:14:27<44:39, 24.81s/it] 64%|██████▍   | 193/300 [1:14:53<44:51, 25.16s/it] 65%|██████▍   | 194/300 [1:15:19<45:02, 25.50s/it] 65%|██████▌   | 195/300 [1:15:45<45:04, 25.76s/it] 65%|██████▌   | 196/300 [1:16:11<44:55, 25.91s/it] 66%|██████▌   | 197/300 [1:16:25<38:14, 22.27s/it] 66%|██████▌   | 198/300 [1:16:51<39:51, 23.44s/it] 66%|██████▋   | 199/300 [1:17:17<40:45, 24.21s/it] 67%|██████▋   | 200/300 [1:17:43<41:14, 24.75s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (22166 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [1:18:22<47:51, 29.01s/it] 67%|██████▋   | 202/300 [1:18:55<49:02, 30.03s/it] 68%|██████▊   | 203/300 [1:19:26<49:20, 30.52s/it] 68%|██████▊   | 204/300 [1:19:42<41:40, 26.05s/it] 68%|██████▊   | 205/300 [1:20:14<44:14, 27.94s/it] 69%|██████▊   | 206/300 [1:20:43<43:59, 28.08s/it] 69%|██████▉   | 207/300 [1:21:13<44:15, 28.55s/it] 69%|██████▉   | 208/300 [1:21:42<44:13, 28.84s/it] 70%|██████▉   | 209/300 [1:22:10<43:14, 28.51s/it] 70%|███████   | 210/300 [1:22:42<44:28, 29.65s/it] 70%|███████   | 211/300 [1:23:14<45:11, 30.46s/it] 71%|███████   | 212/300 [1:23:47<45:30, 31.03s/it] 71%|███████   | 213/300 [1:24:17<44:31, 30.71s/it] 71%|███████▏  | 214/300 [1:24:46<43:23, 30.27s/it] 72%|███████▏  | 215/300 [1:25:15<42:26, 29.96s/it] 72%|███████▏  | 216/300 [1:25:44<41:22, 29.55s/it] 72%|███████▏  | 217/300 [1:26:15<41:29, 30.00s/it] 73%|███████▎  | 218/300 [1:26:27<33:40, 24.64s/it] 73%|███████▎  | 219/300 [1:26:41<29:07, 21.58s/it] 73%|███████▎  | 220/300 [1:27:13<32:56, 24.71s/it] 74%|███████▎  | 221/300 [1:27:44<35:01, 26.60s/it] 74%|███████▍  | 222/300 [1:28:14<35:47, 27.53s/it] 74%|███████▍  | 223/300 [1:28:43<35:43, 27.84s/it] 75%|███████▍  | 224/300 [1:29:11<35:33, 28.07s/it] 75%|███████▌  | 225/300 [1:29:34<33:12, 26.57s/it] 75%|███████▌  | 226/300 [1:29:53<29:51, 24.21s/it] 76%|███████▌  | 227/300 [1:30:25<32:25, 26.65s/it] 76%|███████▌  | 228/300 [1:30:39<27:09, 22.64s/it] 76%|███████▋  | 229/300 [1:31:07<28:39, 24.22s/it] 77%|███████▋  | 230/300 [1:31:39<31:05, 26.64s/it] 77%|███████▋  | 231/300 [1:32:09<31:43, 27.59s/it] 77%|███████▋  | 232/300 [1:32:41<32:48, 28.95s/it] 78%|███████▊  | 233/300 [1:33:13<33:28, 29.97s/it] 78%|███████▊  | 234/300 [1:33:46<33:45, 30.68s/it] 78%|███████▊  | 235/300 [1:34:18<33:48, 31.20s/it] 79%|███████▊  | 236/300 [1:34:28<26:23, 24.75s/it] 79%|███████▉  | 237/300 [1:35:00<28:23, 27.04s/it] 79%|███████▉  | 238/300 [1:35:29<28:25, 27.51s/it] 80%|███████▉  | 239/300 [1:35:59<28:47, 28.33s/it] 80%|████████  | 240/300 [1:36:27<28:24, 28.40s/it] 80%|████████  | 241/300 [1:37:00<29:05, 29.59s/it] 81%|████████  | 242/300 [1:37:30<28:41, 29.68s/it] 81%|████████  | 243/300 [1:37:52<26:08, 27.52s/it] 81%|████████▏ | 244/300 [1:38:21<25:55, 27.78s/it] 82%|████████▏ | 245/300 [1:38:52<26:33, 28.97s/it] 82%|████████▏ | 246/300 [1:39:23<26:26, 29.37s/it] 82%|████████▏ | 247/300 [1:39:52<25:54, 29.33s/it] 83%|████████▎ | 248/300 [1:40:24<26:11, 30.23s/it] 83%|████████▎ | 249/300 [1:40:54<25:40, 30.21s/it] 83%|████████▎ | 250/300 [1:41:22<24:37, 29.55s/it] 84%|████████▎ | 251/300 [1:41:55<24:56, 30.53s/it] 84%|████████▍ | 252/300 [1:42:07<19:49, 24.77s/it] 84%|████████▍ | 253/300 [1:42:37<20:45, 26.50s/it] 85%|████████▍ | 254/300 [1:43:07<21:04, 27.49s/it] 85%|████████▌ | 255/300 [1:43:37<21:17, 28.38s/it] 85%|████████▌ | 256/300 [1:43:49<17:09, 23.41s/it] 86%|████████▌ | 257/300 [1:44:18<18:02, 25.18s/it] 86%|████████▌ | 258/300 [1:44:56<20:10, 28.81s/it] 86%|████████▋ | 259/300 [1:45:28<20:25, 29.89s/it] 87%|████████▋ | 260/300 [1:45:52<18:38, 27.96s/it] 87%|████████▋ | 261/300 [1:46:24<19:02, 29.28s/it] 87%|████████▋ | 262/300 [1:46:56<19:08, 30.21s/it] 88%|████████▊ | 263/300 [1:47:28<18:52, 30.61s/it] 88%|████████▊ | 264/300 [1:47:56<17:52, 29.78s/it] 88%|████████▊ | 265/300 [1:48:28<17:51, 30.61s/it] 89%|████████▊ | 266/300 [1:48:59<17:17, 30.52s/it] 89%|████████▉ | 267/300 [1:49:11<13:52, 25.24s/it] 89%|████████▉ | 268/300 [1:49:38<13:38, 25.57s/it] 90%|████████▉ | 269/300 [1:49:46<10:32, 20.39s/it] 90%|█████████ | 270/300 [1:50:15<11:29, 23.00s/it] 90%|█████████ | 271/300 [1:50:44<11:53, 24.60s/it] 91%|█████████ | 272/300 [1:51:12<12:02, 25.80s/it] 91%|█████████ | 273/300 [1:51:42<12:09, 27.01s/it] 91%|█████████▏| 274/300 [1:52:11<11:54, 27.47s/it] 92%|█████████▏| 275/300 [1:52:40<11:43, 28.14s/it] 92%|█████████▏| 276/300 [1:53:09<11:22, 28.43s/it] 92%|█████████▏| 277/300 [1:53:42<11:24, 29.76s/it] 93%|█████████▎| 278/300 [1:54:10<10:43, 29.26s/it] 93%|█████████▎| 279/300 [1:54:23<08:33, 24.45s/it] 93%|█████████▎| 280/300 [1:54:56<08:57, 26.89s/it] 94%|█████████▎| 281/300 [1:55:19<08:10, 25.83s/it] 94%|█████████▍| 282/300 [1:55:52<08:20, 27.82s/it] 94%|█████████▍| 283/300 [1:56:25<08:18, 29.32s/it] 95%|█████████▍| 284/300 [1:56:56<07:56, 29.76s/it] 95%|█████████▌| 285/300 [1:57:27<07:32, 30.17s/it] 95%|█████████▌| 286/300 [1:57:56<06:59, 29.96s/it] 96%|█████████▌| 287/300 [1:58:29<06:39, 30.73s/it] 96%|█████████▌| 288/300 [1:58:58<06:05, 30.43s/it] 96%|█████████▋| 289/300 [1:59:31<05:41, 31.03s/it] 97%|█████████▋| 290/300 [2:00:03<05:14, 31.46s/it] 97%|█████████▋| 291/300 [2:00:23<04:10, 27.83s/it] 97%|█████████▋| 292/300 [2:00:55<03:53, 29.22s/it] 98%|█████████▊| 293/300 [2:01:07<02:48, 24.12s/it] 98%|█████████▊| 294/300 [2:01:40<02:39, 26.65s/it] 98%|█████████▊| 295/300 [2:02:09<02:16, 27.27s/it] 99%|█████████▊| 296/300 [2:02:29<01:40, 25.12s/it] 99%|█████████▉| 297/300 [2:03:01<01:22, 27.37s/it] 99%|█████████▉| 298/300 [2:03:34<00:58, 29.04s/it]100%|█████████▉| 299/300 [2:04:06<00:29, 29.83s/it]100%|██████████| 300/300 [2:04:29<00:00, 27.90s/it]100%|██████████| 300/300 [2:04:29<00:00, 24.90s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:09<00:29,  9.77s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:19<00:19,  9.64s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:28<00:09,  9.51s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:34<00:00,  8.25s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:34<00:00,  8.75s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:29<2:25:07, 29.12s/it]  1%|          | 2/300 [00:46<1:49:06, 21.97s/it]  1%|          | 3/300 [01:03<1:38:36, 19.92s/it]  1%|▏         | 4/300 [01:29<1:50:34, 22.41s/it]  2%|▏         | 5/300 [02:02<2:09:11, 26.27s/it]  2%|▏         | 6/300 [02:30<2:11:43, 26.88s/it]  2%|▏         | 7/300 [02:48<1:56:22, 23.83s/it]  3%|▎         | 8/300 [03:01<1:39:06, 20.36s/it]  3%|▎         | 9/300 [03:29<1:50:36, 22.81s/it]  3%|▎         | 10/300 [03:53<1:51:58, 23.17s/it]  4%|▎         | 11/300 [04:15<1:49:15, 22.68s/it]  4%|▍         | 12/300 [04:33<1:41:44, 21.20s/it]  4%|▍         | 13/300 [05:01<1:51:23, 23.29s/it]  5%|▍         | 14/300 [05:25<1:52:41, 23.64s/it]  5%|▌         | 15/300 [05:36<1:34:09, 19.82s/it]  5%|▌         | 16/300 [05:50<1:25:24, 18.04s/it]  6%|▌         | 17/300 [06:04<1:19:24, 16.84s/it]  6%|▌         | 18/300 [06:32<1:34:54, 20.19s/it]  6%|▋         | 19/300 [07:00<1:45:37, 22.55s/it]  7%|▋         | 20/300 [07:17<1:37:40, 20.93s/it]  7%|▋         | 21/300 [07:29<1:25:05, 18.30s/it]  7%|▋         | 22/300 [07:57<1:38:21, 21.23s/it]  8%|▊         | 23/300 [08:25<1:47:23, 23.26s/it]  8%|▊         | 24/300 [08:45<1:41:44, 22.12s/it]  8%|▊         | 25/300 [09:13<1:49:31, 23.90s/it]  9%|▊         | 26/300 [09:41<1:54:40, 25.11s/it]  9%|▉         | 27/300 [09:58<1:42:57, 22.63s/it]  9%|▉         | 28/300 [10:07<1:24:43, 18.69s/it] 10%|▉         | 29/300 [10:35<1:36:53, 21.45s/it] 10%|█         | 30/300 [11:01<1:42:48, 22.85s/it] 10%|█         | 31/300 [11:16<1:31:16, 20.36s/it] 11%|█         | 32/300 [11:30<1:23:22, 18.67s/it] 11%|█         | 33/300 [11:38<1:08:09, 15.32s/it] 11%|█▏        | 34/300 [11:51<1:04:27, 14.54s/it] 12%|█▏        | 35/300 [12:07<1:06:53, 15.14s/it] 12%|█▏        | 36/300 [12:22<1:06:11, 15.04s/it] 12%|█▏        | 37/300 [12:30<56:57, 13.00s/it]   13%|█▎        | 38/300 [12:46<1:00:42, 13.90s/it] 13%|█▎        | 39/300 [13:14<1:18:42, 18.09s/it] 13%|█▎        | 40/300 [13:26<1:10:01, 16.16s/it] 14%|█▎        | 41/300 [13:39<1:05:42, 15.22s/it] 14%|█▍        | 42/300 [14:02<1:16:05, 17.70s/it] 14%|█▍        | 43/300 [14:30<1:28:46, 20.73s/it] 15%|█▍        | 44/300 [14:58<1:37:37, 22.88s/it] 15%|█▌        | 45/300 [15:26<1:43:34, 24.37s/it] 15%|█▌        | 46/300 [15:40<1:30:07, 21.29s/it] 16%|█▌        | 47/300 [15:58<1:26:17, 20.46s/it] 16%|█▌        | 48/300 [16:08<1:11:56, 17.13s/it] 16%|█▋        | 49/300 [16:20<1:05:30, 15.66s/it] 17%|█▋        | 50/300 [16:44<1:14:59, 18.00s/it] 17%|█▋        | 51/300 [17:11<1:26:58, 20.96s/it] 17%|█▋        | 52/300 [17:39<1:35:05, 23.00s/it] 18%|█▊        | 53/300 [17:49<1:18:34, 19.09s/it] 18%|█▊        | 54/300 [18:11<1:21:18, 19.83s/it] 18%|█▊        | 55/300 [18:39<1:30:47, 22.23s/it] 19%|█▊        | 56/300 [19:01<1:30:41, 22.30s/it] 19%|█▉        | 57/300 [19:15<1:20:40, 19.92s/it] 19%|█▉        | 58/300 [19:43<1:29:52, 22.28s/it] 20%|█▉        | 59/300 [20:11<1:36:16, 23.97s/it] 20%|██        | 60/300 [20:28<1:26:55, 21.73s/it] 20%|██        | 61/300 [20:55<1:33:54, 23.57s/it] 21%|██        | 62/300 [21:09<1:21:52, 20.64s/it] 21%|██        | 63/300 [21:37<1:30:02, 22.80s/it] 21%|██▏       | 64/300 [21:58<1:27:48, 22.32s/it] 22%|██▏       | 65/300 [22:08<1:13:02, 18.65s/it] 22%|██▏       | 66/300 [22:36<1:23:28, 21.40s/it] 22%|██▏       | 67/300 [23:02<1:27:54, 22.64s/it] 23%|██▎       | 68/300 [23:17<1:18:47, 20.38s/it] 23%|██▎       | 69/300 [23:45<1:27:07, 22.63s/it] 23%|██▎       | 70/300 [24:13<1:32:46, 24.20s/it] 24%|██▎       | 71/300 [24:37<1:32:50, 24.33s/it] 24%|██▍       | 72/300 [24:58<1:28:33, 23.31s/it] 24%|██▍       | 73/300 [25:15<1:20:34, 21.30s/it] 25%|██▍       | 74/300 [25:43<1:27:32, 23.24s/it] 25%|██▌       | 75/300 [26:10<1:32:25, 24.65s/it] 25%|██▌       | 76/300 [26:30<1:26:26, 23.15s/it] 26%|██▌       | 77/300 [26:41<1:12:41, 19.56s/it] 26%|██▌       | 78/300 [26:56<1:07:22, 18.21s/it] 26%|██▋       | 79/300 [27:09<1:00:38, 16.47s/it] 27%|██▋       | 80/300 [27:37<1:12:52, 19.87s/it] 27%|██▋       | 81/300 [27:57<1:13:34, 20.16s/it] 27%|██▋       | 82/300 [28:15<1:10:32, 19.42s/it] 28%|██▊       | 83/300 [28:31<1:06:28, 18.38s/it] 28%|██▊       | 84/300 [28:59<1:16:13, 21.17s/it] 28%|██▊       | 85/300 [29:16<1:11:19, 19.90s/it] 29%|██▊       | 86/300 [29:37<1:12:10, 20.24s/it] 29%|██▉       | 87/300 [29:54<1:09:07, 19.47s/it] 29%|██▉       | 88/300 [30:22<1:17:33, 21.95s/it] 30%|██▉       | 89/300 [30:46<1:19:07, 22.50s/it] 30%|███       | 90/300 [30:56<1:05:15, 18.64s/it] 30%|███       | 91/300 [31:05<55:17, 15.87s/it]   31%|███       | 92/300 [31:33<1:07:20, 19.42s/it] 31%|███       | 93/300 [32:00<1:15:34, 21.91s/it] 31%|███▏      | 94/300 [32:26<1:19:00, 23.01s/it] 32%|███▏      | 95/300 [32:44<1:13:08, 21.41s/it] 32%|███▏      | 96/300 [32:54<1:01:16, 18.02s/it] 32%|███▏      | 97/300 [33:09<57:42, 17.06s/it]   33%|███▎      | 98/300 [33:19<51:00, 15.15s/it] 33%|███▎      | 99/300 [33:32<48:46, 14.56s/it] 33%|███▎      | 100/300 [33:43<44:54, 13.47s/it] 34%|███▎      | 101/300 [34:18<1:05:29, 19.75s/it] 34%|███▍      | 102/300 [34:45<1:13:06, 22.16s/it] 34%|███▍      | 103/300 [35:02<1:06:44, 20.33s/it] 35%|███▍      | 104/300 [35:25<1:09:39, 21.32s/it] 35%|███▌      | 105/300 [35:35<58:13, 17.92s/it]   35%|███▌      | 106/300 [35:51<56:13, 17.39s/it] 36%|███▌      | 107/300 [36:19<1:05:56, 20.50s/it] 36%|███▌      | 108/300 [36:45<1:10:40, 22.08s/it] 36%|███▋      | 109/300 [36:59<1:02:18, 19.57s/it] 37%|███▋      | 110/300 [37:24<1:07:47, 21.41s/it] 37%|███▋      | 111/300 [37:41<1:03:17, 20.09s/it] 37%|███▋      | 112/300 [38:10<1:10:52, 22.62s/it] 38%|███▊      | 113/300 [38:25<1:03:21, 20.33s/it] 38%|███▊      | 114/300 [38:45<1:03:00, 20.33s/it] 38%|███▊      | 115/300 [39:14<1:10:53, 22.99s/it] 39%|███▊      | 116/300 [39:38<1:10:55, 23.13s/it] 39%|███▉      | 117/300 [39:47<58:05, 19.05s/it]   39%|███▉      | 118/300 [40:15<1:05:37, 21.64s/it] 40%|███▉      | 119/300 [40:35<1:03:35, 21.08s/it] 40%|████      | 120/300 [40:47<54:55, 18.31s/it]   40%|████      | 121/300 [41:00<50:24, 16.90s/it] 41%|████      | 122/300 [41:15<48:06, 16.22s/it] 41%|████      | 123/300 [41:29<45:53, 15.56s/it] 41%|████▏     | 124/300 [41:57<56:32, 19.28s/it] 42%|████▏     | 125/300 [42:26<1:04:32, 22.13s/it] 42%|████▏     | 126/300 [42:40<57:49, 19.94s/it]   42%|████▏     | 127/300 [43:08<1:04:16, 22.29s/it] 43%|████▎     | 128/300 [43:19<53:35, 18.70s/it]   43%|████▎     | 129/300 [43:46<1:01:07, 21.45s/it] 43%|████▎     | 130/300 [44:14<1:06:08, 23.35s/it] 44%|████▎     | 131/300 [44:27<56:36, 20.10s/it]   44%|████▍     | 132/300 [44:54<1:02:40, 22.38s/it] 44%|████▍     | 133/300 [45:08<55:10, 19.82s/it]   45%|████▍     | 134/300 [45:27<53:43, 19.42s/it] 45%|████▌     | 135/300 [45:37<46:08, 16.78s/it] 45%|████▌     | 136/300 [46:05<54:30, 19.94s/it] 46%|████▌     | 137/300 [46:14<45:55, 16.90s/it] 46%|████▌     | 138/300 [46:42<54:28, 20.18s/it] 46%|████▋     | 139/300 [47:11<1:01:23, 22.88s/it] 47%|████▋     | 140/300 [47:26<54:05, 20.29s/it]   47%|████▋     | 141/300 [47:38<47:14, 17.83s/it] 47%|████▋     | 142/300 [47:58<48:56, 18.59s/it] 48%|████▊     | 143/300 [48:08<41:58, 16.04s/it] 48%|████▊     | 144/300 [48:24<41:16, 15.87s/it] 48%|████▊     | 145/300 [48:40<41:14, 15.97s/it] 49%|████▊     | 146/300 [48:59<43:10, 16.82s/it] 49%|████▉     | 147/300 [49:17<44:15, 17.35s/it] 49%|████▉     | 148/300 [49:45<52:01, 20.54s/it] 50%|████▉     | 149/300 [49:57<45:15, 17.99s/it] 50%|█████     | 150/300 [50:11<41:59, 16.80s/it] 50%|█████     | 151/300 [50:39<49:57, 20.12s/it] 51%|█████     | 152/300 [50:48<41:20, 16.76s/it] 51%|█████     | 153/300 [51:03<39:34, 16.15s/it] 51%|█████▏    | 154/300 [51:38<53:19, 21.91s/it] 52%|█████▏    | 155/300 [51:47<43:27, 17.98s/it] 52%|█████▏    | 156/300 [52:04<42:18, 17.63s/it] 52%|█████▏    | 157/300 [52:32<49:22, 20.71s/it] 53%|█████▎    | 158/300 [52:41<40:39, 17.18s/it] 53%|█████▎    | 159/300 [52:51<35:12, 14.98s/it] 53%|█████▎    | 160/300 [53:18<43:52, 18.80s/it] 54%|█████▎    | 161/300 [53:29<38:14, 16.50s/it] 54%|█████▍    | 162/300 [53:38<32:31, 14.14s/it] 54%|█████▍    | 163/300 [54:06<42:04, 18.43s/it] 55%|█████▍    | 164/300 [54:14<34:40, 15.30s/it] 55%|█████▌    | 165/300 [54:32<35:43, 15.88s/it] 55%|█████▌    | 166/300 [54:55<40:32, 18.16s/it] 56%|█████▌    | 167/300 [55:23<46:38, 21.04s/it] 56%|█████▌    | 168/300 [55:34<39:51, 18.12s/it] 56%|█████▋    | 169/300 [56:03<46:17, 21.20s/it] 57%|█████▋    | 170/300 [56:31<50:20, 23.23s/it] 57%|█████▋    | 171/300 [56:49<47:06, 21.91s/it] 57%|█████▋    | 172/300 [57:03<41:06, 19.27s/it] 58%|█████▊    | 173/300 [57:13<35:18, 16.68s/it] 58%|█████▊    | 174/300 [57:41<42:02, 20.02s/it] 58%|█████▊    | 175/300 [58:04<43:39, 20.96s/it] 59%|█████▊    | 176/300 [58:32<47:32, 23.01s/it] 59%|█████▉    | 177/300 [59:00<50:07, 24.45s/it] 59%|█████▉    | 178/300 [59:09<40:14, 19.79s/it] 60%|█████▉    | 179/300 [59:21<35:26, 17.58s/it] 60%|██████    | 180/300 [59:31<30:30, 15.25s/it] 60%|██████    | 181/300 [59:51<32:55, 16.60s/it] 61%|██████    | 182/300 [1:00:02<29:30, 15.00s/it] 61%|██████    | 183/300 [1:00:22<32:13, 16.53s/it] 61%|██████▏   | 184/300 [1:00:39<31:58, 16.54s/it] 62%|██████▏   | 185/300 [1:01:08<38:56, 20.32s/it] 62%|██████▏   | 186/300 [1:01:24<36:21, 19.14s/it] 62%|██████▏   | 187/300 [1:01:52<40:55, 21.73s/it] 63%|██████▎   | 188/300 [1:02:08<37:21, 20.01s/it] 63%|██████▎   | 189/300 [1:02:41<44:30, 24.06s/it] 63%|██████▎   | 190/300 [1:02:52<36:40, 20.00s/it] 64%|██████▎   | 191/300 [1:03:07<33:44, 18.57s/it] 64%|██████▍   | 192/300 [1:03:35<38:21, 21.31s/it] 64%|██████▍   | 193/300 [1:03:59<39:45, 22.30s/it] 65%|██████▍   | 194/300 [1:04:29<43:07, 24.41s/it] 65%|██████▌   | 195/300 [1:04:39<35:24, 20.24s/it] 65%|██████▌   | 196/300 [1:04:51<30:34, 17.63s/it] 66%|██████▌   | 197/300 [1:05:11<31:34, 18.39s/it] 66%|██████▌   | 198/300 [1:05:39<36:09, 21.27s/it] 66%|██████▋   | 199/300 [1:05:49<29:58, 17.81s/it] 67%|██████▋   | 200/300 [1:06:03<27:54, 16.75s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (22166 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [1:06:43<39:09, 23.73s/it] 67%|██████▋   | 202/300 [1:07:07<38:48, 23.76s/it] 68%|██████▊   | 203/300 [1:07:34<40:10, 24.85s/it] 68%|██████▊   | 204/300 [1:07:50<35:33, 22.23s/it] 68%|██████▊   | 205/300 [1:08:25<40:55, 25.85s/it] 69%|██████▊   | 206/300 [1:08:55<42:36, 27.19s/it] 69%|██████▉   | 207/300 [1:09:07<35:18, 22.78s/it] 69%|██████▉   | 208/300 [1:09:17<28:44, 18.75s/it] 70%|██████▉   | 209/300 [1:09:30<25:47, 17.00s/it] 70%|███████   | 210/300 [1:09:55<29:19, 19.55s/it] 70%|███████   | 211/300 [1:10:29<35:32, 23.97s/it] 71%|███████   | 212/300 [1:10:43<30:22, 20.71s/it] 71%|███████   | 213/300 [1:10:55<26:31, 18.29s/it] 71%|███████▏  | 214/300 [1:11:08<23:51, 16.64s/it] 72%|███████▏  | 215/300 [1:11:25<23:49, 16.82s/it] 72%|███████▏  | 216/300 [1:11:38<21:44, 15.53s/it] 72%|███████▏  | 217/300 [1:12:11<28:43, 20.77s/it] 73%|███████▎  | 218/300 [1:12:25<25:36, 18.74s/it] 73%|███████▎  | 219/300 [1:12:43<24:55, 18.46s/it] 73%|███████▎  | 220/300 [1:13:17<30:49, 23.12s/it] 74%|███████▎  | 221/300 [1:13:32<27:29, 20.88s/it] 74%|███████▍  | 222/300 [1:14:00<29:56, 23.04s/it] 74%|███████▍  | 223/300 [1:14:31<32:27, 25.29s/it] 75%|███████▍  | 224/300 [1:15:01<34:02, 26.87s/it] 75%|███████▌  | 225/300 [1:15:16<28:50, 23.08s/it] 75%|███████▌  | 226/300 [1:15:47<31:38, 25.66s/it] 76%|███████▌  | 227/300 [1:16:22<34:22, 28.25s/it] 76%|███████▌  | 228/300 [1:16:47<32:50, 27.37s/it] 76%|███████▋  | 229/300 [1:17:17<33:15, 28.11s/it] 77%|███████▋  | 230/300 [1:17:51<34:57, 29.96s/it] 77%|███████▋  | 231/300 [1:18:14<31:56, 27.77s/it] 77%|███████▋  | 232/300 [1:18:28<26:54, 23.74s/it] 78%|███████▊  | 233/300 [1:18:44<23:44, 21.27s/it] 78%|███████▊  | 234/300 [1:19:16<27:02, 24.58s/it] 78%|███████▊  | 235/300 [1:19:40<26:21, 24.34s/it] 79%|███████▊  | 236/300 [1:19:51<21:50, 20.48s/it] 79%|███████▉  | 237/300 [1:20:26<25:55, 24.70s/it] 79%|███████▉  | 238/300 [1:20:43<23:23, 22.64s/it] 80%|███████▉  | 239/300 [1:20:59<20:51, 20.52s/it] 80%|████████  | 240/300 [1:21:21<20:55, 20.92s/it] 80%|████████  | 241/300 [1:21:46<21:41, 22.06s/it] 81%|████████  | 242/300 [1:22:00<19:10, 19.84s/it] 81%|████████  | 243/300 [1:22:33<22:33, 23.74s/it] 81%|████████▏ | 244/300 [1:22:51<20:23, 21.85s/it] 82%|████████▏ | 245/300 [1:23:09<19:11, 20.93s/it] 82%|████████▏ | 246/300 [1:23:25<17:19, 19.25s/it] 82%|████████▏ | 247/300 [1:23:38<15:22, 17.40s/it] 83%|████████▎ | 248/300 [1:23:48<13:05, 15.10s/it] 83%|████████▎ | 249/300 [1:24:07<13:58, 16.45s/it] 83%|████████▎ | 250/300 [1:24:37<17:04, 20.50s/it] 84%|████████▎ | 251/300 [1:25:12<20:14, 24.79s/it] 84%|████████▍ | 252/300 [1:25:33<19:01, 23.78s/it] 84%|████████▍ | 253/300 [1:25:48<16:26, 20.99s/it] 85%|████████▍ | 254/300 [1:26:06<15:32, 20.28s/it] 85%|████████▌ | 255/300 [1:26:39<17:56, 23.93s/it] 85%|████████▌ | 256/300 [1:27:06<18:10, 24.79s/it] 86%|████████▌ | 257/300 [1:27:22<15:58, 22.29s/it] 86%|████████▌ | 258/300 [1:27:42<15:03, 21.52s/it] 86%|████████▋ | 259/300 [1:28:02<14:22, 21.03s/it] 87%|████████▋ | 260/300 [1:28:36<16:41, 25.04s/it] 87%|████████▋ | 261/300 [1:28:51<14:22, 22.12s/it] 87%|████████▋ | 262/300 [1:29:09<13:11, 20.82s/it] 88%|████████▊ | 263/300 [1:29:38<14:15, 23.13s/it] 88%|████████▊ | 264/300 [1:29:49<11:42, 19.50s/it] 88%|████████▊ | 265/300 [1:30:07<11:07, 19.07s/it] 89%|████████▊ | 266/300 [1:30:26<10:47, 19.04s/it] 89%|████████▉ | 267/300 [1:30:53<11:48, 21.48s/it] 89%|████████▉ | 268/300 [1:31:03<09:39, 18.12s/it] 90%|████████▉ | 269/300 [1:31:14<08:13, 15.92s/it] 90%|█████████ | 270/300 [1:31:39<09:19, 18.66s/it] 90%|█████████ | 271/300 [1:32:05<10:02, 20.79s/it] 91%|█████████ | 272/300 [1:32:33<10:42, 22.94s/it] 91%|█████████ | 273/300 [1:33:05<11:31, 25.61s/it] 91%|█████████▏| 274/300 [1:33:26<10:29, 24.22s/it] 92%|█████████▏| 275/300 [1:33:36<08:19, 19.99s/it] 92%|█████████▏| 276/300 [1:33:48<07:05, 17.71s/it] 92%|█████████▏| 277/300 [1:34:03<06:27, 16.84s/it] 93%|█████████▎| 278/300 [1:34:21<06:15, 17.09s/it] 93%|█████████▎| 279/300 [1:34:44<06:37, 18.91s/it] 93%|█████████▎| 280/300 [1:35:06<06:39, 19.95s/it] 94%|█████████▎| 281/300 [1:35:16<05:22, 16.99s/it] 94%|█████████▍| 282/300 [1:35:51<06:39, 22.20s/it] 94%|█████████▍| 283/300 [1:36:04<05:32, 19.57s/it] 95%|█████████▍| 284/300 [1:36:16<04:36, 17.25s/it] 95%|█████████▌| 285/300 [1:36:49<05:29, 21.98s/it] 95%|█████████▌| 286/300 [1:37:11<05:08, 22.00s/it] 96%|█████████▌| 287/300 [1:37:23<04:05, 18.90s/it] 96%|█████████▌| 288/300 [1:37:55<04:33, 22.82s/it] 96%|█████████▋| 289/300 [1:38:29<04:48, 26.26s/it] 97%|█████████▋| 290/300 [1:38:58<04:31, 27.17s/it] 97%|█████████▋| 291/300 [1:39:09<03:21, 22.41s/it] 97%|█████████▋| 292/300 [1:39:37<03:10, 23.84s/it] 98%|█████████▊| 293/300 [1:39:51<02:27, 21.04s/it] 98%|█████████▊| 294/300 [1:40:07<01:56, 19.37s/it] 98%|█████████▊| 295/300 [1:40:26<01:37, 19.43s/it] 99%|█████████▊| 296/300 [1:40:55<01:28, 22.14s/it] 99%|█████████▉| 297/300 [1:41:03<00:53, 17.91s/it] 99%|█████████▉| 298/300 [1:41:16<00:33, 16.54s/it]100%|█████████▉| 299/300 [1:41:49<00:21, 21.59s/it]100%|██████████| 300/300 [1:42:19<00:00, 24.14s/it]100%|██████████| 300/300 [1:42:20<00:00, 20.47s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:08<00:26,  8.69s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:17<00:17,  8.58s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:26<00:08,  8.71s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:32<00:00,  7.64s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:32<00:00,  8.01s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:38<3:10:48, 38.29s/it]  1%|          | 2/300 [01:08<2:45:57, 33.41s/it]  1%|          | 3/300 [01:29<2:17:44, 27.83s/it]  1%|▏         | 4/300 [02:01<2:25:43, 29.54s/it]  2%|▏         | 5/300 [02:35<2:32:27, 31.01s/it]  2%|▏         | 6/300 [02:58<2:18:23, 28.24s/it]  2%|▏         | 7/300 [03:30<2:24:19, 29.55s/it]  3%|▎         | 8/300 [03:55<2:17:03, 28.16s/it]  3%|▎         | 9/300 [04:27<2:22:48, 29.44s/it]  3%|▎         | 10/300 [04:58<2:24:21, 29.87s/it]  4%|▎         | 11/300 [05:14<2:03:01, 25.54s/it]  4%|▍         | 12/300 [05:44<2:08:47, 26.83s/it]  4%|▍         | 13/300 [05:56<1:47:54, 22.56s/it]  5%|▍         | 14/300 [06:29<2:01:24, 25.47s/it]  5%|▌         | 15/300 [06:43<1:45:42, 22.25s/it]  5%|▌         | 16/300 [07:00<1:37:15, 20.55s/it]  6%|▌         | 17/300 [07:20<1:35:33, 20.26s/it]  6%|▌         | 18/300 [07:52<1:52:02, 23.84s/it]  6%|▋         | 19/300 [08:16<1:51:53, 23.89s/it]  7%|▋         | 20/300 [08:48<2:03:12, 26.40s/it]  7%|▋         | 21/300 [09:20<2:10:57, 28.16s/it]  7%|▋         | 22/300 [09:53<2:16:13, 29.40s/it]  8%|▊         | 23/300 [10:25<2:19:42, 30.26s/it]  8%|▊         | 24/300 [10:57<2:21:49, 30.83s/it]  8%|▊         | 25/300 [11:25<2:17:36, 30.02s/it]  9%|▊         | 26/300 [11:57<2:19:58, 30.65s/it]  9%|▉         | 27/300 [12:28<2:19:22, 30.63s/it]  9%|▉         | 28/300 [12:58<2:18:30, 30.55s/it] 10%|▉         | 29/300 [13:26<2:14:53, 29.87s/it] 10%|█         | 30/300 [13:55<2:12:34, 29.46s/it] 10%|█         | 31/300 [14:21<2:06:53, 28.30s/it] 11%|█         | 32/300 [14:44<2:00:28, 26.97s/it] 11%|█         | 33/300 [15:07<1:54:45, 25.79s/it] 11%|█▏        | 34/300 [15:40<2:02:57, 27.74s/it] 12%|█▏        | 35/300 [16:03<1:56:15, 26.32s/it] 12%|█▏        | 36/300 [16:35<2:03:30, 28.07s/it] 12%|█▏        | 37/300 [16:50<1:46:19, 24.26s/it] 13%|█▎        | 38/300 [17:21<1:54:57, 26.33s/it] 13%|█▎        | 39/300 [17:52<2:00:20, 27.67s/it] 13%|█▎        | 40/300 [18:11<1:47:51, 24.89s/it] 14%|█▎        | 41/300 [18:34<1:46:00, 24.56s/it] 14%|█▍        | 42/300 [19:02<1:50:03, 25.60s/it] 14%|█▍        | 43/300 [19:25<1:45:31, 24.63s/it] 15%|█▍        | 44/300 [19:40<1:32:49, 21.76s/it] 15%|█▌        | 45/300 [20:12<1:45:34, 24.84s/it] 15%|█▌        | 46/300 [20:37<1:45:24, 24.90s/it] 16%|█▌        | 47/300 [21:03<1:46:04, 25.16s/it] 16%|█▌        | 48/300 [21:35<1:54:14, 27.20s/it] 16%|█▋        | 49/300 [21:53<1:42:42, 24.55s/it] 17%|█▋        | 50/300 [22:24<1:50:10, 26.44s/it] 17%|█▋        | 51/300 [22:49<1:47:37, 25.93s/it] 17%|█▋        | 52/300 [23:10<1:41:40, 24.60s/it] 18%|█▊        | 53/300 [23:26<1:30:35, 22.01s/it] 18%|█▊        | 54/300 [23:58<1:42:30, 25.00s/it] 18%|█▊        | 55/300 [24:30<1:50:43, 27.12s/it] 19%|█▊        | 56/300 [24:58<1:51:10, 27.34s/it] 19%|█▉        | 57/300 [25:30<1:56:25, 28.75s/it] 19%|█▉        | 58/300 [25:58<1:54:42, 28.44s/it] 20%|█▉        | 59/300 [26:30<1:58:36, 29.53s/it] 20%|██        | 60/300 [26:56<1:53:31, 28.38s/it] 20%|██        | 61/300 [27:20<1:48:43, 27.30s/it] 21%|██        | 62/300 [27:39<1:37:49, 24.66s/it] 21%|██        | 63/300 [28:11<1:46:09, 26.87s/it] 21%|██▏       | 64/300 [28:34<1:41:12, 25.73s/it] 22%|██▏       | 65/300 [29:04<1:46:01, 27.07s/it] 22%|██▏       | 66/300 [29:36<1:51:21, 28.55s/it] 22%|██▏       | 67/300 [30:08<1:54:56, 29.60s/it] 23%|██▎       | 68/300 [30:40<1:57:13, 30.32s/it] 23%|██▎       | 69/300 [31:08<1:54:01, 29.62s/it] 23%|██▎       | 70/300 [31:34<1:48:43, 28.36s/it] 24%|██▎       | 71/300 [31:55<1:40:29, 26.33s/it] 24%|██▍       | 72/300 [32:02<1:18:18, 20.61s/it] 24%|██▍       | 73/300 [32:34<1:30:53, 24.02s/it] 25%|██▍       | 74/300 [33:03<1:35:12, 25.28s/it] 25%|██▌       | 75/300 [33:35<1:42:27, 27.32s/it] 25%|██▌       | 76/300 [34:01<1:40:49, 27.01s/it] 26%|██▌       | 77/300 [34:33<1:45:59, 28.52s/it] 26%|██▌       | 78/300 [34:47<1:29:31, 24.19s/it] 26%|██▋       | 79/300 [35:19<1:37:50, 26.56s/it] 27%|██▋       | 80/300 [35:36<1:26:41, 23.64s/it] 27%|██▋       | 81/300 [35:58<1:24:26, 23.14s/it] 27%|██▋       | 82/300 [36:28<1:31:55, 25.30s/it] 28%|██▊       | 83/300 [36:46<1:23:40, 23.14s/it] 28%|██▊       | 84/300 [37:13<1:26:33, 24.04s/it] 28%|██▊       | 85/300 [37:33<1:22:12, 22.94s/it] 29%|██▊       | 86/300 [38:05<1:31:31, 25.66s/it] 29%|██▉       | 87/300 [38:29<1:29:24, 25.19s/it] 29%|██▉       | 88/300 [39:01<1:36:17, 27.25s/it] 30%|██▉       | 89/300 [39:27<1:34:26, 26.85s/it] 30%|███       | 90/300 [39:58<1:38:30, 28.14s/it] 30%|███       | 91/300 [40:30<1:42:04, 29.30s/it] 31%|███       | 92/300 [41:02<1:44:19, 30.09s/it] 31%|███       | 93/300 [41:32<1:43:54, 30.12s/it] 31%|███▏      | 94/300 [41:49<1:29:34, 26.09s/it] 32%|███▏      | 95/300 [42:13<1:27:27, 25.60s/it] 32%|███▏      | 96/300 [42:38<1:26:04, 25.31s/it] 32%|███▏      | 97/300 [43:09<1:31:26, 27.03s/it] 33%|███▎      | 98/300 [43:29<1:24:03, 24.97s/it] 33%|███▎      | 99/300 [43:51<1:20:33, 24.05s/it] 33%|███▎      | 100/300 [44:23<1:27:59, 26.40s/it] 34%|███▎      | 101/300 [45:02<1:39:41, 30.06s/it] 34%|███▍      | 102/300 [45:27<1:34:35, 28.66s/it] 34%|███▍      | 103/300 [45:59<1:37:15, 29.62s/it] 35%|███▍      | 104/300 [46:31<1:39:02, 30.32s/it] 35%|███▌      | 105/300 [47:05<1:42:38, 31.58s/it] 35%|███▌      | 106/300 [47:28<1:33:35, 28.94s/it] 36%|███▌      | 107/300 [47:59<1:34:52, 29.49s/it] 36%|███▌      | 108/300 [48:25<1:31:04, 28.46s/it] 36%|███▋      | 109/300 [48:52<1:29:37, 28.15s/it] 37%|███▋      | 110/300 [49:16<1:24:34, 26.71s/it] 37%|███▋      | 111/300 [49:41<1:22:49, 26.29s/it] 37%|███▋      | 112/300 [50:13<1:27:55, 28.06s/it] 38%|███▊      | 113/300 [50:46<1:32:15, 29.60s/it] 38%|███▊      | 114/300 [51:04<1:20:53, 26.09s/it] 38%|███▊      | 115/300 [51:27<1:16:48, 24.91s/it] 39%|███▊      | 116/300 [51:59<1:23:37, 27.27s/it] 39%|███▉      | 117/300 [52:25<1:21:16, 26.65s/it] 39%|███▉      | 118/300 [52:57<1:25:42, 28.25s/it] 40%|███▉      | 119/300 [53:29<1:29:13, 29.58s/it] 40%|████      | 120/300 [53:46<1:17:03, 25.69s/it] 40%|████      | 121/300 [54:05<1:11:15, 23.89s/it] 41%|████      | 122/300 [54:35<1:16:17, 25.72s/it] 41%|████      | 123/300 [55:03<1:17:19, 26.21s/it] 41%|████▏     | 124/300 [55:29<1:17:11, 26.32s/it] 42%|████▏     | 125/300 [55:48<1:09:42, 23.90s/it] 42%|████▏     | 126/300 [56:13<1:10:42, 24.38s/it] 42%|████▏     | 127/300 [56:45<1:16:55, 26.68s/it] 43%|████▎     | 128/300 [57:12<1:16:57, 26.85s/it] 43%|████▎     | 129/300 [57:45<1:21:00, 28.43s/it] 43%|████▎     | 130/300 [58:11<1:18:37, 27.75s/it] 44%|████▎     | 131/300 [58:34<1:14:47, 26.56s/it] 44%|████▍     | 132/300 [59:06<1:18:49, 28.15s/it] 44%|████▍     | 133/300 [59:34<1:18:01, 28.03s/it] 45%|████▍     | 134/300 [1:00:01<1:16:25, 27.63s/it] 45%|████▌     | 135/300 [1:00:31<1:18:08, 28.41s/it] 45%|████▌     | 136/300 [1:01:01<1:18:59, 28.90s/it] 46%|████▌     | 137/300 [1:01:12<1:03:29, 23.37s/it] 46%|████▌     | 138/300 [1:01:39<1:06:15, 24.54s/it] 46%|████▋     | 139/300 [1:02:11<1:11:46, 26.75s/it] 47%|████▋     | 140/300 [1:02:43<1:15:50, 28.44s/it] 47%|████▋     | 141/300 [1:03:14<1:16:58, 29.05s/it] 47%|████▋     | 142/300 [1:03:43<1:16:54, 29.21s/it] 48%|████▊     | 143/300 [1:04:03<1:09:11, 26.44s/it] 48%|████▊     | 144/300 [1:04:24<1:04:38, 24.86s/it] 48%|████▊     | 145/300 [1:04:45<1:01:17, 23.73s/it] 49%|████▊     | 146/300 [1:05:13<1:03:32, 24.76s/it] 49%|████▉     | 147/300 [1:05:31<58:27, 22.93s/it]   49%|████▉     | 148/300 [1:05:57<1:00:25, 23.85s/it] 50%|████▉     | 149/300 [1:06:22<1:00:58, 24.23s/it] 50%|█████     | 150/300 [1:06:45<59:35, 23.84s/it]   50%|█████     | 151/300 [1:07:10<1:00:06, 24.21s/it] 51%|█████     | 152/300 [1:07:33<58:36, 23.76s/it]   51%|█████     | 153/300 [1:07:56<57:43, 23.56s/it] 51%|█████▏    | 154/300 [1:08:20<57:16, 23.54s/it] 52%|█████▏    | 155/300 [1:08:48<1:00:42, 25.12s/it] 52%|█████▏    | 156/300 [1:09:13<1:00:03, 25.03s/it] 52%|█████▏    | 157/300 [1:09:45<1:04:35, 27.10s/it] 53%|█████▎    | 158/300 [1:10:11<1:03:10, 26.69s/it] 53%|█████▎    | 159/300 [1:10:34<1:00:01, 25.54s/it] 53%|█████▎    | 160/300 [1:11:04<1:02:31, 26.80s/it] 54%|█████▎    | 161/300 [1:11:25<58:10, 25.11s/it]   54%|█████▍    | 162/300 [1:11:49<57:17, 24.91s/it] 54%|█████▍    | 163/300 [1:12:15<57:31, 25.20s/it] 55%|█████▍    | 164/300 [1:12:44<59:39, 26.32s/it] 55%|█████▌    | 165/300 [1:13:06<56:36, 25.16s/it] 55%|█████▌    | 166/300 [1:13:39<1:01:12, 27.41s/it] 56%|█████▌    | 167/300 [1:13:59<55:59, 25.26s/it]   56%|█████▌    | 168/300 [1:14:17<50:26, 22.93s/it] 56%|█████▋    | 169/300 [1:14:45<53:20, 24.43s/it] 57%|█████▋    | 170/300 [1:15:17<57:49, 26.69s/it] 57%|█████▋    | 171/300 [1:15:40<55:27, 25.80s/it] 57%|█████▋    | 172/300 [1:15:59<50:36, 23.72s/it] 58%|█████▊    | 173/300 [1:16:25<51:42, 24.43s/it] 58%|█████▊    | 174/300 [1:16:52<52:56, 25.21s/it] 58%|█████▊    | 175/300 [1:17:18<52:41, 25.30s/it] 59%|█████▊    | 176/300 [1:17:48<55:21, 26.79s/it] 59%|█████▉    | 177/300 [1:18:19<57:13, 27.92s/it] 59%|█████▉    | 178/300 [1:18:51<59:21, 29.19s/it] 60%|█████▉    | 179/300 [1:19:20<58:46, 29.14s/it] 60%|██████    | 180/300 [1:19:39<52:18, 26.15s/it] 60%|██████    | 181/300 [1:19:57<47:14, 23.82s/it] 61%|██████    | 182/300 [1:20:29<51:31, 26.20s/it] 61%|██████    | 183/300 [1:20:59<53:09, 27.26s/it] 61%|██████▏   | 184/300 [1:21:24<51:20, 26.55s/it] 62%|██████▏   | 185/300 [1:21:53<52:15, 27.26s/it] 62%|██████▏   | 186/300 [1:22:12<47:00, 24.74s/it] 62%|██████▏   | 187/300 [1:22:43<50:11, 26.65s/it] 63%|██████▎   | 188/300 [1:23:13<51:36, 27.65s/it] 63%|██████▎   | 189/300 [1:23:40<50:58, 27.55s/it] 63%|██████▎   | 190/300 [1:23:59<45:38, 24.90s/it] 64%|██████▎   | 191/300 [1:24:26<46:45, 25.74s/it] 64%|██████▍   | 192/300 [1:24:58<49:34, 27.54s/it] 64%|██████▍   | 193/300 [1:25:22<47:22, 26.57s/it] 65%|██████▍   | 194/300 [1:25:50<47:30, 26.90s/it] 65%|██████▌   | 195/300 [1:26:22<49:50, 28.48s/it] 65%|██████▌   | 196/300 [1:26:47<47:21, 27.32s/it] 66%|██████▌   | 197/300 [1:27:19<49:13, 28.67s/it] 66%|██████▌   | 198/300 [1:27:51<50:21, 29.63s/it] 66%|██████▋   | 199/300 [1:28:23<51:02, 30.32s/it] 67%|██████▋   | 200/300 [1:28:47<47:41, 28.62s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (22166 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [1:29:17<47:55, 29.05s/it] 67%|██████▋   | 202/300 [1:29:55<51:32, 31.55s/it] 68%|██████▊   | 203/300 [1:30:24<49:49, 30.82s/it] 68%|██████▊   | 204/300 [1:31:00<51:49, 32.39s/it] 68%|██████▊   | 205/300 [1:31:39<54:17, 34.29s/it] 69%|██████▊   | 206/300 [1:32:10<52:26, 33.47s/it] 69%|██████▉   | 207/300 [1:32:32<46:41, 30.13s/it] 69%|██████▉   | 208/300 [1:32:55<42:30, 27.72s/it] 70%|██████▉   | 209/300 [1:33:15<38:49, 25.60s/it] 70%|███████   | 210/300 [1:33:48<41:47, 27.87s/it] 70%|███████   | 211/300 [1:34:15<40:56, 27.60s/it] 71%|███████   | 212/300 [1:34:54<45:13, 30.84s/it] 71%|███████   | 213/300 [1:35:20<42:34, 29.36s/it] 71%|███████▏  | 214/300 [1:35:42<39:10, 27.33s/it] 72%|███████▏  | 215/300 [1:35:57<33:23, 23.57s/it] 72%|███████▏  | 216/300 [1:36:08<27:41, 19.78s/it] 72%|███████▏  | 217/300 [1:36:24<25:48, 18.66s/it] 73%|███████▎  | 218/300 [1:37:01<32:59, 24.14s/it] 73%|███████▎  | 219/300 [1:37:22<31:26, 23.29s/it] 73%|███████▎  | 220/300 [1:37:55<34:59, 26.24s/it] 74%|███████▎  | 221/300 [1:38:23<34:55, 26.53s/it] 74%|███████▍  | 222/300 [1:38:47<33:36, 25.85s/it] 74%|███████▍  | 223/300 [1:39:16<34:16, 26.70s/it] 75%|███████▍  | 224/300 [1:39:29<28:47, 22.74s/it] 75%|███████▌  | 225/300 [1:39:42<24:46, 19.82s/it] 75%|███████▌  | 226/300 [1:40:12<28:02, 22.74s/it] 76%|███████▌  | 227/300 [1:40:44<31:18, 25.74s/it] 76%|███████▌  | 228/300 [1:41:13<31:59, 26.66s/it] 76%|███████▋  | 229/300 [1:41:34<29:37, 25.04s/it] 77%|███████▋  | 230/300 [1:42:02<29:56, 25.67s/it] 77%|███████▋  | 231/300 [1:42:28<29:50, 25.96s/it] 77%|███████▋  | 232/300 [1:43:04<32:38, 28.80s/it] 78%|███████▊  | 233/300 [1:43:39<34:23, 30.79s/it] 78%|███████▊  | 234/300 [1:44:09<33:26, 30.40s/it] 78%|███████▊  | 235/300 [1:44:36<32:06, 29.64s/it] 79%|███████▊  | 236/300 [1:45:10<32:44, 30.70s/it] 79%|███████▉  | 237/300 [1:45:34<30:24, 28.96s/it] 79%|███████▉  | 238/300 [1:45:49<25:34, 24.75s/it] 80%|███████▉  | 239/300 [1:46:16<25:48, 25.38s/it] 80%|████████  | 240/300 [1:46:43<25:43, 25.72s/it] 80%|████████  | 241/300 [1:47:21<29:02, 29.53s/it] 81%|████████  | 242/300 [1:47:50<28:28, 29.46s/it] 81%|████████  | 243/300 [1:48:18<27:23, 28.83s/it] 81%|████████▏ | 244/300 [1:48:51<28:11, 30.21s/it] 82%|████████▏ | 245/300 [1:49:26<29:03, 31.69s/it] 82%|████████▏ | 246/300 [1:50:03<29:46, 33.09s/it] 82%|████████▏ | 247/300 [1:50:38<29:47, 33.73s/it] 83%|████████▎ | 248/300 [1:51:07<28:07, 32.45s/it] 83%|████████▎ | 249/300 [1:51:35<26:25, 31.08s/it] 83%|████████▎ | 250/300 [1:52:09<26:38, 31.96s/it] 84%|████████▎ | 251/300 [1:52:39<25:25, 31.13s/it] 84%|████████▍ | 252/300 [1:53:11<25:12, 31.51s/it] 84%|████████▍ | 253/300 [1:53:37<23:22, 29.84s/it] 85%|████████▍ | 254/300 [1:53:59<21:03, 27.46s/it] 85%|████████▌ | 255/300 [1:54:34<22:23, 29.86s/it] 85%|████████▌ | 256/300 [1:55:03<21:36, 29.47s/it] 86%|████████▌ | 257/300 [1:55:34<21:29, 29.98s/it] 86%|████████▌ | 258/300 [1:56:04<20:59, 30.00s/it] 86%|████████▋ | 259/300 [1:56:42<22:12, 32.50s/it] 87%|████████▋ | 260/300 [1:57:10<20:36, 30.90s/it] 87%|████████▋ | 261/300 [1:57:38<19:39, 30.23s/it] 87%|████████▋ | 262/300 [1:58:12<19:46, 31.23s/it] 88%|████████▊ | 263/300 [1:58:38<18:25, 29.88s/it] 88%|████████▊ | 264/300 [1:58:58<16:07, 26.86s/it] 88%|████████▊ | 265/300 [1:59:27<16:00, 27.45s/it] 89%|████████▊ | 266/300 [1:59:59<16:13, 28.64s/it] 89%|████████▉ | 267/300 [2:00:37<17:21, 31.55s/it] 89%|████████▉ | 268/300 [2:00:57<14:56, 28.03s/it] 90%|████████▉ | 269/300 [2:01:21<13:53, 26.88s/it] 90%|█████████ | 270/300 [2:01:50<13:44, 27.48s/it] 90%|█████████ | 271/300 [2:02:13<12:38, 26.15s/it] 91%|█████████ | 272/300 [2:02:47<13:20, 28.59s/it] 91%|█████████ | 273/300 [2:03:23<13:48, 30.69s/it] 91%|█████████▏| 274/300 [2:03:45<12:08, 28.03s/it] 92%|█████████▏| 275/300 [2:03:56<09:34, 22.98s/it] 92%|█████████▏| 276/300 [2:04:16<08:50, 22.12s/it] 92%|█████████▏| 277/300 [2:04:47<09:29, 24.78s/it] 93%|█████████▎| 278/300 [2:05:17<09:42, 26.50s/it] 93%|█████████▎| 279/300 [2:05:56<10:32, 30.10s/it] 93%|█████████▎| 280/300 [2:06:19<09:20, 28.00s/it] 94%|█████████▎| 281/300 [2:06:38<08:03, 25.44s/it] 94%|█████████▍| 282/300 [2:07:16<08:42, 29.00s/it] 94%|█████████▍| 283/300 [2:07:46<08:17, 29.25s/it] 95%|█████████▍| 284/300 [2:08:08<07:14, 27.13s/it] 95%|█████████▌| 285/300 [2:08:37<06:57, 27.84s/it] 95%|█████████▌| 286/300 [2:09:12<06:59, 29.99s/it] 96%|█████████▌| 287/300 [2:09:49<06:56, 32.04s/it] 96%|█████████▌| 288/300 [2:10:16<06:07, 30.64s/it] 96%|█████████▋| 289/300 [2:10:43<05:22, 29.33s/it] 97%|█████████▋| 290/300 [2:11:06<04:36, 27.64s/it] 97%|█████████▋| 291/300 [2:11:25<03:44, 24.97s/it] 97%|█████████▋| 292/300 [2:12:04<03:52, 29.08s/it] 98%|█████████▊| 293/300 [2:12:30<03:17, 28.19s/it] 98%|█████████▊| 294/300 [2:13:04<02:59, 29.86s/it] 98%|█████████▊| 295/300 [2:13:38<02:35, 31.19s/it] 99%|█████████▊| 296/300 [2:14:16<02:12, 33.19s/it] 99%|█████████▉| 297/300 [2:14:47<01:38, 32.72s/it] 99%|█████████▉| 298/300 [2:15:14<01:01, 30.99s/it]100%|█████████▉| 299/300 [2:15:48<00:31, 31.87s/it]100%|██████████| 300/300 [2:16:22<00:00, 32.47s/it]100%|██████████| 300/300 [2:16:22<00:00, 27.28s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:08<00:25,  8.56s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:17<00:17,  8.61s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:25<00:08,  8.67s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:31<00:00,  7.57s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:31<00:00,  7.96s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:40<3:22:34, 40.65s/it]  1%|          | 2/300 [01:13<2:58:00, 35.84s/it]  1%|          | 3/300 [01:32<2:20:51, 28.46s/it]  1%|▏         | 4/300 [01:49<1:57:40, 23.85s/it]  2%|▏         | 5/300 [02:04<1:41:42, 20.69s/it]  2%|▏         | 6/300 [02:31<1:52:16, 22.91s/it]  2%|▏         | 7/300 [03:07<2:12:19, 27.10s/it]  3%|▎         | 8/300 [03:43<2:25:11, 29.84s/it]  3%|▎         | 9/300 [04:10<2:21:13, 29.12s/it]  3%|▎         | 10/300 [04:33<2:10:55, 27.09s/it]  4%|▎         | 11/300 [05:04<2:16:48, 28.40s/it]  4%|▍         | 12/300 [05:31<2:13:53, 27.89s/it]  4%|▍         | 13/300 [05:49<1:59:41, 25.02s/it]  5%|▍         | 14/300 [06:19<2:05:45, 26.38s/it]  5%|▌         | 15/300 [06:33<1:47:31, 22.64s/it]  5%|▌         | 16/300 [07:00<1:53:07, 23.90s/it]  6%|▌         | 17/300 [07:23<1:51:34, 23.65s/it]  6%|▌         | 18/300 [07:49<1:55:07, 24.50s/it]  6%|▋         | 19/300 [08:14<1:55:10, 24.59s/it]  7%|▋         | 20/300 [08:44<2:02:04, 26.16s/it]  7%|▋         | 21/300 [09:15<2:08:56, 27.73s/it]  7%|▋         | 22/300 [09:39<2:02:58, 26.54s/it]  8%|▊         | 23/300 [10:15<2:15:14, 29.29s/it]  8%|▊         | 24/300 [10:50<2:23:26, 31.18s/it]  8%|▊         | 25/300 [11:13<2:11:37, 28.72s/it]  9%|▊         | 26/300 [11:37<2:04:01, 27.16s/it]  9%|▉         | 27/300 [11:58<1:55:19, 25.35s/it]  9%|▉         | 28/300 [12:27<1:59:44, 26.41s/it] 10%|▉         | 29/300 [12:47<1:51:21, 24.65s/it] 10%|█         | 30/300 [13:11<1:50:01, 24.45s/it] 10%|█         | 31/300 [13:25<1:34:28, 21.07s/it] 11%|█         | 32/300 [13:48<1:37:03, 21.73s/it] 11%|█         | 33/300 [14:05<1:30:42, 20.39s/it] 11%|█▏        | 34/300 [14:35<1:43:41, 23.39s/it] 12%|█▏        | 35/300 [14:55<1:37:50, 22.15s/it] 12%|█▏        | 36/300 [15:19<1:39:51, 22.69s/it] 12%|█▏        | 37/300 [15:28<1:22:07, 18.74s/it] 13%|█▎        | 38/300 [16:01<1:40:39, 23.05s/it] 13%|█▎        | 39/300 [16:31<1:49:26, 25.16s/it] 13%|█▎        | 40/300 [16:52<1:43:24, 23.86s/it] 14%|█▎        | 41/300 [17:13<1:39:22, 23.02s/it] 14%|█▍        | 42/300 [17:34<1:36:25, 22.43s/it] 14%|█▍        | 43/300 [18:02<1:42:32, 23.94s/it] 15%|█▍        | 44/300 [18:20<1:35:12, 22.31s/it] 15%|█▌        | 45/300 [18:54<1:49:27, 25.76s/it] 15%|█▌        | 46/300 [19:16<1:44:17, 24.64s/it] 16%|█▌        | 47/300 [19:30<1:30:41, 21.51s/it] 16%|█▌        | 48/300 [20:04<1:45:51, 25.21s/it] 16%|█▋        | 49/300 [20:32<1:48:06, 25.84s/it] 17%|█▋        | 50/300 [21:00<1:50:42, 26.57s/it] 17%|█▋        | 51/300 [21:24<1:47:02, 25.79s/it] 17%|█▋        | 52/300 [21:34<1:27:13, 21.10s/it] 18%|█▊        | 53/300 [22:00<1:33:25, 22.69s/it] 18%|█▊        | 54/300 [22:20<1:28:55, 21.69s/it] 18%|█▊        | 55/300 [22:48<1:37:06, 23.78s/it] 19%|█▊        | 56/300 [23:15<1:40:30, 24.71s/it] 19%|█▉        | 57/300 [23:41<1:41:09, 24.98s/it] 19%|█▉        | 58/300 [24:06<1:40:30, 24.92s/it] 20%|█▉        | 59/300 [24:37<1:48:20, 26.97s/it] 20%|██        | 60/300 [25:09<1:53:26, 28.36s/it] 20%|██        | 61/300 [25:45<2:02:21, 30.72s/it] 21%|██        | 62/300 [26:09<1:53:50, 28.70s/it] 21%|██        | 63/300 [26:35<1:50:12, 27.90s/it] 21%|██▏       | 64/300 [27:01<1:46:58, 27.20s/it] 22%|██▏       | 65/300 [27:31<1:50:22, 28.18s/it] 22%|██▏       | 66/300 [27:54<1:43:54, 26.64s/it] 22%|██▏       | 67/300 [28:23<1:45:59, 27.29s/it] 23%|██▎       | 68/300 [29:00<1:56:25, 30.11s/it] 23%|██▎       | 69/300 [29:28<1:53:56, 29.60s/it] 23%|██▎       | 70/300 [30:00<1:56:32, 30.40s/it] 24%|██▎       | 71/300 [30:24<1:48:28, 28.42s/it] 24%|██▍       | 72/300 [30:55<1:50:38, 29.12s/it] 24%|██▍       | 73/300 [31:23<1:49:21, 28.91s/it] 25%|██▍       | 74/300 [31:52<1:48:26, 28.79s/it] 25%|██▌       | 75/300 [32:20<1:47:18, 28.61s/it] 25%|██▌       | 76/300 [32:38<1:35:17, 25.53s/it] 26%|██▌       | 77/300 [33:14<1:46:10, 28.57s/it] 26%|██▌       | 78/300 [33:35<1:37:06, 26.25s/it] 26%|██▋       | 79/300 [34:04<1:40:00, 27.15s/it] 27%|██▋       | 80/300 [34:35<1:43:42, 28.29s/it] 27%|██▋       | 81/300 [34:53<1:32:00, 25.21s/it] 27%|██▋       | 82/300 [35:24<1:37:54, 26.95s/it] 28%|██▊       | 83/300 [35:49<1:35:22, 26.37s/it] 28%|██▊       | 84/300 [36:17<1:36:54, 26.92s/it] 28%|██▊       | 85/300 [36:42<1:33:52, 26.20s/it] 29%|██▊       | 86/300 [37:10<1:35:14, 26.70s/it] 29%|██▉       | 87/300 [37:33<1:31:18, 25.72s/it] 29%|██▉       | 88/300 [37:52<1:23:46, 23.71s/it] 30%|██▉       | 89/300 [38:16<1:23:34, 23.76s/it] 30%|███       | 90/300 [38:39<1:21:51, 23.39s/it] 30%|███       | 91/300 [39:01<1:20:23, 23.08s/it] 31%|███       | 92/300 [39:36<1:32:12, 26.60s/it] 31%|███       | 93/300 [39:55<1:24:20, 24.44s/it] 31%|███▏      | 94/300 [40:19<1:23:35, 24.35s/it] 32%|███▏      | 95/300 [40:44<1:23:28, 24.43s/it] 32%|███▏      | 96/300 [41:09<1:23:53, 24.67s/it] 32%|███▏      | 97/300 [41:45<1:34:47, 28.02s/it] 33%|███▎      | 98/300 [42:10<1:31:12, 27.09s/it] 33%|███▎      | 99/300 [42:32<1:25:39, 25.57s/it] 33%|███▎      | 100/300 [43:02<1:29:54, 26.97s/it] 34%|███▎      | 101/300 [43:41<1:40:43, 30.37s/it] 34%|███▍      | 102/300 [44:17<1:45:47, 32.06s/it] 34%|███▍      | 103/300 [44:47<1:44:00, 31.68s/it] 35%|███▍      | 104/300 [45:18<1:42:04, 31.25s/it] 35%|███▌      | 105/300 [45:28<1:21:27, 25.06s/it] 35%|███▌      | 106/300 [45:46<1:14:21, 23.00s/it] 36%|███▌      | 107/300 [46:20<1:24:19, 26.21s/it] 36%|███▌      | 108/300 [46:57<1:33:56, 29.36s/it] 36%|███▋      | 109/300 [47:17<1:24:52, 26.66s/it] 37%|███▋      | 110/300 [47:48<1:28:48, 28.04s/it] 37%|███▋      | 111/300 [48:12<1:23:50, 26.62s/it] 37%|███▋      | 112/300 [48:48<1:32:38, 29.57s/it] 38%|███▊      | 113/300 [49:19<1:33:02, 29.85s/it] 38%|███▊      | 114/300 [49:49<1:33:10, 30.06s/it] 38%|███▊      | 115/300 [50:09<1:23:16, 27.01s/it] 39%|███▊      | 116/300 [50:29<1:16:35, 24.97s/it] 39%|███▉      | 117/300 [50:59<1:20:16, 26.32s/it] 39%|███▉      | 118/300 [51:31<1:25:30, 28.19s/it] 40%|███▉      | 119/300 [52:02<1:27:33, 29.02s/it] 40%|████      | 120/300 [52:28<1:24:18, 28.10s/it] 40%|████      | 121/300 [52:54<1:21:42, 27.39s/it] 41%|████      | 122/300 [53:18<1:18:11, 26.35s/it] 41%|████      | 123/300 [53:38<1:12:06, 24.44s/it] 41%|████▏     | 124/300 [54:02<1:10:55, 24.18s/it] 42%|████▏     | 125/300 [54:18<1:03:50, 21.89s/it] 42%|████▏     | 126/300 [54:34<58:11, 20.07s/it]   42%|████▏     | 127/300 [55:04<1:06:49, 23.18s/it] 43%|████▎     | 128/300 [55:26<1:04:55, 22.65s/it] 43%|████▎     | 129/300 [55:40<57:28, 20.17s/it]   43%|████▎     | 130/300 [56:16<1:10:41, 24.95s/it] 44%|████▎     | 131/300 [56:35<1:04:55, 23.05s/it] 44%|████▍     | 132/300 [57:06<1:11:44, 25.62s/it] 44%|████▍     | 133/300 [57:36<1:14:54, 26.91s/it] 45%|████▍     | 134/300 [57:58<1:10:19, 25.42s/it] 45%|████▌     | 135/300 [58:30<1:15:27, 27.44s/it] 45%|████▌     | 136/300 [58:55<1:12:37, 26.57s/it] 46%|████▌     | 137/300 [59:07<1:00:09, 22.14s/it] 46%|████▌     | 138/300 [59:28<59:00, 21.86s/it]   46%|████▋     | 139/300 [1:00:00<1:06:42, 24.86s/it] 47%|████▋     | 140/300 [1:00:26<1:07:38, 25.37s/it] 47%|████▋     | 141/300 [1:00:44<1:00:40, 22.89s/it] 47%|████▋     | 142/300 [1:01:27<1:16:23, 29.01s/it] 48%|████▊     | 143/300 [1:01:55<1:15:27, 28.83s/it] 48%|████▊     | 144/300 [1:02:18<1:10:30, 27.12s/it] 48%|████▊     | 145/300 [1:02:45<1:09:30, 26.91s/it] 49%|████▊     | 146/300 [1:03:16<1:12:24, 28.21s/it] 49%|████▉     | 147/300 [1:03:42<1:09:59, 27.45s/it] 49%|████▉     | 148/300 [1:04:20<1:17:44, 30.69s/it] 50%|████▉     | 149/300 [1:04:41<1:09:43, 27.70s/it] 50%|█████     | 150/300 [1:04:59<1:02:33, 25.02s/it] 50%|█████     | 151/300 [1:05:35<1:09:53, 28.14s/it] 51%|█████     | 152/300 [1:06:03<1:09:34, 28.20s/it] 51%|█████     | 153/300 [1:06:27<1:06:06, 26.99s/it] 51%|█████▏    | 154/300 [1:07:00<1:09:41, 28.64s/it] 52%|█████▏    | 155/300 [1:07:23<1:04:56, 26.87s/it] 52%|█████▏    | 156/300 [1:07:47<1:02:34, 26.08s/it] 52%|█████▏    | 157/300 [1:08:14<1:03:11, 26.51s/it] 53%|█████▎    | 158/300 [1:08:43<1:04:23, 27.20s/it] 53%|█████▎    | 159/300 [1:09:17<1:08:36, 29.20s/it] 53%|█████▎    | 160/300 [1:09:52<1:12:19, 31.00s/it] 54%|█████▎    | 161/300 [1:10:27<1:14:45, 32.27s/it] 54%|█████▍    | 162/300 [1:10:44<1:03:15, 27.51s/it] 54%|█████▍    | 163/300 [1:11:11<1:02:35, 27.41s/it] 55%|█████▍    | 164/300 [1:11:41<1:03:53, 28.18s/it] 55%|█████▌    | 165/300 [1:12:16<1:07:40, 30.08s/it] 55%|█████▌    | 166/300 [1:12:29<56:01, 25.08s/it]   56%|█████▌    | 167/300 [1:12:53<54:39, 24.66s/it] 56%|█████▌    | 168/300 [1:13:16<53:27, 24.30s/it] 56%|█████▋    | 169/300 [1:13:49<58:46, 26.92s/it] 57%|█████▋    | 170/300 [1:14:17<58:51, 27.17s/it] 57%|█████▋    | 171/300 [1:14:48<1:00:49, 28.29s/it] 57%|█████▋    | 172/300 [1:15:12<57:53, 27.13s/it]   58%|█████▊    | 173/300 [1:15:38<56:42, 26.79s/it] 58%|█████▊    | 174/300 [1:16:10<59:18, 28.24s/it] 58%|█████▊    | 175/300 [1:16:45<1:03:09, 30.32s/it] 59%|█████▊    | 176/300 [1:17:20<1:05:40, 31.78s/it] 59%|█████▉    | 177/300 [1:17:49<1:03:30, 30.98s/it] 59%|█████▉    | 178/300 [1:18:12<58:08, 28.59s/it]   60%|█████▉    | 179/300 [1:18:41<57:53, 28.71s/it] 60%|██████    | 180/300 [1:19:11<57:49, 28.91s/it] 60%|██████    | 181/300 [1:19:33<53:33, 27.01s/it] 61%|██████    | 182/300 [1:20:04<55:28, 28.21s/it] 61%|██████    | 183/300 [1:20:33<55:04, 28.24s/it] 61%|██████▏   | 184/300 [1:21:00<54:01, 27.95s/it] 62%|██████▏   | 185/300 [1:21:32<56:15, 29.35s/it] 62%|██████▏   | 186/300 [1:21:58<53:38, 28.23s/it] 62%|██████▏   | 187/300 [1:22:28<54:12, 28.78s/it] 63%|██████▎   | 188/300 [1:23:02<56:18, 30.17s/it] 63%|██████▎   | 189/300 [1:23:37<58:36, 31.68s/it] 63%|██████▎   | 190/300 [1:24:00<53:27, 29.16s/it] 64%|██████▎   | 191/300 [1:24:29<52:50, 29.09s/it] 64%|██████▍   | 192/300 [1:25:00<53:34, 29.76s/it] 64%|██████▍   | 193/300 [1:25:24<50:04, 28.07s/it] 65%|██████▍   | 194/300 [1:25:56<51:33, 29.18s/it] 65%|██████▌   | 195/300 [1:26:21<48:46, 27.87s/it] 65%|██████▌   | 196/300 [1:26:57<52:18, 30.17s/it] 66%|██████▌   | 197/300 [1:27:32<54:42, 31.87s/it] 66%|██████▌   | 198/300 [1:27:58<51:08, 30.08s/it] 66%|██████▋   | 199/300 [1:28:31<51:47, 30.77s/it] 67%|██████▋   | 200/300 [1:28:49<45:06, 27.06s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (22166 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [1:29:30<51:42, 31.34s/it] 67%|██████▋   | 202/300 [1:30:05<52:34, 32.19s/it] 68%|██████▊   | 203/300 [1:30:31<49:09, 30.41s/it] 68%|██████▊   | 204/300 [1:31:04<50:00, 31.26s/it] 68%|██████▊   | 205/300 [1:31:31<47:29, 30.00s/it] 69%|██████▊   | 206/300 [1:31:59<45:54, 29.31s/it] 69%|██████▉   | 207/300 [1:32:19<41:11, 26.58s/it] 69%|██████▉   | 208/300 [1:32:46<41:03, 26.78s/it] 70%|██████▉   | 209/300 [1:33:09<38:54, 25.66s/it] 70%|███████   | 210/300 [1:33:40<40:52, 27.25s/it] 70%|███████   | 211/300 [1:34:09<41:10, 27.76s/it] 71%|███████   | 212/300 [1:34:49<46:11, 31.50s/it] 71%|███████   | 213/300 [1:35:12<41:47, 28.82s/it] 71%|███████▏  | 214/300 [1:35:41<41:13, 28.76s/it] 72%|███████▏  | 215/300 [1:35:55<34:36, 24.42s/it] 72%|███████▏  | 216/300 [1:36:06<28:46, 20.56s/it] 72%|███████▏  | 217/300 [1:36:41<34:21, 24.84s/it] 73%|███████▎  | 218/300 [1:37:13<36:34, 26.77s/it] 73%|███████▎  | 219/300 [1:37:35<34:25, 25.50s/it] 73%|███████▎  | 220/300 [1:37:59<33:23, 25.05s/it] 74%|███████▎  | 221/300 [1:38:36<37:49, 28.73s/it] 74%|███████▍  | 222/300 [1:39:01<35:46, 27.52s/it] 74%|███████▍  | 223/300 [1:39:14<29:45, 23.18s/it] 75%|███████▍  | 224/300 [1:39:33<27:49, 21.96s/it] 75%|███████▌  | 225/300 [1:39:47<24:29, 19.59s/it] 75%|███████▌  | 226/300 [1:40:16<27:26, 22.25s/it] 76%|███████▌  | 227/300 [1:40:47<30:11, 24.82s/it] 76%|███████▌  | 228/300 [1:41:25<34:33, 28.80s/it] 76%|███████▋  | 229/300 [1:41:54<34:07, 28.84s/it] 77%|███████▋  | 230/300 [1:42:23<33:51, 29.02s/it] 77%|███████▋  | 231/300 [1:42:43<30:24, 26.44s/it] 77%|███████▋  | 232/300 [1:43:15<31:32, 27.83s/it] 78%|███████▊  | 233/300 [1:43:44<31:28, 28.18s/it] 78%|███████▊  | 234/300 [1:44:14<31:52, 28.98s/it] 78%|███████▊  | 235/300 [1:44:45<31:48, 29.36s/it] 79%|███████▊  | 236/300 [1:45:11<30:22, 28.47s/it] 79%|███████▉  | 237/300 [1:45:33<27:54, 26.58s/it] 79%|███████▉  | 238/300 [1:45:53<25:29, 24.67s/it] 80%|███████▉  | 239/300 [1:46:27<27:51, 27.40s/it] 80%|████████  | 240/300 [1:47:00<29:01, 29.02s/it] 80%|████████  | 241/300 [1:47:42<32:20, 32.90s/it] 81%|████████  | 242/300 [1:48:15<31:49, 32.91s/it] 81%|████████  | 243/300 [1:48:48<31:18, 32.96s/it] 81%|████████▏ | 244/300 [1:49:12<28:08, 30.15s/it] 82%|████████▏ | 245/300 [1:49:44<28:19, 30.90s/it] 82%|████████▏ | 246/300 [1:50:14<27:38, 30.71s/it] 82%|████████▏ | 247/300 [1:50:38<25:14, 28.58s/it] 83%|████████▎ | 248/300 [1:51:07<24:51, 28.68s/it] 83%|████████▎ | 249/300 [1:51:46<27:04, 31.86s/it] 83%|████████▎ | 250/300 [1:52:13<25:11, 30.23s/it] 84%|████████▎ | 251/300 [1:52:41<24:15, 29.71s/it] 84%|████████▍ | 252/300 [1:53:17<25:16, 31.59s/it] 84%|████████▍ | 253/300 [1:53:38<22:16, 28.43s/it] 85%|████████▍ | 254/300 [1:54:03<20:59, 27.39s/it] 85%|████████▌ | 255/300 [1:54:38<22:17, 29.72s/it] 85%|████████▌ | 256/300 [1:55:06<21:24, 29.19s/it] 86%|████████▌ | 257/300 [1:55:32<20:06, 28.06s/it] 86%|████████▌ | 258/300 [1:56:03<20:21, 29.09s/it] 86%|████████▋ | 259/300 [1:56:45<22:25, 32.82s/it] 87%|████████▋ | 260/300 [1:57:16<21:38, 32.46s/it] 87%|████████▋ | 261/300 [1:57:39<19:10, 29.50s/it] 87%|████████▋ | 262/300 [1:58:13<19:32, 30.85s/it] 88%|████████▊ | 263/300 [1:58:42<18:41, 30.32s/it] 88%|████████▊ | 264/300 [1:59:19<19:23, 32.31s/it] 88%|████████▊ | 265/300 [1:59:49<18:24, 31.55s/it] 89%|████████▊ | 266/300 [2:00:07<15:36, 27.54s/it] 89%|████████▉ | 267/300 [2:00:40<16:00, 29.11s/it] 89%|████████▉ | 268/300 [2:01:16<16:44, 31.39s/it] 90%|████████▉ | 269/300 [2:01:44<15:38, 30.28s/it] 90%|█████████ | 270/300 [2:02:15<15:17, 30.58s/it] 90%|█████████ | 271/300 [2:02:44<14:27, 29.91s/it] 91%|█████████ | 272/300 [2:03:06<12:56, 27.75s/it] 91%|█████████ | 273/300 [2:03:45<13:58, 31.04s/it] 91%|█████████▏| 274/300 [2:04:09<12:33, 28.97s/it] 92%|█████████▏| 275/300 [2:04:19<09:40, 23.24s/it] 92%|█████████▏| 276/300 [2:04:41<09:04, 22.69s/it] 92%|█████████▏| 277/300 [2:05:18<10:21, 27.02s/it] 93%|█████████▎| 278/300 [2:05:49<10:22, 28.29s/it] 93%|█████████▎| 279/300 [2:06:20<10:10, 29.08s/it] 93%|█████████▎| 280/300 [2:06:44<09:10, 27.51s/it] 94%|█████████▎| 281/300 [2:06:57<07:20, 23.18s/it] 94%|█████████▍| 282/300 [2:07:38<08:36, 28.70s/it] 94%|█████████▍| 283/300 [2:08:17<09:00, 31.77s/it] 95%|█████████▍| 284/300 [2:08:50<08:30, 31.92s/it] 95%|█████████▌| 285/300 [2:09:14<07:24, 29.61s/it] 95%|█████████▌| 286/300 [2:09:38<06:33, 28.07s/it] 96%|█████████▌| 287/300 [2:10:21<07:00, 32.31s/it] 96%|█████████▌| 288/300 [2:10:46<06:01, 30.16s/it] 96%|█████████▋| 289/300 [2:11:13<05:20, 29.17s/it] 97%|█████████▋| 290/300 [2:11:57<05:38, 33.82s/it] 97%|█████████▋| 291/300 [2:12:26<04:51, 32.41s/it] 97%|█████████▋| 292/300 [2:13:08<04:40, 35.12s/it] 98%|█████████▊| 293/300 [2:13:29<03:36, 30.94s/it] 98%|█████████▊| 294/300 [2:14:04<03:12, 32.14s/it] 98%|█████████▊| 295/300 [2:14:33<02:36, 31.27s/it] 99%|█████████▊| 296/300 [2:14:51<01:49, 27.35s/it] 99%|█████████▉| 297/300 [2:15:29<01:31, 30.56s/it] 99%|█████████▉| 298/300 [2:15:55<00:58, 29.09s/it]100%|█████████▉| 299/300 [2:16:22<00:28, 28.33s/it]100%|██████████| 300/300 [2:16:54<00:00, 29.55s/it]100%|██████████| 300/300 [2:16:54<00:00, 27.38s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:08<00:25,  8.53s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:17<00:17,  8.73s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:26<00:08,  8.87s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:32<00:00,  7.74s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:32<00:00,  8.11s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:35<2:58:08, 35.75s/it]  1%|          | 2/300 [01:03<2:33:04, 30.82s/it]  1%|          | 3/300 [01:26<2:15:48, 27.44s/it]  1%|▏         | 4/300 [01:51<2:09:51, 26.32s/it]  2%|▏         | 5/300 [02:31<2:34:03, 31.33s/it]  2%|▏         | 6/300 [02:59<2:27:49, 30.17s/it]  2%|▏         | 7/300 [03:28<2:25:15, 29.74s/it]  3%|▎         | 8/300 [04:01<2:29:36, 30.74s/it]  3%|▎         | 9/300 [04:31<2:29:05, 30.74s/it]  3%|▎         | 10/300 [05:02<2:29:08, 30.86s/it]  4%|▎         | 11/300 [05:26<2:17:19, 28.51s/it]  4%|▍         | 12/300 [05:57<2:21:20, 29.45s/it]  4%|▍         | 13/300 [06:16<2:06:06, 26.37s/it]  5%|▍         | 14/300 [06:53<2:20:25, 29.46s/it]  5%|▌         | 15/300 [07:16<2:10:06, 27.39s/it]  5%|▌         | 16/300 [07:37<2:00:59, 25.56s/it]  6%|▌         | 17/300 [08:13<2:15:32, 28.74s/it]  6%|▌         | 18/300 [08:45<2:18:55, 29.56s/it]  6%|▋         | 19/300 [09:19<2:24:41, 30.89s/it]  7%|▋         | 20/300 [09:45<2:17:20, 29.43s/it]  7%|▋         | 21/300 [09:58<1:54:07, 24.54s/it]  7%|▋         | 22/300 [10:37<2:14:20, 28.99s/it]  8%|▊         | 23/300 [11:16<2:28:12, 32.10s/it]  8%|▊         | 24/300 [11:56<2:37:46, 34.30s/it]  8%|▊         | 25/300 [12:21<2:24:07, 31.45s/it]  9%|▊         | 26/300 [13:00<2:34:20, 33.80s/it]  9%|▉         | 27/300 [13:22<2:17:47, 30.28s/it]  9%|▉         | 28/300 [13:48<2:11:46, 29.07s/it] 10%|▉         | 29/300 [14:17<2:10:46, 28.96s/it] 10%|█         | 30/300 [14:44<2:07:46, 28.40s/it] 10%|█         | 31/300 [15:10<2:04:03, 27.67s/it] 11%|█         | 32/300 [15:35<2:00:37, 27.00s/it] 11%|█         | 33/300 [15:59<1:55:59, 26.07s/it] 11%|█▏        | 34/300 [16:33<2:05:07, 28.22s/it] 12%|█▏        | 35/300 [16:53<1:53:51, 25.78s/it] 12%|█▏        | 36/300 [17:15<1:48:55, 24.76s/it] 12%|█▏        | 37/300 [17:28<1:32:24, 21.08s/it] 13%|█▎        | 38/300 [17:58<1:43:50, 23.78s/it] 13%|█▎        | 39/300 [18:33<1:58:09, 27.16s/it] 13%|█▎        | 40/300 [18:58<1:55:08, 26.57s/it] 14%|█▎        | 41/300 [19:26<1:56:32, 27.00s/it] 14%|█▍        | 42/300 [19:53<1:56:19, 27.05s/it] 14%|█▍        | 43/300 [20:22<1:58:54, 27.76s/it] 15%|█▍        | 44/300 [21:02<2:13:05, 31.19s/it] 15%|█▌        | 45/300 [21:29<2:07:34, 30.02s/it] 15%|█▌        | 46/300 [21:53<1:59:00, 28.11s/it] 16%|█▌        | 47/300 [22:24<2:03:15, 29.23s/it] 16%|█▌        | 48/300 [22:58<2:08:20, 30.56s/it] 16%|█▋        | 49/300 [23:14<1:49:52, 26.27s/it] 17%|█▋        | 50/300 [23:38<1:45:34, 25.34s/it] 17%|█▋        | 51/300 [24:15<2:00:18, 28.99s/it] 17%|█▋        | 52/300 [24:49<2:06:10, 30.53s/it] 18%|█▊        | 53/300 [25:10<1:53:11, 27.49s/it] 18%|█▊        | 54/300 [25:43<2:00:00, 29.27s/it] 18%|█▊        | 55/300 [26:13<2:00:39, 29.55s/it] 19%|█▊        | 56/300 [26:50<2:09:17, 31.79s/it] 19%|█▉        | 57/300 [27:19<2:05:24, 30.97s/it] 19%|█▉        | 58/300 [27:37<1:48:31, 26.91s/it] 20%|█▉        | 59/300 [27:53<1:35:32, 23.79s/it] 20%|██        | 60/300 [28:21<1:40:33, 25.14s/it] 20%|██        | 61/300 [28:58<1:54:18, 28.70s/it] 21%|██        | 62/300 [29:17<1:41:46, 25.66s/it] 21%|██        | 63/300 [29:36<1:32:58, 23.54s/it] 21%|██▏       | 64/300 [30:04<1:38:38, 25.08s/it] 22%|██▏       | 65/300 [30:39<1:49:07, 27.86s/it] 22%|██▏       | 66/300 [31:16<1:59:25, 30.62s/it] 22%|██▏       | 67/300 [31:45<1:57:39, 30.30s/it] 23%|██▎       | 68/300 [32:18<2:00:21, 31.13s/it] 23%|██▎       | 69/300 [32:53<2:03:33, 32.09s/it] 23%|██▎       | 70/300 [33:30<2:09:08, 33.69s/it] 24%|██▎       | 71/300 [34:07<2:11:44, 34.52s/it] 24%|██▍       | 72/300 [34:42<2:12:05, 34.76s/it] 24%|██▍       | 73/300 [35:10<2:04:14, 32.84s/it] 25%|██▍       | 74/300 [35:39<1:59:26, 31.71s/it] 25%|██▌       | 75/300 [36:13<2:00:48, 32.22s/it] 25%|██▌       | 76/300 [36:31<1:45:00, 28.13s/it] 26%|██▌       | 77/300 [37:10<1:56:38, 31.38s/it] 26%|██▌       | 78/300 [37:34<1:47:37, 29.09s/it] 26%|██▋       | 79/300 [37:52<1:35:24, 25.90s/it] 27%|██▋       | 80/300 [38:25<1:42:06, 27.85s/it] 27%|██▋       | 81/300 [38:47<1:35:41, 26.22s/it] 27%|██▋       | 82/300 [39:11<1:32:57, 25.58s/it] 28%|██▊       | 83/300 [39:44<1:40:09, 27.69s/it] 28%|██▊       | 84/300 [39:58<1:25:23, 23.72s/it] 28%|██▊       | 85/300 [40:23<1:26:12, 24.06s/it] 29%|██▊       | 86/300 [40:55<1:33:55, 26.34s/it] 29%|██▉       | 87/300 [41:22<1:34:31, 26.63s/it] 29%|██▉       | 88/300 [41:52<1:37:02, 27.46s/it] 30%|██▉       | 89/300 [42:22<1:39:15, 28.23s/it] 30%|███       | 90/300 [42:49<1:37:59, 28.00s/it] 30%|███       | 91/300 [43:07<1:26:44, 24.90s/it] 31%|███       | 92/300 [43:23<1:17:17, 22.30s/it] 31%|███       | 93/300 [43:44<1:15:32, 21.89s/it] 31%|███▏      | 94/300 [44:03<1:11:43, 20.89s/it] 32%|███▏      | 95/300 [44:30<1:17:55, 22.81s/it] 32%|███▏      | 96/300 [45:03<1:28:25, 26.01s/it] 32%|███▏      | 97/300 [45:43<1:41:57, 30.14s/it] 33%|███▎      | 98/300 [46:02<1:30:25, 26.86s/it] 33%|███▎      | 99/300 [46:41<1:42:14, 30.52s/it] 33%|███▎      | 100/300 [47:16<1:46:11, 31.86s/it] 34%|███▎      | 101/300 [47:47<1:44:56, 31.64s/it] 34%|███▍      | 102/300 [48:26<1:51:24, 33.76s/it] 34%|███▍      | 103/300 [49:05<1:56:19, 35.43s/it] 35%|███▍      | 104/300 [49:45<2:00:05, 36.76s/it] 35%|███▌      | 105/300 [50:08<1:45:35, 32.49s/it] 35%|███▌      | 106/300 [50:33<1:38:18, 30.41s/it] 36%|███▌      | 107/300 [50:58<1:32:09, 28.65s/it] 36%|███▌      | 108/300 [51:30<1:34:43, 29.60s/it] 36%|███▋      | 109/300 [51:55<1:29:49, 28.22s/it] 37%|███▋      | 110/300 [52:21<1:27:55, 27.77s/it] 37%|███▋      | 111/300 [52:48<1:26:41, 27.52s/it] 37%|███▋      | 112/300 [53:23<1:32:46, 29.61s/it] 38%|███▊      | 113/300 [53:55<1:34:50, 30.43s/it] 38%|███▊      | 114/300 [54:32<1:40:29, 32.41s/it] 38%|███▊      | 115/300 [55:00<1:35:31, 30.98s/it] 39%|███▊      | 116/300 [55:25<1:29:49, 29.29s/it] 39%|███▉      | 117/300 [55:53<1:27:36, 28.72s/it] 39%|███▉      | 118/300 [56:27<1:32:06, 30.36s/it] 40%|███▉      | 119/300 [57:05<1:38:56, 32.80s/it] 40%|████      | 120/300 [57:30<1:30:43, 30.24s/it] 40%|████      | 121/300 [57:56<1:26:29, 28.99s/it] 41%|████      | 122/300 [58:15<1:17:45, 26.21s/it] 41%|████      | 123/300 [58:45<1:20:29, 27.28s/it] 41%|████▏     | 124/300 [59:14<1:21:00, 27.62s/it] 42%|████▏     | 125/300 [59:33<1:13:28, 25.19s/it] 42%|████▏     | 126/300 [1:00:03<1:17:25, 26.70s/it] 42%|████▏     | 127/300 [1:00:37<1:23:20, 28.90s/it] 43%|████▎     | 128/300 [1:01:06<1:22:55, 28.93s/it] 43%|████▎     | 129/300 [1:01:38<1:24:30, 29.65s/it] 43%|████▎     | 130/300 [1:02:17<1:32:01, 32.48s/it] 44%|████▎     | 131/300 [1:02:35<1:19:09, 28.11s/it] 44%|████▍     | 132/300 [1:03:08<1:22:53, 29.60s/it] 44%|████▍     | 133/300 [1:03:39<1:23:58, 30.17s/it] 45%|████▍     | 134/300 [1:04:06<1:20:44, 29.18s/it] 45%|████▌     | 135/300 [1:04:43<1:26:30, 31.46s/it] 45%|████▌     | 136/300 [1:05:19<1:29:46, 32.84s/it] 46%|████▌     | 137/300 [1:05:53<1:29:47, 33.05s/it] 46%|████▌     | 138/300 [1:06:25<1:29:01, 32.97s/it] 46%|████▋     | 139/300 [1:06:50<1:22:01, 30.57s/it] 47%|████▋     | 140/300 [1:07:15<1:17:01, 28.88s/it] 47%|████▋     | 141/300 [1:07:43<1:15:31, 28.50s/it] 47%|████▋     | 142/300 [1:08:18<1:20:24, 30.54s/it] 48%|████▊     | 143/300 [1:08:42<1:14:55, 28.63s/it] 48%|████▊     | 144/300 [1:09:10<1:13:33, 28.29s/it] 48%|████▊     | 145/300 [1:09:35<1:10:22, 27.25s/it] 49%|████▊     | 146/300 [1:10:08<1:14:32, 29.04s/it] 49%|████▉     | 147/300 [1:10:25<1:05:01, 25.50s/it] 49%|████▉     | 148/300 [1:10:58<1:10:15, 27.73s/it] 50%|████▉     | 149/300 [1:11:21<1:06:02, 26.24s/it] 50%|█████     | 150/300 [1:11:49<1:07:13, 26.89s/it] 50%|█████     | 151/300 [1:12:25<1:13:06, 29.44s/it] 51%|█████     | 152/300 [1:12:52<1:11:17, 28.90s/it] 51%|█████     | 153/300 [1:13:13<1:05:05, 26.57s/it] 51%|█████▏    | 154/300 [1:13:35<1:01:17, 25.19s/it] 52%|█████▏    | 155/300 [1:14:03<1:02:43, 25.95s/it] 52%|█████▏    | 156/300 [1:14:18<53:59, 22.50s/it]   52%|█████▏    | 157/300 [1:14:48<59:17, 24.88s/it] 53%|█████▎    | 158/300 [1:15:26<1:08:27, 28.92s/it] 53%|█████▎    | 159/300 [1:15:59<1:10:37, 30.05s/it] 53%|█████▎    | 160/300 [1:16:33<1:13:04, 31.32s/it] 54%|█████▎    | 161/300 [1:17:01<1:10:20, 30.36s/it] 54%|█████▍    | 162/300 [1:17:28<1:06:54, 29.09s/it] 54%|█████▍    | 163/300 [1:18:01<1:09:28, 30.43s/it] 55%|█████▍    | 164/300 [1:18:25<1:04:29, 28.45s/it] 55%|█████▌    | 165/300 [1:18:58<1:07:17, 29.91s/it] 55%|█████▌    | 166/300 [1:19:22<1:02:22, 27.93s/it] 56%|█████▌    | 167/300 [1:19:52<1:03:48, 28.79s/it] 56%|█████▌    | 168/300 [1:20:30<1:08:59, 31.36s/it] 56%|█████▋    | 169/300 [1:21:03<1:09:33, 31.86s/it] 57%|█████▋    | 170/300 [1:21:28<1:04:56, 29.98s/it] 57%|█████▋    | 171/300 [1:21:51<59:41, 27.77s/it]   57%|█████▋    | 172/300 [1:22:13<55:54, 26.21s/it] 58%|█████▊    | 173/300 [1:22:45<58:36, 27.69s/it] 58%|█████▊    | 174/300 [1:23:04<53:03, 25.27s/it] 58%|█████▊    | 175/300 [1:23:43<1:01:22, 29.46s/it] 59%|█████▊    | 176/300 [1:24:23<1:06:51, 32.35s/it] 59%|█████▉    | 177/300 [1:25:01<1:09:52, 34.09s/it] 59%|█████▉    | 178/300 [1:25:29<1:05:38, 32.28s/it] 60%|█████▉    | 179/300 [1:26:01<1:05:00, 32.24s/it] 60%|██████    | 180/300 [1:26:20<56:24, 28.20s/it]   60%|██████    | 181/300 [1:26:42<52:39, 26.55s/it] 61%|██████    | 182/300 [1:27:13<54:45, 27.84s/it] 61%|██████    | 183/300 [1:27:39<52:50, 27.10s/it] 61%|██████▏   | 184/300 [1:28:00<49:06, 25.40s/it] 62%|██████▏   | 185/300 [1:28:31<52:00, 27.13s/it] 62%|██████▏   | 186/300 [1:28:55<49:48, 26.21s/it] 62%|██████▏   | 187/300 [1:29:29<53:30, 28.41s/it] 63%|██████▎   | 188/300 [1:29:56<52:10, 27.95s/it] 63%|██████▎   | 189/300 [1:30:17<48:07, 26.01s/it] 63%|██████▎   | 190/300 [1:30:35<43:04, 23.50s/it] 64%|██████▎   | 191/300 [1:31:01<44:16, 24.37s/it] 64%|██████▍   | 192/300 [1:31:40<51:48, 28.78s/it] 64%|██████▍   | 193/300 [1:32:03<47:57, 26.89s/it] 65%|██████▍   | 194/300 [1:32:42<54:06, 30.63s/it] 65%|██████▌   | 195/300 [1:33:11<52:38, 30.08s/it] 65%|██████▌   | 196/300 [1:33:48<55:33, 32.05s/it] 66%|██████▌   | 197/300 [1:34:24<57:28, 33.48s/it] 66%|██████▌   | 198/300 [1:35:03<59:42, 35.12s/it] 66%|██████▋   | 199/300 [1:35:35<57:25, 34.11s/it] 67%|██████▋   | 200/300 [1:36:01<52:31, 31.51s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (22166 > 16384). Running this sequence through the model will result in indexing errors
 67%|██████▋   | 201/300 [1:36:52<1:01:50, 37.48s/it] 67%|██████▋   | 202/300 [1:37:28<1:00:43, 37.18s/it] 68%|██████▊   | 203/300 [1:37:58<56:35, 35.01s/it]   68%|██████▊   | 204/300 [1:38:31<54:38, 34.15s/it] 68%|██████▊   | 205/300 [1:39:16<59:35, 37.64s/it] 69%|██████▊   | 206/300 [1:39:41<52:56, 33.80s/it] 69%|██████▉   | 207/300 [1:40:08<49:08, 31.70s/it] 69%|██████▉   | 208/300 [1:40:44<50:44, 33.09s/it] 70%|██████▉   | 209/300 [1:41:13<48:18, 31.85s/it] 70%|███████   | 210/300 [1:41:57<53:10, 35.44s/it] 70%|███████   | 211/300 [1:42:28<50:30, 34.05s/it] 71%|███████   | 212/300 [1:43:06<51:31, 35.14s/it] 71%|███████   | 213/300 [1:43:35<48:23, 33.38s/it] 71%|███████▏  | 214/300 [1:44:03<45:40, 31.86s/it] 72%|███████▏  | 215/300 [1:44:33<44:26, 31.37s/it] 72%|███████▏  | 216/300 [1:44:46<35:55, 25.66s/it] 72%|███████▏  | 217/300 [1:45:21<39:29, 28.55s/it] 73%|███████▎  | 218/300 [1:45:58<42:22, 31.01s/it] 73%|███████▎  | 219/300 [1:46:23<39:28, 29.25s/it] 73%|███████▎  | 220/300 [1:46:52<38:50, 29.13s/it] 74%|███████▎  | 221/300 [1:47:35<43:52, 33.33s/it] 74%|███████▍  | 222/300 [1:48:05<41:55, 32.25s/it] 74%|███████▍  | 223/300 [1:48:21<35:23, 27.58s/it] 75%|███████▍  | 224/300 [1:48:48<34:26, 27.19s/it] 75%|███████▌  | 225/300 [1:49:00<28:34, 22.86s/it] 75%|███████▌  | 226/300 [1:49:29<30:24, 24.66s/it] 76%|███████▌  | 227/300 [1:50:04<33:51, 27.83s/it] 76%|███████▌  | 228/300 [1:50:36<34:48, 29.01s/it] 76%|███████▋  | 229/300 [1:51:03<33:31, 28.33s/it] 77%|███████▋  | 230/300 [1:51:38<35:22, 30.32s/it] 77%|███████▋  | 231/300 [1:52:00<31:57, 27.80s/it] 77%|███████▋  | 232/300 [1:52:13<26:40, 23.54s/it] 78%|███████▊  | 233/300 [1:53:00<33:59, 30.44s/it] 78%|███████▊  | 234/300 [1:53:34<34:48, 31.65s/it] 78%|███████▊  | 235/300 [1:54:05<33:53, 31.28s/it] 79%|███████▊  | 236/300 [1:54:42<35:15, 33.05s/it] 79%|███████▉  | 237/300 [1:54:57<28:59, 27.61s/it] 79%|███████▉  | 238/300 [1:55:09<23:49, 23.05s/it] 80%|███████▉  | 239/300 [1:55:30<22:33, 22.19s/it] 80%|████████  | 240/300 [1:55:56<23:29, 23.49s/it] 80%|████████  | 241/300 [1:56:39<28:50, 29.33s/it] 81%|████████  | 242/300 [1:57:15<30:17, 31.34s/it] 81%|████████  | 243/300 [1:57:52<31:20, 32.99s/it] 81%|████████▏ | 244/300 [1:58:29<32:02, 34.33s/it] 82%|████████▏ | 245/300 [1:58:45<26:26, 28.84s/it] 82%|████████▏ | 246/300 [1:59:23<28:22, 31.54s/it] 82%|████████▏ | 247/300 [1:59:49<26:18, 29.78s/it] 83%|████████▎ | 248/300 [2:00:19<25:57, 29.95s/it] 83%|████████▎ | 249/300 [2:00:40<23:12, 27.31s/it] 83%|████████▎ | 250/300 [2:01:16<24:45, 29.71s/it] 84%|████████▎ | 251/300 [2:01:55<26:42, 32.71s/it] 84%|████████▍ | 252/300 [2:02:14<22:42, 28.38s/it] 84%|████████▍ | 253/300 [2:02:44<22:48, 29.11s/it] 85%|████████▍ | 254/300 [2:03:24<24:43, 32.25s/it] 85%|████████▌ | 255/300 [2:04:03<25:37, 34.17s/it] 85%|████████▌ | 256/300 [2:04:25<22:21, 30.49s/it] 86%|████████▌ | 257/300 [2:04:57<22:21, 31.19s/it] 86%|████████▌ | 258/300 [2:05:31<22:20, 31.91s/it] 86%|████████▋ | 259/300 [2:06:09<23:06, 33.82s/it] 87%|████████▋ | 260/300 [2:06:36<21:03, 31.59s/it] 87%|████████▋ | 261/300 [2:07:16<22:16, 34.26s/it] 87%|████████▋ | 262/300 [2:07:52<21:57, 34.68s/it] 88%|████████▊ | 263/300 [2:08:25<21:06, 34.22s/it] 88%|████████▊ | 264/300 [2:08:53<19:23, 32.32s/it] 88%|████████▊ | 265/300 [2:09:18<17:40, 30.30s/it] 89%|████████▊ | 266/300 [2:09:44<16:21, 28.87s/it] 89%|████████▉ | 267/300 [2:10:19<16:55, 30.79s/it] 89%|████████▉ | 268/300 [2:10:52<16:48, 31.52s/it] 90%|████████▉ | 269/300 [2:11:20<15:43, 30.44s/it] 90%|█████████ | 270/300 [2:11:53<15:30, 31.00s/it] 90%|█████████ | 271/300 [2:12:31<16:00, 33.13s/it] 91%|█████████ | 272/300 [2:12:59<14:44, 31.61s/it] 91%|█████████ | 273/300 [2:13:42<15:43, 34.96s/it] 91%|█████████▏| 274/300 [2:14:14<14:49, 34.21s/it] 92%|█████████▏| 275/300 [2:14:31<12:08, 29.14s/it] 92%|█████████▏| 276/300 [2:14:51<10:31, 26.31s/it] 92%|█████████▏| 277/300 [2:15:35<12:03, 31.44s/it] 93%|█████████▎| 278/300 [2:16:02<11:05, 30.26s/it] 93%|█████████▎| 279/300 [2:16:31<10:28, 29.92s/it] 93%|█████████▎| 280/300 [2:17:01<09:58, 29.94s/it] 94%|█████████▎| 281/300 [2:17:28<09:11, 29.02s/it] 94%|█████████▍| 282/300 [2:18:00<09:00, 30.03s/it] 94%|█████████▍| 283/300 [2:18:36<08:57, 31.60s/it] 95%|█████████▍| 284/300 [2:18:51<07:05, 26.58s/it] 95%|█████████▌| 285/300 [2:19:24<07:08, 28.59s/it] 95%|█████████▌| 286/300 [2:20:03<07:24, 31.76s/it] 96%|█████████▌| 287/300 [2:20:42<07:19, 33.84s/it] 96%|█████████▌| 288/300 [2:21:14<06:39, 33.28s/it] 96%|█████████▋| 289/300 [2:21:50<06:17, 34.30s/it] 97%|█████████▋| 290/300 [2:22:22<05:34, 33.41s/it] 97%|█████████▋| 291/300 [2:22:49<04:43, 31.50s/it] 97%|█████████▋| 292/300 [2:23:36<04:49, 36.14s/it] 98%|█████████▊| 293/300 [2:24:09<04:06, 35.18s/it] 98%|█████████▊| 294/300 [2:24:52<03:46, 37.76s/it] 98%|█████████▊| 295/300 [2:25:24<02:59, 35.85s/it] 99%|█████████▊| 296/300 [2:26:03<02:26, 36.75s/it] 99%|█████████▉| 297/300 [2:26:29<01:40, 33.50s/it] 99%|█████████▉| 298/300 [2:26:49<00:58, 29.48s/it]100%|█████████▉| 299/300 [2:27:17<00:29, 29.21s/it]100%|██████████| 300/300 [2:27:51<00:00, 30.72s/it]100%|██████████| 300/300 [2:27:52<00:00, 29.57s/it]
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:08<00:26,  8.82s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:18<00:18,  9.28s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:27<00:09,  9.08s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:33<00:00,  7.85s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:33<00:00,  8.31s/it]
  0%|          | 0/300 [00:00<?, ?it/s]/lus/eagle/projects/datascience/krishnat95/envs/Dynamic_NAS/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
  0%|          | 1/300 [00:41<3:25:47, 41.30s/it]  1%|          | 2/300 [01:30<3:48:29, 46.01s/it]  1%|          | 3/300 [02:08<3:29:31, 42.33s/it]  1%|▏         | 4/300 [02:46<3:20:59, 40.74s/it]  2%|▏         | 5/300 [03:41<3:44:29, 45.66s/it]  2%|▏         | 6/300 [04:21<3:35:09, 43.91s/it]  2%|▏         | 7/300 [04:57<3:21:35, 41.28s/it]  3%|▎         | 8/300 [05:56<3:47:48, 46.81s/it]  3%|▎         | 9/300 [06:41<3:45:12, 46.44s/it]  3%|▎         | 10/300 [07:36<3:56:57, 49.03s/it]  4%|▎         | 11/300 [08:25<3:55:05, 48.81s/it]  4%|▍         | 12/300 [09:14<3:54:42, 48.90s/it]  4%|▍         | 13/300 [09:32<3:08:58, 39.51s/it]  5%|▍         | 14/300 [10:21<3:23:17, 42.65s/it]  5%|▌         | 15/300 [10:50<3:02:16, 38.37s/it]  5%|▌         | 16/300 [11:20<2:50:01, 35.92s/it]  6%|▌         | 17/300 [11:54<2:47:08, 35.44s/it]  6%|▌         | 18/300 [12:30<2:47:22, 35.61s/it]  6%|▋         | 19/300 [12:57<2:34:38, 33.02s/it]  7%|▋         | 20/300 [13:34<2:38:58, 34.07s/it]  7%|▋         | 21/300 [13:57<2:23:13, 30.80s/it]  7%|▋         | 22/300 [14:52<2:56:20, 38.06s/it]  8%|▊         | 23/300 [15:36<3:03:39, 39.78s/it]  8%|▊         | 24/300 [16:31<3:23:54, 44.33s/it]  8%|▊         | 25/300 [17:11<3:17:16, 43.04s/it]  9%|▊         | 26/300 [17:36<2:51:57, 37.66s/it]  9%|▉         | 27/300 [17:59<2:31:40, 33.33s/it]  9%|▉         | 28/300 [18:56<3:02:57, 40.36s/it] 10%|▉         | 29/300 [19:30<2:53:44, 38.47s/it] 10%|█         | 30/300 [20:10<2:54:29, 38.78s/it] 10%|█         | 31/300 [20:44<2:47:24, 37.34s/it] 11%|█         | 32/300 [21:25<2:52:58, 38.73s/it] 11%|█         | 33/300 [22:13<3:04:41, 41.50s/it] 11%|█▏        | 34/300 [22:39<2:42:54, 36.75s/it] 12%|█▏        | 35/300 [23:07<2:31:07, 34.22s/it] 12%|█▏        | 36/300 [23:33<2:19:26, 31.69s/it] 12%|█▏        | 37/300 [24:00<2:12:26, 30.21s/it] 13%|█▎        | 38/300 [24:32<2:14:46, 30.86s/it] 13%|█▎        | 39/300 [25:09<2:21:39, 32.56s/it] 13%|█▎        | 40/300 [25:35<2:12:34, 30.59s/it] 14%|█▎        | 41/300 [26:10<2:18:09, 32.01s/it] 14%|█▍        | 42/300 [26:51<2:28:34, 34.55s/it] 14%|█▍        | 43/300 [27:23<2:24:29, 33.73s/it] 15%|█▍        | 44/300 [27:47<2:12:20, 31.02s/it] 15%|█▌        | 45/300 [28:33<2:30:15, 35.36s/it] 15%|█▌        | 46/300 [29:01<2:20:31, 33.19s/it] 16%|█▌        | 47/300 [29:27<2:11:11, 31.11s/it] 16%|█▌        | 48/300 [30:05<2:18:52, 33.06s/it] 16%|█▋        | 49/300 [30:29<2:07:34, 30.50s/it] 17%|█▋        | 50/300 [31:07<2:16:12, 32.69s/it] 17%|█▋        | 51/300 [31:47<2:24:53, 34.91s/it] 17%|█▋        | 52/300 [32:42<2:49:04, 40.91s/it] 18%|█▊        | 53/300 [33:05<2:26:08, 35.50s/it] 18%|█▊        | 54/300 [33:40<2:24:50, 35.33s/it] 18%|█▊        | 55/300 [34:18<2:28:04, 36.26s/it] 19%|█▊        | 56/300 [35:15<2:52:36, 42.45s/it] 19%|█▉        | 57/300 [36:00<2:54:39, 43.13s/it] 19%|█▉        | 58/300 [36:41<2:51:31, 42.52s/it] 20%|█▉        | 59/300 [37:07<2:30:46, 37.54s/it] 20%|██        | 60/300 [38:03<2:52:55, 43.23s/it] 20%|██        | 61/300 [38:54<3:00:58, 45.43s/it] 21%|██        | 62/300 [39:33<2:52:40, 43.53s/it] 21%|██        | 63/300 [39:51<2:22:04, 35.97s/it] 21%|██▏       | 64/300 [40:21<2:14:24, 34.17s/it] 22%|██▏       | 65/300 [41:13<2:34:52, 39.54s/it] 22%|██▏       | 66/300 [42:02<2:44:35, 42.20s/it] 22%|██▏       | 67/300 [42:58<2:59:39, 46.26s/it] 23%|██▎       | 68/300 [43:36<2:49:38, 43.87s/it] 23%|██▎       | 69/300 [43:59<2:25:04, 37.68s/it] 23%|██▎       | 70/300 [44:42<2:30:34, 39.28s/it] 24%|██▎       | 71/300 [45:08<2:14:24, 35.22s/it] 24%|██▍       | 72/300 [45:40<2:10:12, 34.27s/it] 24%|██▍       | 73/300 [46:20<2:16:45, 36.15s/it] 25%|██▍       | 74/300 [47:12<2:34:01, 40.89s/it] 25%|██▌       | 75/300 [47:50<2:29:10, 39.78s/it] 25%|██▌       | 76/300 [48:34<2:34:09, 41.29s/it] 26%|██▌       | 77/300 [49:30<2:49:01, 45.48s/it] 26%|██▌       | 78/300 [50:04<2:35:34, 42.05s/it] 26%|██▋       | 79/300 [50:48<2:36:50, 42.58s/it] 27%|██▋       | 80/300 [51:15<2:19:30, 38.05s/it] 27%|██▋       | 81/300 [51:52<2:17:37, 37.70s/it] 27%|██▋       | 82/300 [52:28<2:15:20, 37.25s/it] 28%|██▊       | 83/300 [52:55<2:03:11, 34.06s/it] 28%|██▊       | 84/300 [53:32<2:06:36, 35.17s/it] 28%|██▊       | 85/300 [54:14<2:13:09, 37.16s/it] 29%|██▊       | 86/300 [54:59<2:20:42, 39.45s/it] 29%|██▉       | 87/300 [55:41<2:23:07, 40.32s/it] 29%|██▉       | 88/300 [56:36<2:37:27, 44.57s/it] 30%|██▉       | 89/300 [57:25<2:41:30, 45.93s/it] 30%|███       | 90/300 [58:05<2:34:05, 44.03s/it] 30%|███       | 91/300 [58:34<2:17:57, 39.61s/it] 31%|███       | 92/300 [59:23<2:27:35, 42.58s/it] 31%|███       | 93/300 [59:57<2:17:24, 39.83s/it] 31%|███▏      | 94/300 [1:00:14<1:53:32, 33.07s/it] 32%|███▏      | 95/300 [1:00:46<1:52:09, 32.82s/it] 32%|███▏      | 96/300 [1:01:33<2:05:41, 36.97s/it] 32%|███▏      | 97/300 [1:02:14<2:09:04, 38.15s/it] 33%|███▎      | 98/300 [1:03:01<2:17:27, 40.83s/it] 33%|███▎      | 99/300 [1:03:29<2:04:18, 37.11s/it]